(function(a){if(typeof exports=="object"&&typeof module=="object"){module.exports=a()}else{if(typeof define=="function"&&define.amd){return define([],a)}else{(this||window).CodeMirror=a()}}})(function(){var d1=navigator.userAgent;var ec=navigator.platform;var cn=/gecko\/\d/i.test(d1);var eO=/MSIE \d/.test(d1);var bI=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(d1);var dK=eO||bI;var k=dK&&(eO?document.documentMode||6:bI[1]);var cZ=/WebKit\//.test(d1);var dN=cZ&&/Qt\/\d+\.\d+/.test(d1);var dc=/Chrome\//.test(d1);var d4=/Opera\//.test(d1);var aB=/Apple Computer/.test(navigator.vendor);var c6=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(d1);var fz=/PhantomJS/.test(d1);var e5=/AppleWebKit/.test(d1)&&/Mobile\/\w+/.test(d1);var ei=e5||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(d1);var b6=e5||/Mac/.test(ec);var aO=/win/i.test(ec);var aY=d4&&d1.match(/Version\/(\d*\.\d*)/);if(aY){aY=Number(aY[1])}if(aY&&aY>=15){d4=false;cZ=true}var bP=b6&&(dN||d4&&(aY==null||aY<12.11));var gf=cn||(dK&&k>=9);var gi=false,a6=false;function H(gq,gs){if(!(this instanceof H)){return new H(gq,gs)}this.options=gs=gs?aM(gs):{};aM(e7,gs,false);cd(gs);var gw=gs.value;if(typeof gw=="string"){gw=new ar(gw,gs.mode,null,gs.lineSeparator)}this.doc=gw;var gr=new H.inputStyles[gs.inputStyle](this);var gv=this.display=new eL(gq,gw,gr);gv.wrapper.CodeMirror=this;ee(this);cN(this);if(gs.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(gs.autofocus&&!ei){gv.input.focus()}aC(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,selectingText:false,draggingText:false,highlight:new go(),keySeq:null,specialChars:null};var gp=this;if(dK&&k<11){setTimeout(function(){gp.display.input.reset(true)},20)}fV(this);bi();cH(this);this.curOp.forceUpdate=true;ed(this,gw);if((gs.autofocus&&!ei)||gp.hasFocus()){setTimeout(cu(cA,this),20)}else{aU(this)}for(var gu in be){if(be.hasOwnProperty(gu)){be[gu](this,gs[gu],cb)}}d6(this);if(gs.finishInit){gs.finishInit(this)}for(var gt=0;gt<a7.length;++gt){a7[gt](this)}al(this);if(cZ&&gs.lineWrapping&&getComputedStyle(gv.lineDiv).textRendering=="optimizelegibility"){gv.lineDiv.style.textRendering="auto"}}function eL(gp,gr,gq){var gs=this;this.input=gq;gs.scrollbarFiller=f8("div",null,"CodeMirror-scrollbar-filler");gs.scrollbarFiller.setAttribute("cm-not-content","true");gs.gutterFiller=f8("div",null,"CodeMirror-gutter-filler");gs.gutterFiller.setAttribute("cm-not-content","true");gs.lineDiv=f8("div",null,"CodeMirror-code");gs.selectionDiv=f8("div",null,null,"position: relative; z-index: 1");gs.cursorDiv=f8("div",null,"CodeMirror-cursors");gs.measure=f8("div",null,"CodeMirror-measure");gs.lineMeasure=f8("div",null,"CodeMirror-measure");gs.lineSpace=f8("div",[gs.measure,gs.lineMeasure,gs.selectionDiv,gs.cursorDiv,gs.lineDiv],null,"position: relative; outline: none");gs.mover=f8("div",[f8("div",[gs.lineSpace],"CodeMirror-lines")],null,"position: relative");gs.sizer=f8("div",[gs.mover],"CodeMirror-sizer");gs.sizerWidth=null;gs.heightForcer=f8("div",null,null,"position: absolute; height: "+dJ+"px; width: 1px;");gs.gutters=f8("div",null,"CodeMirror-gutters");gs.lineGutter=null;gs.scroller=f8("div",[gs.sizer,gs.heightForcer,gs.gutters],"CodeMirror-scroll");gs.scroller.setAttribute("tabIndex","-1");gs.wrapper=f8("div",[gs.scrollbarFiller,gs.gutterFiller,gs.scroller],"CodeMirror");if(dK&&k<8){gs.gutters.style.zIndex=-1;gs.scroller.style.paddingRight=0}if(!cZ&&!(cn&&ei)){gs.scroller.draggable=true}if(gp){if(gp.appendChild){gp.appendChild(gs.wrapper)}else{gp(gs.wrapper)}}gs.viewFrom=gs.viewTo=gr.first;gs.reportedViewFrom=gs.reportedViewTo=gr.first;gs.view=[];gs.renderedView=null;gs.externalMeasured=null;gs.viewOffset=0;gs.lastWrapHeight=gs.lastWrapWidth=0;gs.updateLineNumbers=null;gs.nativeBarWidth=gs.barHeight=gs.barWidth=0;gs.scrollbarsClipped=false;gs.lineNumWidth=gs.lineNumInnerWidth=gs.lineNumChars=null;gs.alignWidgets=false;gs.cachedCharWidth=gs.cachedTextHeight=gs.cachedPaddingH=null;gs.maxLine=null;gs.maxLineLength=0;gs.maxLineChanged=false;gs.wheelDX=gs.wheelDY=gs.wheelStartX=gs.wheelStartY=null;gs.shift=false;gs.selForContextMenu=null;gs.activeTouch=null;gq.init(gs)}function bq(gp){gp.doc.mode=H.getMode(gp.options,gp.doc.modeOption);eo(gp)}function eo(gp){gp.doc.iter(function(gq){if(gq.stateAfter){gq.stateAfter=null}if(gq.styles){gq.styles=null}});gp.doc.frontier=gp.doc.first;eh(gp,100);gp.state.modeGen++;if(gp.curOp){ah(gp)}}function eJ(gp){if(gp.options.lineWrapping){fF(gp.display.wrapper,"CodeMirror-wrap");gp.display.sizer.style.minWidth="";gp.display.sizerWidth=null}else{f(gp.display.wrapper,"CodeMirror-wrap");h(gp)}X(gp);ah(gp);aj(gp);setTimeout(function(){e2(gp)},100)}function bd(gp){var gr=aX(gp.display),gq=gp.options.lineWrapping;var gs=gq&&Math.max(5,gp.display.scroller.clientWidth/dD(gp.display)-3);return function(gu){if(fB(gp.doc,gu)){return 0}var gt=0;if(gu.widgets){for(var gv=0;gv<gu.widgets.length;gv++){if(gu.widgets[gv].height){gt+=gu.widgets[gv].height}}}if(gq){return gt+(Math.ceil(gu.text.length/gs)||1)*gr}else{return gt+gr}}}function X(gp){var gr=gp.doc,gq=bd(gp);gr.iter(function(gs){var gt=gq(gs);if(gt!=gs.height){gb(gs,gt)}})}function cN(gp){gp.display.wrapper.className=gp.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+gp.options.theme.replace(/(^|\s)\s*/g," cm-s-");aj(gp)}function dw(gp){ee(gp);ah(gp);setTimeout(function(){eH(gp)},20)}function ee(gp){var gq=gp.display.gutters,gu=gp.options.gutters;d2(gq);for(var gr=0;gr<gu.length;++gr){var gs=gu[gr];var gt=gq.appendChild(f8("div",null,"CodeMirror-gutter "+gs));if(gs=="CodeMirror-linenumbers"){gp.display.lineGutter=gt;gt.style.width=(gp.display.lineNumWidth||1)+"px"}}gq.style.display=gr?"":"none";c3(gp)}function c3(gp){var gq=gp.display.gutters.offsetWidth;gp.display.sizer.style.marginLeft=gq+"px"}function eq(gr){if(gr.height==0){return 0}var gq=gr.text.length,gp,gt=gr;while(gp=eS(gt)){var gs=gp.find(0,true);gt=gs.from.line;gq+=gs.from.ch-gs.to.ch}gt=gr;while(gp=ex(gt)){var gs=gp.find(0,true);gq-=gt.text.length-gs.from.ch;gt=gs.to.line;gq+=gt.text.length-gs.to.ch}return gq}function h(gp){var gr=gp.display,gq=gp.doc;gr.maxLine=fk(gq,gq.first);gr.maxLineLength=eq(gr.maxLine);gr.maxLineChanged=true;gq.iter(function(gt){var gs=eq(gt);if(gs>gr.maxLineLength){gr.maxLineLength=gs;gr.maxLine=gt}})}function cd(gp){var gq=dh(gp.gutters,"CodeMirror-linenumbers");if(gq==-1&&gp.lineNumbers){gp.gutters=gp.gutters.concat(["CodeMirror-linenumbers"])}else{if(gq>-1&&!gp.lineNumbers){gp.gutters=gp.gutters.slice(0);gp.gutters.splice(gq,1)}}}function dA(gp){var gs=gp.display,gr=gs.gutters.offsetWidth;var gq=Math.round(gp.doc.height+bH(gp.display));return{clientHeight:gs.scroller.clientHeight,viewHeight:gs.wrapper.clientHeight,scrollWidth:gs.scroller.scrollWidth,clientWidth:gs.scroller.clientWidth,viewWidth:gs.wrapper.clientWidth,barLeft:gp.options.fixedGutter?gr:0,docHeight:gq,scrollHeight:gq+cS(gp)+gs.barHeight,nativeBarWidth:gs.nativeBarWidth,gutterWidth:gr}}function dk(gr,gq,gp){this.cm=gp;var gs=this.vert=f8("div",[f8("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var gt=this.horiz=f8("div",[f8("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");gr(gs);gr(gt);bW(gs,"scroll",function(){if(gs.clientHeight){gq(gs.scrollTop,"vertical")}});bW(gt,"scroll",function(){if(gt.clientWidth){gq(gt.scrollLeft,"horizontal")}});this.checkedZeroWidth=false;if(dK&&k<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}}dk.prototype=aM({update:function(gs){var gt=gs.scrollWidth>gs.clientWidth+1;var gr=gs.scrollHeight>gs.clientHeight+1;var gu=gs.nativeBarWidth;if(gr){this.vert.style.display="block";this.vert.style.bottom=gt?gu+"px":"0";var gq=gs.viewHeight-(gt?gu:0);this.vert.firstChild.style.height=Math.max(0,gs.scrollHeight-gs.clientHeight+gq)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(gt){this.horiz.style.display="block";this.horiz.style.right=gr?gu+"px":"0";this.horiz.style.left=gs.barLeft+"px";var gp=gs.viewWidth-gs.barLeft-(gr?gu:0);this.horiz.firstChild.style.width=(gs.scrollWidth-gs.clientWidth+gp)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedZeroWidth&&gs.clientHeight>0){if(gu==0){this.zeroWidthHack()}this.checkedZeroWidth=true}return{right:gr?gu:0,bottom:gt?gu:0}},setScrollLeft:function(gp){if(this.horiz.scrollLeft!=gp){this.horiz.scrollLeft=gp}if(this.disableHoriz){this.enableZeroWidthBar(this.horiz,this.disableHoriz)}},setScrollTop:function(gp){if(this.vert.scrollTop!=gp){this.vert.scrollTop=gp}if(this.disableVert){this.enableZeroWidthBar(this.vert,this.disableVert)}},zeroWidthHack:function(){var gp=b6&&!c6?"12px":"18px";this.horiz.style.height=this.vert.style.width=gp;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new go;this.disableVert=new go},enableZeroWidthBar:function(gq,gp){gq.style.pointerEvents="auto";function gr(){var gt=gq.getBoundingClientRect();var gs=document.elementFromPoint(gt.left+1,gt.bottom-1);if(gs!=gq){gq.style.pointerEvents="none"}else{gp.set(1000,gr)}}gp.set(1000,gr)},clear:function(){var gp=this.horiz.parentNode;gp.removeChild(this.horiz);gp.removeChild(this.vert)}},dk.prototype);function e8(){}e8.prototype=aM({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},e8.prototype);H.scrollbarModel={"native":dk,"null":e8};function aC(gp){if(gp.display.scrollbars){gp.display.scrollbars.clear();if(gp.display.scrollbars.addClass){f(gp.display.wrapper,gp.display.scrollbars.addClass)}}gp.display.scrollbars=new H.scrollbarModel[gp.options.scrollbarStyle](function(gq){gp.display.wrapper.insertBefore(gq,gp.display.scrollbarFiller);bW(gq,"mousedown",function(){if(gp.state.focused){setTimeout(function(){gp.display.input.focus()},0)}});gq.setAttribute("cm-not-content","true")},function(gr,gq){if(gq=="horizontal"){bD(gp,gr)}else{N(gp,gr)}},gp);if(gp.display.scrollbars.addClass){fF(gp.display.wrapper,gp.display.scrollbars.addClass)}}function e2(gr,gt){if(!gt){gt=dA(gr)}var gq=gr.display.barWidth,gp=gr.display.barHeight;aT(gr,gt);for(var gs=0;gs<4&&gq!=gr.display.barWidth||gp!=gr.display.barHeight;gs++){if(gq!=gr.display.barWidth&&gr.options.lineWrapping){a8(gr)}aT(gr,dA(gr));gq=gr.display.barWidth;gp=gr.display.barHeight}}function aT(gp,gq){var gs=gp.display;var gr=gs.scrollbars.update(gq);gs.sizer.style.paddingRight=(gs.barWidth=gr.right)+"px";gs.sizer.style.paddingBottom=(gs.barHeight=gr.bottom)+"px";if(gr.right&&gr.bottom){gs.scrollbarFiller.style.display="block";gs.scrollbarFiller.style.height=gr.bottom+"px";gs.scrollbarFiller.style.width=gr.right+"px"}else{gs.scrollbarFiller.style.display=""}if(gr.bottom&&gp.options.coverGutterNextToScrollbar&&gp.options.fixedGutter){gs.gutterFiller.style.display="block";gs.gutterFiller.style.height=gr.bottom+"px";gs.gutterFiller.style.width=gq.gutterWidth+"px"}else{gs.gutterFiller.style.display=""}}function b5(gs,gw,gr){var gt=gr&&gr.top!=null?Math.max(0,gr.top):gs.scroller.scrollTop;gt=Math.floor(gt-fd(gs));var gp=gr&&gr.bottom!=null?gr.bottom:gt+gs.wrapper.clientHeight;var gu=bF(gw,gt),gv=bF(gw,gp);if(gr&&gr.ensure){var gq=gr.ensure.from.line,gx=gr.ensure.to.line;if(gq<gu){gu=gq;gv=bF(gw,bL(fk(gw,gq))+gs.wrapper.clientHeight)}else{if(Math.min(gx,gw.lastLine())>=gv){gu=bF(gw,bL(fk(gw,gx))-gs.wrapper.clientHeight);gv=gx}}}return{from:gu,to:Math.max(gv,gu+1)}}function eH(gx){var gv=gx.display,gw=gv.view;if(!gv.alignWidgets&&(!gv.gutters.firstChild||!gx.options.fixedGutter)){return}var gt=dX(gv)-gv.scroller.scrollLeft+gx.doc.scrollLeft;var gp=gv.gutters.offsetWidth,gq=gt+"px";for(var gs=0;gs<gw.length;gs++){if(!gw[gs].hidden){if(gx.options.fixedGutter&&gw[gs].gutter){gw[gs].gutter.style.left=gq}var gu=gw[gs].alignable;if(gu){for(var gr=0;gr<gu.length;gr++){gu[gr].style.left=gq}}}}if(gx.options.fixedGutter){gv.gutters.style.left=(gt+gp)+"px"}}function d6(gp){if(!gp.options.lineNumbers){return false}var gu=gp.doc,gq=ev(gp.options,gu.first+gu.size-1),gt=gp.display;if(gq.length!=gt.lineNumChars){var gv=gt.measure.appendChild(f8("div",[f8("div",gq)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var gr=gv.firstChild.offsetWidth,gs=gv.offsetWidth-gr;gt.lineGutter.style.width="";gt.lineNumInnerWidth=Math.max(gr,gt.lineGutter.offsetWidth-gs)+1;gt.lineNumWidth=gt.lineNumInnerWidth+gs;gt.lineNumChars=gt.lineNumInnerWidth?gq.length:-1;gt.lineGutter.style.width=gt.lineNumWidth+"px";c3(gp);return true}return false}function ev(gp,gq){return String(gp.lineNumberFormatter(gq+gp.firstLineNumber))}function dX(gp){return gp.scroller.getBoundingClientRect().left-gp.sizer.getBoundingClientRect().left}function aH(gq,gp,gr){var gs=gq.display;this.viewport=gp;this.visible=b5(gs,gq.doc,gp);this.editorIsHidden=!gs.wrapper.offsetWidth;this.wrapperHeight=gs.wrapper.clientHeight;this.wrapperWidth=gs.wrapper.clientWidth;this.oldDisplayWidth=dl(gq);this.force=gr;this.dims=fi(gq);this.events=[]}aH.prototype.signal=function(gq,gp){if(fn(gq,gp)){this.events.push(arguments)}};aH.prototype.finish=function(){for(var gp=0;gp<this.events.length;gp++){aD.apply(null,this.events[gp])}};function J(gp){var gq=gp.display;if(!gq.scrollbarsClipped&&gq.scroller.offsetWidth){gq.nativeBarWidth=gq.scroller.offsetWidth-gq.scroller.clientWidth;gq.heightForcer.style.height=cS(gp)+"px";gq.sizer.style.marginBottom=-gq.nativeBarWidth+"px";gq.sizer.style.borderRightWidth=cS(gp)+"px";gq.scrollbarsClipped=true}}function B(gy,gs){var gt=gy.display,gx=gy.doc;if(gs.editorIsHidden){eA(gy);return false}if(!gs.force&&gs.visible.from>=gt.viewFrom&&gs.visible.to<=gt.viewTo&&(gt.updateLineNumbers==null||gt.updateLineNumbers>=gt.viewTo)&&gt.renderedView==gt.view&&db(gy)==0){return false}if(d6(gy)){eA(gy);gs.dims=fi(gy)}var gr=gx.first+gx.size;var gv=Math.max(gs.visible.from-gy.options.viewportMargin,gx.first);var gw=Math.min(gr,gs.visible.to+gy.options.viewportMargin);if(gt.viewFrom<gv&&gv-gt.viewFrom<20){gv=Math.max(gx.first,gt.viewFrom)}if(gt.viewTo>gw&&gt.viewTo-gw<20){gw=Math.min(gr,gt.viewTo)}if(a6){gv=aV(gy.doc,gv);gw=d3(gy.doc,gw)}var gq=gv!=gt.viewFrom||gw!=gt.viewTo||gt.lastWrapHeight!=gs.wrapperHeight||gt.lastWrapWidth!=gs.wrapperWidth;cQ(gy,gv,gw);gt.viewOffset=bL(fk(gy.doc,gt.viewFrom));gy.display.mover.style.top=gt.viewOffset+"px";var gp=db(gy);if(!gq&&gp==0&&!gs.force&&gt.renderedView==gt.view&&(gt.updateLineNumbers==null||gt.updateLineNumbers>=gt.viewTo)){return false}var gu=dO();if(gp>4){gt.lineDiv.style.display="none"}cl(gy,gt.updateLineNumbers,gs.dims);if(gp>4){gt.lineDiv.style.display=""}gt.renderedView=gt.view;if(gu&&dO()!=gu&&gu.offsetHeight){gu.focus()}d2(gt.cursorDiv);d2(gt.selectionDiv);gt.gutters.style.height=gt.sizer.style.minHeight=0;if(gq){gt.lastWrapHeight=gs.wrapperHeight;gt.lastWrapWidth=gs.wrapperWidth;eh(gy,400)}gt.updateLineNumbers=null;return true}function ci(gq,gt){var gp=gt.viewport;for(var gs=true;;gs=false){if(!gs||!gq.options.lineWrapping||gt.oldDisplayWidth==dl(gq)){if(gp&&gp.top!=null){gp={top:Math.min(gq.doc.height+bH(gq.display)-cU(gq),gp.top)}}gt.visible=b5(gq.display,gq.doc,gp);if(gt.visible.from>=gq.display.viewFrom&&gt.visible.to<=gq.display.viewTo){break}}if(!B(gq,gt)){break}a8(gq);var gr=dA(gq);bB(gq);dz(gq,gr);e2(gq,gr)}gt.signal(gq,"update",gq);if(gq.display.viewFrom!=gq.display.reportedViewFrom||gq.display.viewTo!=gq.display.reportedViewTo){gt.signal(gq,"viewportChange",gq,gq.display.viewFrom,gq.display.viewTo);gq.display.reportedViewFrom=gq.display.viewFrom;gq.display.reportedViewTo=gq.display.viewTo}}function dT(gq,gp){var gs=new aH(gq,gp);if(B(gq,gs)){a8(gq);ci(gq,gs);var gr=dA(gq);bB(gq);dz(gq,gr);e2(gq,gr);gs.finish()}}function dz(gp,gq){gp.display.sizer.style.minHeight=gq.docHeight+"px";var gr=gq.docHeight+gp.display.barHeight;gp.display.heightForcer.style.top=gr+"px";gp.display.gutters.style.height=Math.max(gr+cS(gp),gq.clientHeight)+"px"}function a8(gw){var gu=gw.display;var gq=gu.lineDiv.offsetTop;for(var gr=0;gr<gu.view.length;gr++){var gx=gu.view[gr],gy;if(gx.hidden){continue}if(dK&&k<8){var gt=gx.node.offsetTop+gx.node.offsetHeight;gy=gt-gq;gq=gt}else{var gs=gx.node.getBoundingClientRect();gy=gs.bottom-gs.top}var gv=gx.line.height-gy;if(gy<2){gy=aX(gu)}if(gv>0.001||gv<-0.001){gb(gx.line,gy);ca(gx.line);if(gx.rest){for(var gp=0;gp<gx.rest.length;gp++){ca(gx.rest[gp])}}}}}function ca(gp){if(gp.widgets){for(var gq=0;gq<gp.widgets.length;++gq){gp.widgets[gq].height=gp.widgets[gq].node.parentNode.offsetHeight}}}function fi(gp){var gu=gp.display,gs={},gr={};var gt=gu.gutters.clientLeft;for(var gv=gu.gutters.firstChild,gq=0;gv;gv=gv.nextSibling,++gq){gs[gp.options.gutters[gq]]=gv.offsetLeft+gv.clientLeft+gt;gr[gp.options.gutters[gq]]=gv.clientWidth}return{fixedPos:dX(gu),gutterTotalWidth:gu.gutters.offsetWidth,gutterLeft:gs,gutterWidth:gr,wrapperWidth:gu.wrapper.clientWidth}}function cl(gA,gr,gz){var gw=gA.display,gC=gA.options.lineNumbers;var gp=gw.lineDiv,gB=gp.firstChild;function gv(gE){var gD=gE.nextSibling;if(cZ&&b6&&gA.display.currentWheelTarget==gE){gE.style.display="none"}else{gE.parentNode.removeChild(gE)}return gD}var gx=gw.view,gu=gw.viewFrom;for(var gs=0;gs<gx.length;gs++){var gt=gx[gs];if(gt.hidden){}else{if(!gt.node||gt.node.parentNode!=gp){var gq=aE(gA,gt,gu,gz);gp.insertBefore(gq,gB)}else{while(gB!=gt.node){gB=gv(gB)}var gy=gC&&gr!=null&&gr<=gu&&gt.lineNumber;if(gt.changes){if(dh(gt.changes,"gutter")>-1){gy=false}ab(gA,gt,gu,gz)}if(gy){d2(gt.lineNumber);gt.lineNumber.appendChild(document.createTextNode(ev(gA.options,gu)))}gB=gt.node.nextSibling}}gu+=gt.size}while(gB){gB=gv(gB)}}function ab(gp,gr,gt,gu){for(var gq=0;gq<gr.changes.length;gq++){var gs=gr.changes[gq];if(gs=="text"){fq(gp,gr)}else{if(gs=="gutter"){df(gp,gr,gt,gu)}else{if(gs=="class"){dG(gr)}else{if(gs=="widget"){an(gp,gr,gu)}}}}}gr.changes=null}function fM(gp){if(gp.node==gp.text){gp.node=f8("div",null,null,"position: relative");if(gp.text.parentNode){gp.text.parentNode.replaceChild(gp.node,gp.text)}gp.node.appendChild(gp.text);if(dK&&k<8){gp.node.style.zIndex=2}}return gp.node}function ez(gq){var gp=gq.bgClass?gq.bgClass+" "+(gq.line.bgClass||""):gq.line.bgClass;if(gp){gp+=" CodeMirror-linebackground"}if(gq.background){if(gp){gq.background.className=gp}else{gq.background.parentNode.removeChild(gq.background);gq.background=null}}else{if(gp){var gr=fM(gq);gq.background=gr.insertBefore(f8("div",null,gp),gr.firstChild)}}}function dV(gp,gq){var gr=gp.display.externalMeasured;if(gr&&gr.line==gq.line){gp.display.externalMeasured=null;gq.measure=gr.measure;return gr.built}return eV(gp,gq)}function fq(gp,gs){var gq=gs.text.className;var gr=dV(gp,gs);if(gs.text==gs.node){gs.node=gr.pre}gs.text.parentNode.replaceChild(gr.pre,gs.text);gs.text=gr.pre;if(gr.bgClass!=gs.bgClass||gr.textClass!=gs.textClass){gs.bgClass=gr.bgClass;gs.textClass=gr.textClass;dG(gs)}else{if(gq){gs.text.className=gq}}}function dG(gq){ez(gq);if(gq.line.wrapClass){fM(gq).className=gq.line.wrapClass}else{if(gq.node!=gq.text){gq.node.className=""}}var gp=gq.textClass?gq.textClass+" "+(gq.line.textClass||""):gq.line.textClass;gq.text.className=gp||""}function df(gx,gv,gu,gw){if(gv.gutter){gv.node.removeChild(gv.gutter);gv.gutter=null}if(gv.gutterBackground){gv.node.removeChild(gv.gutterBackground);gv.gutterBackground=null}if(gv.line.gutterClass){var gq=fM(gv);gv.gutterBackground=f8("div",null,"CodeMirror-gutter-background "+gv.line.gutterClass,"left: "+(gx.options.fixedGutter?gw.fixedPos:-gw.gutterTotalWidth)+"px; width: "+gw.gutterTotalWidth+"px");gq.insertBefore(gv.gutterBackground,gv.text)}var gs=gv.line.gutterMarkers;if(gx.options.lineNumbers||gs){var gq=fM(gv);var gt=gv.gutter=f8("div",null,"CodeMirror-gutter-wrapper","left: "+(gx.options.fixedGutter?gw.fixedPos:-gw.gutterTotalWidth)+"px");gx.display.input.setUneditable(gt);gq.insertBefore(gt,gv.text);if(gv.line.gutterClass){gt.className+=" "+gv.line.gutterClass}if(gx.options.lineNumbers&&(!gs||!gs["CodeMirror-linenumbers"])){gv.lineNumber=gt.appendChild(f8("div",ev(gx.options,gu),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+gw.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+gx.display.lineNumInnerWidth+"px"))}if(gs){for(var gr=0;gr<gx.options.gutters.length;++gr){var gp=gx.options.gutters[gr],gy=gs.hasOwnProperty(gp)&&gs[gp];if(gy){gt.appendChild(f8("div",[gy],"CodeMirror-gutter-elt","left: "+gw.gutterLeft[gp]+"px; width: "+gw.gutterWidth[gp]+"px"))}}}}}function an(gp,gq,gt){if(gq.alignable){gq.alignable=null}for(var gs=gq.node.firstChild,gr;gs;gs=gr){var gr=gs.nextSibling;if(gs.className=="CodeMirror-linewidget"){gq.node.removeChild(gs)}}fy(gp,gq,gt)}function aE(gp,gr,gs,gt){var gq=dV(gp,gr);gr.text=gr.node=gq.pre;if(gq.bgClass){gr.bgClass=gq.bgClass}if(gq.textClass){gr.textClass=gq.textClass}dG(gr);df(gp,gr,gs,gt);fy(gp,gr,gt);return gr.node}function fy(gp,gr,gs){gd(gp,gr.line,gr,gs,true);if(gr.rest){for(var gq=0;gq<gr.rest.length;gq++){gd(gp,gr.rest[gq],gr,gs,false)}}}function gd(gx,gy,gu,gw,gs){if(!gy.widgets){return}var gp=fM(gu);for(var gr=0,gv=gy.widgets;gr<gv.length;++gr){var gt=gv[gr],gq=f8("div",[gt.node],"CodeMirror-linewidget");if(!gt.handleMouseEvents){gq.setAttribute("cm-ignore-events","true")}bE(gt,gq,gu,gw);gx.display.input.setUneditable(gq);if(gs&&gt.above){gp.insertBefore(gq,gu.gutter||gu.text)}else{gp.appendChild(gq)}ae(gt,"redraw")}}function bE(gs,gr,gp,gt){if(gs.noHScroll){(gp.alignable||(gp.alignable=[])).push(gr);var gq=gt.wrapperWidth;gr.style.left=gt.fixedPos+"px";if(!gs.coverGutter){gq-=gt.gutterTotalWidth;gr.style.paddingLeft=gt.gutterTotalWidth+"px"}gr.style.width=gq+"px"}if(gs.coverGutter){gr.style.zIndex=5;gr.style.position="relative";if(!gs.noHScroll){gr.style.marginLeft=-gt.gutterTotalWidth+"px"}}}var W=H.Pos=function(gp,gq){if(!(this instanceof W)){return new W(gp,gq)}this.line=gp;this.ch=gq};var ce=H.cmpPos=function(gq,gp){return gq.line-gp.line||gq.ch-gp.ch};function ch(gp){return W(gp.line,gp.ch)}function bw(gq,gp){return ce(gq,gp)<0?gp:gq}function aq(gq,gp){return ce(gq,gp)<0?gq:gp}function r(gp){if(!gp.state.focused){gp.display.input.focus();cA(gp)}}var bl=null;function f4(gD,gt,gr,gq,gC){var gB=gD.doc;gD.display.shift=false;if(!gq){gq=gB.sel}var gs=gD.state.pasteIncoming||gC=="paste";var gw=gB.splitLines(gt),gp=null;if(gs&&gq.ranges.length>1){if(bl&&bl.join("\n")==gt){if(gq.ranges.length%bl.length==0){gp=[];for(var gu=0;gu<bl.length;gu++){gp.push(gB.splitLines(bl[gu]))}}}else{if(gw.length==gq.ranges.length){gp=bR(gw,function(gE){return[gE]})}}}for(var gu=gq.ranges.length-1;gu>=0;gu--){var gv=gq.ranges[gu];var gA=gv.from(),gz=gv.to();if(gv.empty()){if(gr&&gr>0){gA=W(gA.line,gA.ch-gr)}else{if(gD.state.overwrite&&!gs){gz=W(gz.line,Math.min(fk(gB,gz.line).text.length,gz.ch+fL(gw).length))}}}var gx=gD.curOp.updateInput;var gy={from:gA,to:gz,text:gp?gp[gu%gp.length]:gw,origin:gC||(gs?"paste":gD.state.cutIncoming?"cut":"+input")};bf(gD.doc,gy);ae(gD,"inputRead",gD,gy)}if(gt&&!gs){f1(gD,gt)}fK(gD);gD.curOp.updateInput=gx;gD.curOp.typing=true;gD.state.pasteIncoming=gD.state.cutIncoming=false}function a9(gr,gp){var gq=gr.clipboardData&&gr.clipboardData.getData("text/plain");if(gq){gr.preventDefault();if(!gp.isReadOnly()&&!gp.options.disableInput){cL(gp,function(){f4(gp,gq,0,null,"paste")})}return true}}function f1(gp,gt){if(!gp.options.electricChars||!gp.options.smartIndent){return}var gu=gp.doc.sel;for(var gs=gu.ranges.length-1;gs>=0;gs--){var gq=gu.ranges[gs];if(gq.head.ch>100||(gs&&gu.ranges[gs-1].head.line==gq.head.line)){continue}var gv=gp.getModeAt(gq.head);var gw=false;if(gv.electricChars){for(var gr=0;gr<gv.electricChars.length;gr++){if(gt.indexOf(gv.electricChars.charAt(gr))>-1){gw=ad(gp,gq.head.line,"smart");break}}}else{if(gv.electricInput){if(gv.electricInput.test(fk(gp.doc,gq.head.line).text.slice(0,gq.head.ch))){gw=ad(gp,gq.head.line,"smart")}}}if(gw){ae(gp,"electricInput",gp,gq.head.line)}}}function dj(gp){var gu=[],gr=[];for(var gs=0;gs<gp.doc.sel.ranges.length;gs++){var gq=gp.doc.sel.ranges[gs].head.line;var gt={anchor:W(gq,0),head:W(gq+1,0)};gr.push(gt);gu.push(gp.getRange(gt.anchor,gt.head))}return{text:gu,ranges:gr}}function fU(gp){gp.setAttribute("autocorrect","off");gp.setAttribute("autocapitalize","off");gp.setAttribute("spellcheck","false")}function Y(gp){this.cm=gp;this.prevInput="";this.pollingFast=false;this.polling=new go();this.inaccurateSelection=false;this.hasSelection=false;this.composing=null}function aW(){var gp=f8("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");var gq=f8("div",[gp],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(cZ){gp.style.width="1000px"}else{gp.setAttribute("wrap","off")}if(e5){gp.style.border="1px solid black"}fU(gp);return gq}Y.prototype=aM({init:function(gr){var gq=this,gp=this.cm;var gu=this.wrapper=aW();var gs=this.textarea=gu.firstChild;gr.wrapper.insertBefore(gu,gr.wrapper.firstChild);if(e5){gs.style.width="0px"}bW(gs,"input",function(){if(dK&&k>=9&&gq.hasSelection){gq.hasSelection=null}gq.poll()});bW(gs,"paste",function(gv){if(aQ(gp,gv)||a9(gv,gp)){return}gp.state.pasteIncoming=true;gq.fastPoll()});function gt(gw){if(gp.somethingSelected()){bl=gp.getSelections();if(gq.inaccurateSelection){gq.prevInput="";gq.inaccurateSelection=false;gs.value=bl.join("\n");dL(gs)}}else{if(!gp.options.lineWiseCopyCut){return}else{var gv=dj(gp);bl=gv.text;if(gw.type=="cut"){gp.setSelections(gv.ranges,null,Z)}else{gq.prevInput="";gs.value=gv.text.join("\n");dL(gs)}}}if(gw.type=="cut"){gp.state.cutIncoming=true}}bW(gs,"cut",gt);bW(gs,"copy",gt);bW(gr.scroller,"paste",function(gv){if(ba(gr,gv)||aQ(gp,gv)){return}gp.state.pasteIncoming=true;gq.focus()});bW(gr.lineSpace,"selectstart",function(gv){if(!ba(gr,gv)){cF(gv)}});bW(gs,"compositionstart",function(){var gv=gp.getCursor("from");if(gq.composing){gq.composing.range.clear()}gq.composing={start:gv,range:gp.markText(gv,gp.getCursor("to"),{className:"CodeMirror-composing"})}});bW(gs,"compositionend",function(){if(gq.composing){gq.poll();gq.composing.range.clear();gq.composing=null}})},prepareSelection:function(){var gq=this.cm,gu=gq.display,gt=gq.doc;var gp=fN(gq);if(gq.options.moveInputWithCursor){var gv=dU(gq,gt.sel.primary().head,"div");var gr=gu.wrapper.getBoundingClientRect(),gs=gu.lineDiv.getBoundingClientRect();gp.teTop=Math.max(0,Math.min(gu.wrapper.clientHeight-10,gv.top+gs.top-gr.top));gp.teLeft=Math.max(0,Math.min(gu.wrapper.clientWidth-10,gv.left+gs.left-gr.left))}return gp},showSelection:function(gr){var gp=this.cm,gq=gp.display;bQ(gq.cursorDiv,gr.cursors);bQ(gq.selectionDiv,gr.selection);if(gr.teTop!=null){this.wrapper.style.top=gr.teTop+"px";this.wrapper.style.left=gr.teLeft+"px"}},reset:function(gt){if(this.contextMenuPending){return}var gq,gs,gp=this.cm,gv=gp.doc;if(gp.somethingSelected()){this.prevInput="";var gr=gv.sel.primary();gq=c9&&(gr.to().line-gr.from().line>100||(gs=gp.getSelection()).length>1000);var gu=gq?"-":gs||gp.getSelection();this.textarea.value=gu;if(gp.state.focused){dL(this.textarea)}if(dK&&k>=9){this.hasSelection=gu}}else{if(!gt){this.prevInput=this.textarea.value="";if(dK&&k>=9){this.hasSelection=null}}}this.inaccurateSelection=gq},getField:function(){return this.textarea},supportsTouch:function(){return false},focus:function(){if(this.cm.options.readOnly!="nocursor"&&(!ei||dO()!=this.textarea)){try{this.textarea.focus()}catch(gp){}}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var gp=this;if(gp.pollingFast){return}gp.polling.set(this.cm.options.pollInterval,function(){gp.poll();if(gp.cm.state.focused){gp.slowPoll()}})},fastPoll:function(){var gq=false,gp=this;gp.pollingFast=true;function gr(){var gs=gp.poll();if(!gs&&!gq){gq=true;gp.polling.set(60,gr)}else{gp.pollingFast=false;gp.slowPoll()}}gp.polling.set(20,gr)},poll:function(){var gp=this.cm,gs=this.textarea,gt=this.prevInput;if(this.contextMenuPending||!gp.state.focused||(br(gs)&&!gt&&!this.composing)||gp.isReadOnly()||gp.options.disableInput||gp.state.keySeq){return false}var gv=gs.value;if(gv==gt&&!gp.somethingSelected()){return false}if(dK&&k>=9&&this.hasSelection===gv||b6&&/[\uf700-\uf7ff]/.test(gv)){gp.display.input.reset();return false}if(gp.doc.sel==gp.display.selForContextMenu){var gu=gv.charCodeAt(0);if(gu==8203&&!gt){gt="\u200b"}if(gu==8666){this.reset();return this.cm.execCommand("undo")}}var gw=0,gq=Math.min(gt.length,gv.length);while(gw<gq&&gt.charCodeAt(gw)==gv.charCodeAt(gw)){++gw}var gr=this;cL(gp,function(){f4(gp,gv.slice(gw),gt.length-gw,null,gr.composing?"*compose":null);if(gv.length>1000||gv.indexOf("\n")>-1){gs.value=gr.prevInput=""}else{gr.prevInput=gv}if(gr.composing){gr.composing.range.clear();gr.composing.range=gp.markText(gr.composing.start,gp.getCursor("to"),{className:"CodeMirror-composing"})}});return true},ensurePolled:function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}},onKeyPress:function(){if(dK&&k>=9){this.hasSelection=null}this.fastPoll()},onContextMenu:function(gu){var gz=this,gA=gz.cm,gw=gA.display,gq=gz.textarea;var gy=cm(gA,gu),gp=gw.scroller.scrollTop;if(!gy||d4){return}var gt=gA.options.resetSelectionOnContextMenu;if(gt&&gA.doc.sel.contains(gy)==-1){c1(gA,bT)(gA.doc,eW(gy),Z)}var gv=gq.style.cssText;gz.wrapper.style.position="absolute";gq.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(gu.clientY-5)+"px; left: "+(gu.clientX-5)+"px; z-index: 1000; background: "+(dK?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(cZ){var gB=window.scrollY}gw.input.focus();if(cZ){window.scrollTo(null,gB)}gw.input.reset();if(!gA.somethingSelected()){gq.value=gz.prevInput=" "}gz.contextMenuPending=true;gw.selForContextMenu=gA.doc.sel;clearTimeout(gw.detectingSelectAll);function gs(){if(gq.selectionStart!=null){var gC=gA.somethingSelected();var gD="\u200b"+(gC?gq.value:"");gq.value="\u21da";gq.value=gD;gz.prevInput=gC?"":"\u200b";gq.selectionStart=1;gq.selectionEnd=gD.length;gw.selForContextMenu=gA.doc.sel}}function gx(){gz.contextMenuPending=false;gz.wrapper.style.position="relative";gq.style.cssText=gv;if(dK&&k<9){gw.scrollbars.setScrollTop(gw.scroller.scrollTop=gp)}if(gq.selectionStart!=null){if(!dK||(dK&&k<9)){gs()}var gC=0,gD=function(){if(gw.selForContextMenu==gA.doc.sel&&gq.selectionStart==0&&gq.selectionEnd>0&&gz.prevInput=="\u200b"){c1(gA,eG.selectAll)(gA)}else{if(gC++<10){gw.detectingSelectAll=setTimeout(gD,500)}else{gw.input.reset()}}};gw.detectingSelectAll=setTimeout(gD,200)}}if(dK&&k>=9){gs()}if(gf){eu(gu);var gr=function(){ef(window,"mouseup",gr);setTimeout(gx,20)};bW(window,"mouseup",gr)}else{setTimeout(gx,50)}},readOnlyChanged:function(gp){if(!gp){this.reset()}},setUneditable:f0,needsContentAttribute:false},Y.prototype);function dv(gp){this.cm=gp;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new go();this.gracePeriod=false}dv.prototype=aM({init:function(gs){var gr=this,gp=gr.cm;var gt=gr.div=gs.lineDiv;fU(gt);bW(gt,"paste",function(gu){if(!aQ(gp,gu)){a9(gu,gp)}});bW(gt,"compositionstart",function(gy){var gx=gy.data;gr.composing={sel:gp.doc.sel,data:gx,startData:gx};if(!gx){return}var gv=gp.doc.sel.primary();var gu=gp.getLine(gv.head.line);var gw=gu.indexOf(gx,Math.max(0,gv.head.ch-gx.length));if(gw>-1&&gw<=gv.head.ch){gr.composing.sel=eW(W(gv.head.line,gw),W(gv.head.line,gw+gx.length))}});bW(gt,"compositionupdate",function(gu){gr.composing.data=gu.data});bW(gt,"compositionend",function(gv){var gu=gr.composing;if(!gu){return}if(gv.data!=gu.startData&&!/\u200b/.test(gv.data)){gu.data=gv.data}setTimeout(function(){if(!gu.handled){gr.applyComposition(gu)}if(gr.composing==gu){gr.composing=null}},50)});bW(gt,"touchstart",function(){gr.forceCompositionEnd()});bW(gt,"input",function(){if(gr.composing){return}if(gp.isReadOnly()||!gr.pollContent()){cL(gr.cm,function(){ah(gp)})}});function gq(gx){if(gp.somethingSelected()){bl=gp.getSelections();if(gx.type=="cut"){gp.replaceSelection("",null,"cut")}}else{if(!gp.options.lineWiseCopyCut){return}else{var gv=dj(gp);bl=gv.text;if(gx.type=="cut"){gp.operation(function(){gp.setSelections(gv.ranges,0,Z);gp.replaceSelection("",null,"cut")})}}}if(gx.clipboardData&&!e5){gx.preventDefault();gx.clipboardData.clearData();gx.clipboardData.setData("text/plain",bl.join("\n"))}else{var gw=aW(),gy=gw.firstChild;gp.display.lineSpace.insertBefore(gw,gp.display.lineSpace.firstChild);gy.value=bl.join("\n");var gu=document.activeElement;dL(gy);setTimeout(function(){gp.display.lineSpace.removeChild(gw);gu.focus()},50)}}bW(gt,"copy",gq);bW(gt,"cut",gq)},prepareSelection:function(){var gp=fN(this.cm,false);gp.focus=this.cm.state.focused;return gp},showSelection:function(gp){if(!gp||!this.cm.display.view.length){return}if(gp.focus){this.showPrimarySelection()}this.showMultipleSelections(gp)},showPrimarySelection:function(){var gt=window.getSelection(),gw=this.cm.doc.sel.primary();var gu=ay(this.cm,gt.anchorNode,gt.anchorOffset);var gy=ay(this.cm,gt.focusNode,gt.focusOffset);if(gu&&!gu.bad&&gy&&!gy.bad&&ce(aq(gu,gy),gw.from())==0&&ce(bw(gu,gy),gw.to())==0){return}var gs=cy(this.cm,gw.from());var gx=cy(this.cm,gw.to());if(!gs&&!gx){return}var gA=this.cm.display.view;var gv=gt.rangeCount&&gt.getRangeAt(0);if(!gs){gs={node:gA[0].measure.map[2],offset:0}}else{if(!gx){var gr=gA[gA.length-1].measure;var gq=gr.maps?gr.maps[gr.maps.length-1]:gr.map;gx={node:gq[gq.length-1],offset:gq[gq.length-2]-gq[gq.length-3]}}}try{var gp=ck(gs.node,gs.offset,gx.offset,gx.node)}catch(gz){}if(gp){if(!cn&&this.cm.state.focused){gt.collapse(gs.node,gs.offset);if(!gp.collapsed){gt.addRange(gp)}}else{gt.removeAllRanges();gt.addRange(gp)}if(gv&&gt.anchorNode==null){gt.addRange(gv)}else{if(cn){this.startGracePeriod()}}}this.rememberSelection()},startGracePeriod:function(){var gp=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){gp.gracePeriod=false;if(gp.selectionChanged()){gp.cm.operation(function(){gp.cm.curOp.selectionChanged=true})}},20)},showMultipleSelections:function(gp){bQ(this.cm.display.cursorDiv,gp.cursors);bQ(this.cm.display.selectionDiv,gp.selection)},rememberSelection:function(){var gp=window.getSelection();this.lastAnchorNode=gp.anchorNode;this.lastAnchorOffset=gp.anchorOffset;this.lastFocusNode=gp.focusNode;this.lastFocusOffset=gp.focusOffset},selectionInEditor:function(){var gq=window.getSelection();if(!gq.rangeCount){return false}var gp=gq.getRangeAt(0).commonAncestorContainer;return gg(this.div,gp)},focus:function(){if(this.cm.options.readOnly!="nocursor"){this.div.focus()}},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return true},receivedFocus:function(){var gp=this;if(this.selectionInEditor()){this.pollSelection()}else{cL(this.cm,function(){gp.cm.curOp.selectionChanged=true})}function gq(){if(gp.cm.state.focused){gp.pollSelection();gp.polling.set(gp.cm.options.pollInterval,gq)}}this.polling.set(this.cm.options.pollInterval,gq)},selectionChanged:function(){var gp=window.getSelection();return gp.anchorNode!=this.lastAnchorNode||gp.anchorOffset!=this.lastAnchorOffset||gp.focusNode!=this.lastFocusNode||gp.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var gs=window.getSelection(),gp=this.cm;this.rememberSelection();var gq=ay(gp,gs.anchorNode,gs.anchorOffset);var gr=ay(gp,gs.focusNode,gs.focusOffset);if(gq&&gr){cL(gp,function(){bT(gp.doc,eW(gq,gr),Z);if(gq.bad||gr.bad){gp.curOp.selectionChanged=true}})}}},pollContent:function(){var gz=this.cm,gJ=gz.display,gH=gz.doc.sel.primary();var gI=gH.from(),gt=gH.to();if(gI.line<gJ.viewFrom||gt.line>gJ.viewTo-1){return false}var gw;if(gI.line==gJ.viewFrom||(gw=dr(gz,gI.line))==0){var gu=bM(gJ.view[0].line);var gy=gJ.view[0].node}else{var gu=bM(gJ.view[gw].line);var gy=gJ.view[gw-1].node.nextSibling}var gG=dr(gz,gt.line);if(gG==gJ.view.length-1){var gB=gJ.viewTo-1;var gE=gJ.lineDiv.lastChild}else{var gB=bM(gJ.view[gG+1].line)-1;var gE=gJ.view[gG+1].node.previousSibling}var gK=gz.doc.splitLines(f5(gz,gy,gE,gu,gB));var gD=ga(gz.doc,W(gu,0),W(gB,fk(gz.doc,gB).text.length));while(gK.length>1&&gD.length>1){if(fL(gK)==fL(gD)){gK.pop();gD.pop();gB--}else{if(gK[0]==gD[0]){gK.shift();gD.shift();gu++}else{break}}}var gF=0,gr=0;var gA=gK[0],gq=gD[0],gp=Math.min(gA.length,gq.length);while(gF<gp&&gA.charCodeAt(gF)==gq.charCodeAt(gF)){++gF}var gx=fL(gK),gL=fL(gD);var gs=Math.min(gx.length-(gK.length==1?gF:0),gL.length-(gD.length==1?gF:0));while(gr<gs&&gx.charCodeAt(gx.length-gr-1)==gL.charCodeAt(gL.length-gr-1)){++gr}gK[gK.length-1]=gx.slice(0,gx.length-gr);gK[0]=gK[0].slice(gF);var gv=W(gu,gF);var gC=W(gB,gD.length?fL(gD).length-gr:0);if(gK.length>1||gK[0]||ce(gv,gC)){a0(gz.doc,gK,gv,gC,"+input");return true}},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){if(!this.composing||this.composing.handled){return}this.applyComposition(this.composing);this.composing.handled=true;this.div.blur();this.div.focus()},applyComposition:function(gp){if(this.cm.isReadOnly()){c1(this.cm,ah)(this.cm)}else{if(gp.data&&gp.data!=gp.startData){c1(this.cm,f4)(this.cm,gp.data,0,gp.sel)}}},setUneditable:function(gp){gp.contentEditable="false"},onKeyPress:function(gp){gp.preventDefault();if(!this.cm.isReadOnly()){c1(this.cm,f4)(this.cm,String.fromCharCode(gp.charCode==null?gp.keyCode:gp.charCode),0)}},readOnlyChanged:function(gp){this.div.contentEditable=String(gp!="nocursor")},onContextMenu:f0,resetPosition:f0,needsContentAttribute:true},dv.prototype);function cy(gv,gt){var gu=fg(gv,gt.line);if(!gu||gu.hidden){return null}var gx=fk(gv.doc,gt.line);var gq=cs(gu,gx,gt.line);var gr=a(gx),gs="left";if(gr){var gp=aF(gr,gt.ch);gs=gp%2?"right":"left"}var gw=aK(gq.map,gt.ch,gs);gw.offset=gw.collapse=="right"?gw.end:gw.start;return gw}function ew(gq,gp){if(gp){gq.bad=true}return gq}function ay(gp,gs,gu){var gt;if(gs==gp.display.lineDiv){gt=gp.display.lineDiv.childNodes[gu];if(!gt){return ew(gp.clipPos(W(gp.display.viewTo-1)),true)}gs=null;gu=0}else{for(gt=gs;;gt=gt.parentNode){if(!gt||gt==gp.display.lineDiv){return null}if(gt.parentNode&&gt.parentNode==gp.display.lineDiv){break}}}for(var gr=0;gr<gp.display.view.length;gr++){var gq=gp.display.view[gr];if(gq.node==gt){return aa(gq,gs,gu)}}}function aa(gx,gt,gv){var gr=gx.text.firstChild,gs=false;if(!gt||!gg(gr,gt)){return ew(W(bM(gx.line),0),true)}if(gt==gr){gs=true;gt=gr.childNodes[gv];gv=0;if(!gt){var gD=gx.rest?fL(gx.rest):gx.line;return ew(W(bM(gD),gD.text.length),gs)}}var gu=gt.nodeType==3?gt:null,gB=gt;if(!gu&&gt.childNodes.length==1&&gt.firstChild.nodeType==3){gu=gt.firstChild;if(gv){gv=gu.nodeValue.length}}while(gB.parentNode!=gr){gB=gB.parentNode}var gq=gx.measure,gz=gq.maps;function gw(gG,gL,gI){for(var gK=-1;gK<(gz?gz.length:0);gK++){var gF=gK<0?gq.map:gz[gK];for(var gJ=0;gJ<gF.length;gJ+=3){var gH=gF[gJ+2];if(gH==gG||gH==gL){var gM=bM(gK<0?gx.line:gx.rest[gK]);var gE=gF[gJ]+gI;if(gI<0||gH!=gG){gE=gF[gJ+(gI?1:0)]}return W(gM,gE)}}}}var gC=gw(gu,gB,gv);if(gC){return ew(gC,gs)}for(var gp=gB.nextSibling,gy=gu?gu.nodeValue.length-gv:0;gp;gp=gp.nextSibling){gC=gw(gp,gp.firstChild,0);if(gC){return ew(W(gC.line,gC.ch-gy),gs)}else{gy+=gp.textContent.length}}for(var gA=gB.previousSibling,gy=gv;gA;gA=gA.previousSibling){gC=gw(gA,gA.firstChild,-1);if(gC){return ew(W(gC.line,gC.ch+gy),gs)}else{gy+=gp.textContent.length}}}function f5(gx,gv,gw,gs,gq){var gy="",gr=false,gp=gx.doc.lineSeparator();function gt(gz){return function(gA){return gA.id==gz}}function gu(gD){if(gD.nodeType==1){var gA=gD.getAttribute("cm-text");if(gA!=null){if(gA==""){gA=gD.textContent.replace(/\u200b/g,"")}gy+=gA;return}var gC=gD.getAttribute("cm-marker"),gz;if(gC){var gE=gx.findMarks(W(gs,0),W(gq+1,0),gt(+gC));if(gE.length&&(gz=gE[0].find())){gy+=ga(gx.doc,gz.from,gz.to).join(gp)}return}if(gD.getAttribute("contenteditable")=="false"){return}for(var gB=0;gB<gD.childNodes.length;gB++){gu(gD.childNodes[gB])}if(/^(pre|div|p)$/i.test(gD.nodeName)){gr=true}}else{if(gD.nodeType==3){var gF=gD.nodeValue;if(!gF){return}if(gr){gy+=gp;gr=false}gy+=gF}}}for(;;){gu(gv);if(gv==gw){break}gv=gv.nextSibling}return gy}H.inputStyles={textarea:Y,contenteditable:dv};function f9(gp,gq){this.ranges=gp;this.primIndex=gq}f9.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(gp){if(gp==this){return true}if(gp.primIndex!=this.primIndex||gp.ranges.length!=this.ranges.length){return false}for(var gr=0;gr<this.ranges.length;gr++){var gq=this.ranges[gr],gs=gp.ranges[gr];if(ce(gq.anchor,gs.anchor)!=0||ce(gq.head,gs.head)!=0){return false}}return true},deepCopy:function(){for(var gp=[],gq=0;gq<this.ranges.length;gq++){gp[gq]=new dY(ch(this.ranges[gq].anchor),ch(this.ranges[gq].head))}return new f9(gp,this.primIndex)},somethingSelected:function(){for(var gp=0;gp<this.ranges.length;gp++){if(!this.ranges[gp].empty()){return true}}return false},contains:function(gs,gp){if(!gp){gp=gs}for(var gr=0;gr<this.ranges.length;gr++){var gq=this.ranges[gr];if(ce(gp,gq.from())>=0&&ce(gs,gq.to())<=0){return gr}}return -1}};function dY(gp,gq){this.anchor=gp;this.head=gq}dY.prototype={from:function(){return aq(this.anchor,this.head)},to:function(){return bw(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function cv(gp,gw){var gr=gp[gw];gp.sort(function(gz,gy){return ce(gz.from(),gy.from())});gw=dh(gp,gr);for(var gt=1;gt<gp.length;gt++){var gx=gp[gt],gq=gp[gt-1];if(ce(gq.to(),gx.from())>=0){var gu=aq(gq.from(),gx.from()),gv=bw(gq.to(),gx.to());var gs=gq.empty()?gx.from()==gx.head:gq.from()==gq.head;if(gt<=gw){--gw}gp.splice(--gt,2,new dY(gs?gv:gu,gs?gu:gv))}}return new f9(gp,gw)}function eW(gp,gq){return new f9([new dY(gp,gq||gp)],0)}function c4(gp,gq){return Math.max(gp.first,Math.min(gq,gp.first+gp.size-1))}function fO(gq,gr){if(gr.line<gq.first){return W(gq.first,0)}var gp=gq.first+gq.size-1;if(gr.line>gp){return W(gp,fk(gq,gp).text.length)}return fx(gr,fk(gq,gr.line).text.length)}function fx(gr,gq){var gp=gr.ch;if(gp==null||gp>gq){return W(gr.line,gq)}else{if(gp<0){return W(gr.line,0)}else{return gr}}}function b8(gq,gp){return gp>=gq.first&&gp<gq.first+gq.size}function d0(gr,gs){for(var gp=[],gq=0;gq<gs.length;gq++){gp[gq]=fO(gr,gs[gq])}return gp}function fA(gu,gq,gt,gp){if(gu.cm&&gu.cm.display.shift||gu.extend){var gs=gq.anchor;if(gp){var gr=ce(gt,gs)<0;if(gr!=(ce(gp,gs)<0)){gs=gt;gt=gp}else{if(gr!=(ce(gt,gp)<0)){gt=gp}}}return new dY(gs,gt)}else{return new dY(gp||gt,gt)}}function f2(gs,gr,gp,gq){bT(gs,new f9([fA(gs,gs.sel.primary(),gr,gp)],0),gq)}function av(gu,gt,gr){for(var gq=[],gs=0;gs<gu.sel.ranges.length;gs++){gq[gs]=fA(gu,gu.sel.ranges[gs],gt[gs],null)}var gp=cv(gq,gu.sel.primIndex);bT(gu,gp,gr)}function e(gt,gs,gq,gr){var gp=gt.sel.ranges.slice(0);gp[gs]=gq;bT(gt,cv(gp,gt.sel.primIndex),gr)}function F(gs,gq,gr,gp){bT(gs,eW(gq,gr),gp)}function c(gs,gq,gp){var gr={ranges:gq.ranges,update:function(gt){this.ranges=[];for(var gu=0;gu<gt.length;gu++){this.ranges[gu]=new dY(fO(gs,gt[gu].anchor),fO(gs,gt[gu].head))}},origin:gp&&gp.origin};aD(gs,"beforeSelectionChange",gs,gr);if(gs.cm){aD(gs.cm,"beforeSelectionChange",gs.cm,gr)}if(gr.ranges!=gq.ranges){return cv(gr.ranges,gr.ranges.length-1)}else{return gq}}function fc(gt,gs,gq){var gp=gt.history.done,gr=fL(gp);if(gr&&gr.ranges){gp[gp.length-1]=gs;es(gt,gs,gq)}else{bT(gt,gs,gq)}}function bT(gr,gq,gp){es(gr,gq,gp);gh(gr,gr.sel,gr.cm?gr.cm.curOp.id:NaN,gp)}function es(gs,gr,gq){if(fn(gs,"beforeSelectionChange")||gs.cm&&fn(gs.cm,"beforeSelectionChange")){gr=c(gs,gr,gq)}var gp=gq&&gq.bias||(ce(gr.primary().head,gs.sel.primary().head)<0?-1:1);c8(gs,n(gs,gr,gp,true));if(!(gq&&gq.scroll===false)&&gs.cm){fK(gs.cm)}}function c8(gq,gp){if(gp.equals(gq.sel)){return}gq.sel=gp;if(gq.cm){gq.cm.curOp.updateInput=gq.cm.curOp.selectionChanged=true;V(gq.cm)}ae(gq,"cursorActivity",gq)}function eB(gp){c8(gp,n(gp,gp.sel,null,false),Z)}function n(gy,gp,gv,gw){var gs;for(var gt=0;gt<gp.ranges.length;gt++){var gu=gp.ranges[gt];var gq=gp.ranges.length==gy.sel.ranges.length&&gy.sel.ranges[gt];var gx=bU(gy,gu.anchor,gq&&gq.anchor,gv,gw);var gr=bU(gy,gu.head,gq&&gq.head,gv,gw);if(gs||gx!=gu.anchor||gr!=gu.head){if(!gs){gs=gp.ranges.slice(0,gt)}gs[gt]=new dY(gx,gr)}}return gs?cv(gs,gp.primIndex):gp}function eM(gz,gx,gs,gr,gv){var gA=fk(gz,gx.line);if(gA.markedSpans){for(var gt=0;gt<gA.markedSpans.length;++gt){var gp=gA.markedSpans[gt],gq=gp.marker;if((gp.from==null||(gq.inclusiveLeft?gp.from<=gx.ch:gp.from<gx.ch))&&(gp.to==null||(gq.inclusiveRight?gp.to>=gx.ch:gp.to>gx.ch))){if(gv){aD(gq,"beforeCursorEnter");if(gq.explicitlyCleared){if(!gA.markedSpans){break}else{--gt;continue}}}if(!gq.atomic){continue}if(gs){var gw=gq.find(gr<0?1:-1),gy;if(gr<0?gq.inclusiveRight:gq.inclusiveLeft){gw=gl(gz,gw,-gr,gA)}if(gw&&gw.line==gx.line&&(gy=ce(gw,gs))&&(gr<0?gy<0:gy>0)){return eM(gz,gw,gx,gr,gv)}}var gu=gq.find(gr<0?-1:1);if(gr<0?gq.inclusiveLeft:gq.inclusiveRight){gu=gl(gz,gu,gr,gA)}return gu?eM(gz,gu,gx,gr,gv):null}}}return gx}function bU(gu,gv,gs,gq,gp){var gr=gq||1;var gt=eM(gu,gv,gs,gr,gp)||(!gp&&eM(gu,gv,gs,gr,true))||eM(gu,gv,gs,-gr,gp)||(!gp&&eM(gu,gv,gs,-gr,true));if(!gt){gu.cantEdit=true;return W(gu.first,0)}return gt}function gl(gr,gs,gq,gp){if(gq<0&&gs.ch==0){if(gs.line>gr.first){return fO(gr,W(gs.line-1))}else{return null}}else{if(gq>0&&gs.ch==(gp||fk(gr,gs.line)).text.length){if(gs.line<gr.first+gr.size-1){return W(gs.line+1,0)}else{return null}}else{return new W(gs.line,gs.ch+gq)}}}function bB(gp){gp.display.input.showSelection(gp.display.input.prepareSelection())}function fN(gw,gp){var gv=gw.doc,gx={};var gu=gx.cursors=document.createDocumentFragment();var gq=gx.selection=document.createDocumentFragment();for(var gs=0;gs<gv.sel.ranges.length;gs++){if(gp===false&&gs==gv.sel.primIndex){continue}var gt=gv.sel.ranges[gs];var gr=gt.empty();if(gr||gw.options.showCursorWhenSelecting){A(gw,gt.head,gu)}if(!gr){bC(gw,gt,gq)}}return gx}function A(gp,gs,gr){var gu=dU(gp,gs,"div",null,null,!gp.options.singleCursorHeightPerLine);var gt=gr.appendChild(f8("div","\u00a0","CodeMirror-cursor"));gt.style.left=gu.left+"px";gt.style.top=gu.top+"px";gt.style.height=Math.max(0,gu.bottom-gu.top)*gp.options.cursorHeight+"px";if(gu.other){var gq=gr.appendChild(f8("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));gq.style.display="";gq.style.left=gu.other.left+"px";gq.style.top=gu.other.top+"px";gq.style.height=(gu.other.bottom-gu.other.top)*0.85+"px"}}function bC(gt,gz,gu){var gC=gt.display,gG=gt.doc;var gp=document.createDocumentFragment();var gy=e9(gt.display),gs=gy.left;var gD=Math.max(gC.sizerWidth,dl(gt)-gC.sizer.offsetLeft)-gy.right;function gA(gK,gJ,gI,gH){if(gJ<0){gJ=0}gJ=Math.round(gJ);gH=Math.round(gH);gp.appendChild(f8("div",null,"CodeMirror-selected","position: absolute; left: "+gK+"px; top: "+gJ+"px; width: "+(gI==null?gD-gK:gI)+"px; height: "+(gH-gJ)+"px"))}function gq(gI,gK,gN){var gJ=fk(gG,gI);var gL=gJ.text.length;var gO,gH;function gM(gQ,gP){return cI(gt,W(gI,gQ),"div",gJ,gP)}d5(a(gJ),gK||0,gN==null?gL:gN,function(gW,gV,gP){var gS=gM(gW,"left"),gT,gU,gR;if(gW==gV){gT=gS;gU=gR=gS.left}else{gT=gM(gV-1,"right");if(gP=="rtl"){var gQ=gS;gS=gT;gT=gQ}gU=gS.left;gR=gT.right}if(gK==null&&gW==0){gU=gs}if(gT.top-gS.top>3){gA(gU,gS.top,null,gS.bottom);gU=gs;if(gS.bottom<gT.top){gA(gU,gS.bottom,null,gT.top)}}if(gN==null&&gV==gL){gR=gD}if(!gO||gS.top<gO.top||gS.top==gO.top&&gS.left<gO.left){gO=gS}if(!gH||gT.bottom>gH.bottom||gT.bottom==gH.bottom&&gT.right>gH.right){gH=gT}if(gU<gs+1){gU=gs}gA(gU,gT.top,gR-gU,gT.bottom)});return{start:gO,end:gH}}var gF=gz.from(),gE=gz.to();if(gF.line==gE.line){gq(gF.line,gF.ch,gE.ch)}else{var gr=fk(gG,gF.line),gw=fk(gG,gE.line);var gv=x(gr)==x(gw);var gx=gq(gF.line,gF.ch,gv?gr.text.length+1:null).end;var gB=gq(gE.line,gv?0:null,gE.ch).start;if(gv){if(gx.top<gB.top-2){gA(gx.right,gx.top,null,gx.bottom);gA(gs,gB.top,gB.left,gB.bottom)}else{gA(gx.right,gx.top,gB.left-gx.right,gx.bottom)}}if(gx.bottom<gB.top){gA(gs,gx.bottom,null,gB.top)}}gu.appendChild(gp)}function o(gp){if(!gp.state.focused){return}var gr=gp.display;clearInterval(gr.blinker);var gq=true;gr.cursorDiv.style.visibility="";if(gp.options.cursorBlinkRate>0){gr.blinker=setInterval(function(){gr.cursorDiv.style.visibility=(gq=!gq)?"":"hidden"},gp.options.cursorBlinkRate)}else{if(gp.options.cursorBlinkRate<0){gr.cursorDiv.style.visibility="hidden"}}}function eh(gp,gq){if(gp.doc.mode.startState&&gp.doc.frontier<gp.display.viewTo){gp.state.highlight.set(gq,cu(cO,gp))}}function cO(gp){var gt=gp.doc;if(gt.frontier<gt.first){gt.frontier=gt.first}if(gt.frontier>=gp.display.viewTo){return}var gr=+new Date+gp.options.workTime;var gs=b2(gt.mode,dC(gp,gt.frontier));var gq=[];gt.iter(gt.frontier,Math.min(gt.first+gt.size,gp.display.viewTo+500),function(gu){if(gt.frontier>=gp.display.viewFrom){var gx=gu.styles,gB=gu.text.length>gp.options.maxHighlightLength;var gz=fE(gp,gu,gB?b2(gt.mode,gs):gs,true);gu.styles=gz.styles;var gw=gu.styleClasses,gy=gz.classes;if(gy){gu.styleClasses=gy}else{if(gw){gu.styleClasses=null}}var gA=!gx||gx.length!=gu.styles.length||gw!=gy&&(!gw||!gy||gw.bgClass!=gy.bgClass||gw.textClass!=gy.textClass);for(var gv=0;!gA&&gv<gx.length;++gv){gA=gx[gv]!=gu.styles[gv]}if(gA){gq.push(gt.frontier)}gu.stateAfter=gB?gs:b2(gt.mode,gs)}else{if(gu.text.length<=gp.options.maxHighlightLength){dx(gp,gu.text,gs)}gu.stateAfter=gt.frontier%5==0?b2(gt.mode,gs):null}++gt.frontier;if(+new Date>gr){eh(gp,gp.options.workDelay);return true}});if(gq.length){cL(gp,function(){for(var gu=0;gu<gq.length;gu++){R(gp,gq[gu],"text")}})}}function cx(gv,gp,gs){var gq,gt,gu=gv.doc;var gr=gs?-1:gp-(gv.doc.mode.innerMode?1000:100);for(var gy=gp;gy>gr;--gy){if(gy<=gu.first){return gu.first}var gx=fk(gu,gy-1);if(gx.stateAfter&&(!gs||gy<=gu.frontier)){return gy}var gw=bS(gx.text,null,gv.options.tabSize);if(gt==null||gq>gw){gt=gy-1;gq=gw}}return gt}function dC(gp,gv,gq){var gt=gp.doc,gs=gp.display;if(!gt.mode.startState){return true}var gu=cx(gp,gv,gq),gr=gu>gt.first&&fk(gt,gu-1).stateAfter;if(!gr){gr=bZ(gt.mode)}else{gr=b2(gt.mode,gr)}gt.iter(gu,gv,function(gw){dx(gp,gw.text,gr);var gx=gu==gv-1||gu%5==0||gu>=gs.viewFrom&&gu<gs.viewTo;gw.stateAfter=gx?b2(gt.mode,gr):null;++gu});if(gq){gt.frontier=gu}return gr}function fd(gp){return gp.lineSpace.offsetTop}function bH(gp){return gp.mover.offsetHeight-gp.lineSpace.offsetHeight}function e9(gs){if(gs.cachedPaddingH){return gs.cachedPaddingH}var gr=bQ(gs.measure,f8("pre","x"));var gp=window.getComputedStyle?window.getComputedStyle(gr):gr.currentStyle;var gq={left:parseInt(gp.paddingLeft),right:parseInt(gp.paddingRight)};if(!isNaN(gq.left)&&!isNaN(gq.right)){gs.cachedPaddingH=gq}return gq}function cS(gp){return dJ-gp.display.nativeBarWidth}function dl(gp){return gp.display.scroller.clientWidth-cS(gp)-gp.display.barWidth}function cU(gp){return gp.display.scroller.clientHeight-cS(gp)-gp.display.barHeight}function cg(gw,gs,gv){var gr=gw.options.lineWrapping;var gt=gr&&dl(gw);if(!gs.measure.heights||gr&&gs.measure.width!=gt){var gu=gs.measure.heights=[];if(gr){gs.measure.width=gt;var gy=gs.text.firstChild.getClientRects();for(var gp=0;gp<gy.length-1;gp++){var gx=gy[gp],gq=gy[gp+1];if(Math.abs(gx.bottom-gq.bottom)>2){gu.push((gx.bottom+gq.top)/2-gv.top)}}}gu.push(gv.bottom-gv.top)}}function cs(gr,gp,gs){if(gr.line==gp){return{map:gr.measure.map,cache:gr.measure.cache}}for(var gq=0;gq<gr.rest.length;gq++){if(gr.rest[gq]==gp){return{map:gr.measure.maps[gq],cache:gr.measure.caches[gq]}}}for(var gq=0;gq<gr.rest.length;gq++){if(bM(gr.rest[gq])>gs){return{map:gr.measure.maps[gq],cache:gr.measure.caches[gq],before:true}}}}function c0(gp,gr){gr=x(gr);var gt=bM(gr);var gq=gp.display.externalMeasured=new bu(gp.doc,gr,gt);gq.lineN=gt;var gs=gq.built=eV(gp,gq);gq.text=gs.pre;bQ(gp.display.lineMeasure,gs.pre);return gq}function ej(gp,gq,gs,gr){return C(gp,a3(gp,gq),gs,gr)}function fg(gp,gr){if(gr>=gp.display.viewFrom&&gr<gp.display.viewTo){return gp.display.view[dr(gp,gr)]}var gq=gp.display.externalMeasured;if(gq&&gr>=gq.lineN&&gr<gq.lineN+gq.size){return gq}}function a3(gp,gr){var gs=bM(gr);var gq=fg(gp,gs);if(gq&&!gq.text){gq=null}else{if(gq&&gq.changes){ab(gp,gq,gs,fi(gp));gp.curOp.forceUpdate=true}}if(!gq){gq=c0(gp,gr)}var gt=cs(gq,gr,gs);return{line:gr,view:gq,rect:null,map:gt.map,cache:gt.cache,before:gt.before,hasHeights:false}}function C(gp,gv,gt,gq,gs){if(gv.before){gt=-1}var gr=gt+(gq||""),gu;if(gv.cache.hasOwnProperty(gr)){gu=gv.cache[gr]}else{if(!gv.rect){gv.rect=gv.view.text.getBoundingClientRect()}if(!gv.hasHeights){cg(gp,gv.view,gv.rect);gv.hasHeights=true}gu=j(gp,gv,gt,gq);if(!gu.bogus){gv.cache[gr]=gu}}return{left:gu.left,right:gu.right,top:gs?gu.rtop:gu.top,bottom:gs?gu.rbottom:gu.bottom}}var eE={left:0,right:0,top:0,bottom:0};function aK(gq,gp,gw){var gs,gr,gu,gx;for(var gv=0;gv<gq.length;gv+=3){var gt=gq[gv],gy=gq[gv+1];if(gp<gt){gr=0;gu=1;gx="left"}else{if(gp<gy){gr=gp-gt;gu=gr+1}else{if(gv==gq.length-3||gp==gy&&gq[gv+3]>gp){gu=gy-gt;gr=gu-1;if(gp>=gy){gx="right"}}}}if(gr!=null){gs=gq[gv+2];if(gt==gy&&gw==(gs.insertLeft?"left":"right")){gx=gw}if(gw=="left"&&gr==0){while(gv&&gq[gv-2]==gq[gv-3]&&gq[gv-1].insertLeft){gs=gq[(gv-=3)+2];gx="left"}}if(gw=="right"&&gr==gy-gt){while(gv<gq.length-3&&gq[gv+3]==gq[gv+4]&&!gq[gv+5].insertLeft){gs=gq[(gv+=3)+2];gx="right"}}break}}return{node:gs,start:gr,end:gu,collapse:gx,coverStart:gt,coverEnd:gy}}function j(gw,gG,gz,gu){var gx=aK(gG.map,gz,gu);var gE=gx.node,gt=gx.start,gs=gx.end,gp=gx.collapse;var gq;if(gE.nodeType==3){for(var gF=0;gF<4;gF++){while(gt&&fu(gG.line.text.charAt(gx.coverStart+gt))){--gt}while(gx.coverStart+gs<gx.coverEnd&&fu(gG.line.text.charAt(gx.coverStart+gs))){++gs}if(dK&&k<9&&gt==0&&gs==gx.coverEnd-gx.coverStart){gq=gE.parentNode.getBoundingClientRect()}else{if(dK&&gw.options.lineWrapping){var gr=ck(gE,gt,gs).getClientRects();if(gr.length){gq=gr[gu=="right"?gr.length-1:0]}else{gq=eE}}else{gq=ck(gE,gt,gs).getBoundingClientRect()||eE}}if(gq.left||gq.right||gt==0){break}gs=gt;gt=gt-1;gp="right"}if(dK&&k<11){gq=eR(gw.display.measure,gq)}}else{if(gt>0){gp=gu="right"}var gr;if(gw.options.lineWrapping&&(gr=gE.getClientRects()).length>1){gq=gr[gu=="right"?gr.length-1:0]}else{gq=gE.getBoundingClientRect()}}if(dK&&k<9&&!gt&&(!gq||!gq.left&&!gq.right)){var gv=gE.parentNode.getClientRects()[0];if(gv){gq={left:gv.left,right:gv.left+dD(gw.display),top:gv.top,bottom:gv.bottom}}else{gq=eE}}var gC=gq.top-gG.rect.top,gA=gq.bottom-gG.rect.top;var gI=(gC+gA)/2;var gH=gG.view.measure.heights;for(var gF=0;gF<gH.length-1;gF++){if(gI<gH[gF]){break}}var gD=gF?gH[gF-1]:0,gB=gH[gF];var gy={left:(gp=="right"?gq.right:gq.left)-gG.rect.left,right:(gp=="left"?gq.left:gq.right)-gG.rect.left,top:gD,bottom:gB};if(!gq.left&&!gq.right){gy.bogus=true}if(!gw.options.singleCursorHeightPerLine){gy.rtop=gC;gy.rbottom=gA}return gy}function eR(gr,gs){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!aJ(gr)){return gs}var gq=screen.logicalXDPI/screen.deviceXDPI;var gp=screen.logicalYDPI/screen.deviceYDPI;return{left:gs.left*gq,right:gs.right*gq,top:gs.top*gp,bottom:gs.bottom*gp}}function at(gq){if(gq.measure){gq.measure.cache={};gq.measure.heights=null;if(gq.rest){for(var gp=0;gp<gq.rest.length;gp++){gq.measure.caches[gp]={}}}}}function aN(gp){gp.display.externalMeasure=null;d2(gp.display.lineMeasure);for(var gq=0;gq<gp.display.view.length;gq++){at(gp.display.view[gq])}}function aj(gp){aN(gp);gp.display.cachedCharWidth=gp.display.cachedTextHeight=gp.display.cachedPaddingH=null;if(!gp.options.lineWrapping){gp.display.maxLineChanged=true}gp.display.lineNumChars=null}function ct(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cr(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function eU(gv,gs,gu,gq){if(gs.widgets){for(var gr=0;gr<gs.widgets.length;++gr){if(gs.widgets[gr].above){var gx=cX(gs.widgets[gr]);gu.top+=gx;gu.bottom+=gx}}}if(gq=="line"){return gu}if(!gq){gq="local"}var gt=bL(gs);if(gq=="local"){gt+=fd(gv.display)}else{gt-=gv.display.viewOffset}if(gq=="page"||gq=="window"){var gp=gv.display.lineSpace.getBoundingClientRect();gt+=gp.top+(gq=="window"?0:cr());var gw=gp.left+(gq=="window"?0:ct());gu.left+=gw;gu.right+=gw}gu.top+=gt;gu.bottom+=gt;return gu}function gk(gq,gt,gr){if(gr=="div"){return gt}var gv=gt.left,gu=gt.top;if(gr=="page"){gv-=ct();gu-=cr()}else{if(gr=="local"||!gr){var gs=gq.display.sizer.getBoundingClientRect();gv+=gs.left;gu+=gs.top}}var gp=gq.display.lineSpace.getBoundingClientRect();return{left:gv-gp.left,top:gu-gp.top}}function cI(gp,gt,gs,gr,gq){if(!gr){gr=fk(gp.doc,gt.line)}return eU(gp,gr,ej(gp,gr,gt.ch,gq),gs)}function dU(gy,gx,gr,gv,gA,gw){gv=gv||fk(gy.doc,gx.line);if(!gA){gA=a3(gy,gv)}function gt(gD,gC){var gB=C(gy,gA,gD,gC?"right":"left",gw);if(gC){gB.left=gB.right}else{gB.right=gB.left}return eU(gy,gv,gB,gr)}function gz(gE,gB){var gC=gu[gB],gD=gC.level%2;if(gE==dy(gC)&&gB&&gC.level<gu[gB-1].level){gC=gu[--gB];gE=gj(gC)-(gC.level%2?0:1);gD=true}else{if(gE==gj(gC)&&gB<gu.length-1&&gC.level<gu[gB+1].level){gC=gu[++gB];gE=dy(gC)-gC.level%2;gD=false}}if(gD&&gE==gC.to&&gE>gC.from){return gt(gE-1)}return gt(gE,gD)}var gu=a(gv),gp=gx.ch;if(!gu){return gt(gp)}var gq=aF(gu,gp);var gs=gz(gp,gq);if(e6!=null){gs.other=gz(gp,e6)}return gs}function dH(gp,gt){var gs=0,gt=fO(gp.doc,gt);if(!gp.options.lineWrapping){gs=dD(gp.display)*gt.ch}var gq=fk(gp.doc,gt.line);var gr=bL(gq)+fd(gp.display);return{left:gs,right:gs,top:gr,bottom:gr+gq.height}}function f7(gp,gq,gr,gt){var gs=W(gp,gq);gs.xRel=gt;if(gr){gs.outside=true}return gs}function fT(gw,gt,gs){var gv=gw.doc;gs+=gw.display.viewOffset;if(gs<0){return f7(gv.first,0,true,-1)}var gr=bF(gv,gs),gx=gv.first+gv.size-1;if(gr>gx){return f7(gv.first+gv.size-1,fk(gv,gx).text.length,true,1)}if(gt<0){gt=0}var gq=fk(gv,gr);for(;;){var gy=cY(gw,gq,gr,gt,gs);var gu=ex(gq);var gp=gu&&gu.find(0,true);if(gu&&(gy.ch>gp.from.ch||gy.ch==gp.from.ch&&gy.xRel>0)){gr=bM(gq=gp.to.line)}else{return gy}}}function cY(gz,gr,gC,gB,gA){var gy=gA-bL(gr);var gv=false,gI=2*gz.display.wrapper.clientWidth;var gF=a3(gz,gr);function gM(gO){var gP=dU(gz,W(gC,gO),"line",gr,gF);gv=true;if(gy>gP.bottom){return gP.left-gI}else{if(gy<gP.top){return gP.left+gI}else{gv=false}}return gP.left}var gE=a(gr),gH=gr.text.length;var gJ=cD(gr),gs=cR(gr);var gG=gM(gJ),gp=gv,gq=gM(gs),gu=gv;if(gB>gq){return f7(gC,gs,gu,1)}for(;;){if(gE?gs==gJ||gs==u(gr,gJ,1):gs-gJ<=1){var gD=gB<gG||gB-gG<=gq-gB?gJ:gs;var gL=gB-(gD==gJ?gG:gq);while(fu(gr.text.charAt(gD))){++gD}var gx=f7(gC,gD,gD==gJ?gp:gu,gL<-1?-1:gL>1?1:0);return gx}var gw=Math.ceil(gH/2),gN=gJ+gw;if(gE){gN=gJ;for(var gK=0;gK<gw;++gK){gN=u(gr,gN,1)}}var gt=gM(gN);if(gt>gB){gs=gN;gq=gt;if(gu=gv){gq+=1000}gH=gw}else{gJ=gN;gG=gt;gp=gv;gH-=gw}}}var aG;function aX(gr){if(gr.cachedTextHeight!=null){return gr.cachedTextHeight}if(aG==null){aG=f8("pre");for(var gq=0;gq<49;++gq){aG.appendChild(document.createTextNode("x"));aG.appendChild(f8("br"))}aG.appendChild(document.createTextNode("x"))}bQ(gr.measure,aG);var gp=aG.offsetHeight/50;if(gp>3){gr.cachedTextHeight=gp}d2(gr.measure);return gp||1}function dD(gt){if(gt.cachedCharWidth!=null){return gt.cachedCharWidth}var gp=f8("span","xxxxxxxxxx");var gs=f8("pre",[gp]);bQ(gt.measure,gs);var gr=gp.getBoundingClientRect(),gq=(gr.right-gr.left)/10;if(gq>2){gt.cachedCharWidth=gq}return gq||10}var bo=null;var d9=0;function cH(gp){gp.curOp={cm:gp,viewChanged:false,startHeight:gp.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++d9};if(bo){bo.ops.push(gp.curOp)}else{gp.curOp.ownsGroup=bo={ops:[gp.curOp],delayedCallbacks:[]}}}function cT(gs){var gr=gs.delayedCallbacks,gq=0;do{for(;gq<gr.length;gq++){gr[gq].call(null)}for(var gp=0;gp<gs.ops.length;gp++){var gt=gs.ops[gp];if(gt.cursorActivityHandlers){while(gt.cursorActivityCalled<gt.cursorActivityHandlers.length){gt.cursorActivityHandlers[gt.cursorActivityCalled++].call(null,gt.cm)}}}}while(gq<gr.length)}function al(gp){var gs=gp.curOp,gr=gs.ownsGroup;if(!gr){return}try{cT(gr)}finally{bo=null;for(var gq=0;gq<gr.ops.length;gq++){gr.ops[gq].cm.curOp=null}cJ(gr)}}function cJ(gr){var gq=gr.ops;for(var gp=0;gp<gq.length;gp++){b4(gq[gp])}for(var gp=0;gp<gq.length;gp++){ap(gq[gp])}for(var gp=0;gp<gq.length;gp++){b1(gq[gp])}for(var gp=0;gp<gq.length;gp++){ao(gq[gp])}for(var gp=0;gp<gq.length;gp++){e4(gq[gp])}}function b4(gr){var gp=gr.cm,gq=gp.display;J(gp);if(gr.updateMaxLine){h(gp)}gr.mustUpdate=gr.viewChanged||gr.forceUpdate||gr.scrollTop!=null||gr.scrollToPos&&(gr.scrollToPos.from.line<gq.viewFrom||gr.scrollToPos.to.line>=gq.viewTo)||gq.maxLineChanged&&gp.options.lineWrapping;gr.update=gr.mustUpdate&&new aH(gp,gr.mustUpdate&&{top:gr.scrollTop,ensure:gr.scrollToPos},gr.forceUpdate)}function ap(gp){gp.updatedDisplay=gp.mustUpdate&&B(gp.cm,gp.update)}function b1(gr){var gp=gr.cm,gq=gp.display;if(gr.updatedDisplay){a8(gp)}gr.barMeasure=dA(gp);if(gq.maxLineChanged&&!gp.options.lineWrapping){gr.adjustWidthTo=ej(gp,gq.maxLine,gq.maxLine.text.length).left+3;gp.display.sizerWidth=gr.adjustWidthTo;gr.barMeasure.scrollWidth=Math.max(gq.scroller.clientWidth,gq.sizer.offsetLeft+gr.adjustWidthTo+cS(gp)+gp.display.barWidth);gr.maxScrollLeft=Math.max(0,gq.sizer.offsetLeft+gr.adjustWidthTo-dl(gp))}if(gr.updatedDisplay||gr.selectionChanged){gr.preparedSelection=gq.input.prepareSelection()}}function ao(gq){var gp=gq.cm;if(gq.adjustWidthTo!=null){gp.display.sizer.style.minWidth=gq.adjustWidthTo+"px";if(gq.maxScrollLeft<gp.doc.scrollLeft){bD(gp,Math.min(gp.display.scroller.scrollLeft,gq.maxScrollLeft),true)}gp.display.maxLineChanged=false}if(gq.preparedSelection){gp.display.input.showSelection(gq.preparedSelection)}if(gq.updatedDisplay){dz(gp,gq.barMeasure)}if(gq.updatedDisplay||gq.startHeight!=gp.doc.height){e2(gp,gq.barMeasure)}if(gq.selectionChanged){o(gp)}if(gp.state.focused&&gq.updateInput){gp.display.input.reset(gq.typing)}if(gq.focus&&gq.focus==dO()&&(!document.hasFocus||document.hasFocus())){r(gq.cm)}}function e4(gw){var gp=gw.cm,gu=gp.display,gt=gp.doc;if(gw.updatedDisplay){ci(gp,gw.update)}if(gu.wheelStartX!=null&&(gw.scrollTop!=null||gw.scrollLeft!=null||gw.scrollToPos)){gu.wheelStartX=gu.wheelStartY=null}if(gw.scrollTop!=null&&(gu.scroller.scrollTop!=gw.scrollTop||gw.forceScroll)){gt.scrollTop=Math.max(0,Math.min(gu.scroller.scrollHeight-gu.scroller.clientHeight,gw.scrollTop));gu.scrollbars.setScrollTop(gt.scrollTop);gu.scroller.scrollTop=gt.scrollTop}if(gw.scrollLeft!=null&&(gu.scroller.scrollLeft!=gw.scrollLeft||gw.forceScroll)){gt.scrollLeft=Math.max(0,Math.min(gu.scroller.scrollWidth-dl(gp),gw.scrollLeft));gu.scrollbars.setScrollLeft(gt.scrollLeft);gu.scroller.scrollLeft=gt.scrollLeft;eH(gp)}if(gw.scrollToPos){var gs=D(gp,fO(gt,gw.scrollToPos.from),fO(gt,gw.scrollToPos.to),gw.scrollToPos.margin);if(gw.scrollToPos.isCursor&&gp.state.focused){d7(gp,gs)}}var gr=gw.maybeHiddenMarkers,gv=gw.maybeUnhiddenMarkers;if(gr){for(var gq=0;gq<gr.length;++gq){if(!gr[gq].lines.length){aD(gr[gq],"hide")}}}if(gv){for(var gq=0;gq<gv.length;++gq){if(gv[gq].lines.length){aD(gv[gq],"unhide")}}}if(gu.wrapper.offsetHeight){gt.scrollTop=gp.display.scroller.scrollTop}if(gw.changeObjs){aD(gp,"changes",gp,gw.changeObjs)}if(gw.update){gw.update.finish()}}function cL(gp,gq){if(gp.curOp){return gq()}cH(gp);try{return gq()}finally{al(gp)}}function c1(gp,gq){return function(){if(gp.curOp){return gq.apply(gp,arguments)}cH(gp);try{return gq.apply(gp,arguments)}finally{al(gp)}}}function c7(gp){return function(){if(this.curOp){return gp.apply(this,arguments)}cH(this);try{return gp.apply(this,arguments)}finally{al(this)}}}function cC(gp){return function(){var gq=this.cm;if(!gq||gq.curOp){return gp.apply(this,arguments)}cH(gq);try{return gp.apply(this,arguments)}finally{al(gq)}}}function bu(gr,gp,gq){this.line=gp;this.rest=g(gp);this.size=this.rest?bM(fL(this.rest))-gq+1:1;this.node=this.text=null;this.hidden=fB(gr,gp)}function eZ(gp,gv,gu){var gt=[],gr;for(var gs=gv;gs<gu;gs=gr){var gq=new bu(gp.doc,fk(gp.doc,gs),gs);gr=gs+gq.size;gt.push(gq)}return gt}function ah(gw,gu,gv,gx){if(gu==null){gu=gw.doc.first}if(gv==null){gv=gw.doc.first+gw.doc.size}if(!gx){gx=0}var gr=gw.display;if(gx&&gv<gr.viewTo&&(gr.updateLineNumbers==null||gr.updateLineNumbers>gu)){gr.updateLineNumbers=gu}gw.curOp.viewChanged=true;if(gu>=gr.viewTo){if(a6&&aV(gw.doc,gu)<gr.viewTo){eA(gw)}}else{if(gv<=gr.viewFrom){if(a6&&d3(gw.doc,gv+gx)>gr.viewFrom){eA(gw)}else{gr.viewFrom+=gx;gr.viewTo+=gx}}else{if(gu<=gr.viewFrom&&gv>=gr.viewTo){eA(gw)}else{if(gu<=gr.viewFrom){var gt=de(gw,gv,gv+gx,1);if(gt){gr.view=gr.view.slice(gt.index);gr.viewFrom=gt.lineN;gr.viewTo+=gx}else{eA(gw)}}else{if(gv>=gr.viewTo){var gt=de(gw,gu,gu,-1);if(gt){gr.view=gr.view.slice(0,gt.index);gr.viewTo=gt.lineN}else{eA(gw)}}else{var gs=de(gw,gu,gu,-1);var gq=de(gw,gv,gv+gx,1);if(gs&&gq){gr.view=gr.view.slice(0,gs.index).concat(eZ(gw,gs.lineN,gq.lineN)).concat(gr.view.slice(gq.index));gr.viewTo+=gx}else{eA(gw)}}}}}}var gp=gr.externalMeasured;if(gp){if(gv<gp.lineN){gp.lineN+=gx}else{if(gu<gp.lineN+gp.size){gr.externalMeasured=null}}}}function R(gq,gr,gu){gq.curOp.viewChanged=true;var gv=gq.display,gt=gq.display.externalMeasured;if(gt&&gr>=gt.lineN&&gr<gt.lineN+gt.size){gv.externalMeasured=null}if(gr<gv.viewFrom||gr>=gv.viewTo){return}var gs=gv.view[dr(gq,gr)];if(gs.node==null){return}var gp=gs.changes||(gs.changes=[]);if(dh(gp,gu)==-1){gp.push(gu)}}function eA(gp){gp.display.viewFrom=gp.display.viewTo=gp.doc.first;gp.display.view=[];gp.display.viewOffset=0}function dr(gp,gs){if(gs>=gp.display.viewTo){return null}gs-=gp.display.viewFrom;if(gs<0){return null}var gq=gp.display.view;for(var gr=0;gr<gq.length;gr++){gs-=gq[gr].size;if(gs<0){return gr}}}function de(gx,gr,gt,gq){var gu=dr(gx,gr),gw,gv=gx.display.view;if(!a6||gt==gx.doc.first+gx.doc.size){return{index:gu,lineN:gt}}for(var gs=0,gp=gx.display.viewFrom;gs<gu;gs++){gp+=gv[gs].size}if(gp!=gr){if(gq>0){if(gu==gv.length-1){return null}gw=(gp+gv[gu].size)-gr;gu++}else{gw=gp-gr}gr+=gw;gt+=gw}while(aV(gx.doc,gt)!=gt){if(gu==(gq<0?0:gv.length-1)){return null}gt+=gq*gv[gu-(gq<0?1:0)].size;gu+=gq}return{index:gu,lineN:gt}}function cQ(gp,gt,gs){var gr=gp.display,gq=gr.view;if(gq.length==0||gt>=gr.viewTo||gs<=gr.viewFrom){gr.view=eZ(gp,gt,gs);gr.viewFrom=gt}else{if(gr.viewFrom>gt){gr.view=eZ(gp,gt,gr.viewFrom).concat(gr.view)}else{if(gr.viewFrom<gt){gr.view=gr.view.slice(dr(gp,gt))}}gr.viewFrom=gt;if(gr.viewTo<gs){gr.view=gr.view.concat(eZ(gp,gr.viewTo,gs))}else{if(gr.viewTo>gs){gr.view=gr.view.slice(0,dr(gp,gs))}}}gr.viewTo=gs}function db(gp){var gq=gp.display.view,gt=0;for(var gs=0;gs<gq.length;gs++){var gr=gq[gs];if(!gr.hidden&&(!gr.node||gr.changes)){++gt}}return gt}function fV(gq){var gu=gq.display;bW(gu.scroller,"mousedown",c1(gq,ey));if(dK&&k<11){bW(gu.scroller,"dblclick",c1(gq,function(gy){if(aQ(gq,gy)){return}var gz=cm(gq,gy);if(!gz||l(gq,gy)||ba(gq.display,gy)){return}cF(gy);var gx=gq.findWordAt(gz);f2(gq.doc,gx.anchor,gx.head)}))}else{bW(gu.scroller,"dblclick",function(gx){aQ(gq,gx)||cF(gx)})}if(!gf){bW(gu.scroller,"contextmenu",function(gx){ax(gq,gx)})}var gw,gp={end:0};function gv(){if(gu.activeTouch){gw=setTimeout(function(){gu.activeTouch=null},1000);gp=gu.activeTouch;gp.end=+new Date}}function gs(gx){if(gx.touches.length!=1){return false}var gy=gx.touches[0];return gy.radiusX<=1&&gy.radiusY<=1}function gr(gA,gx){if(gx.left==null){return true}var gz=gx.left-gA.left,gy=gx.top-gA.top;return gz*gz+gy*gy>20*20}bW(gu.scroller,"touchstart",function(gy){if(!gs(gy)){clearTimeout(gw);var gx=+new Date;gu.activeTouch={start:gx,moved:false,prev:gx-gp.end<=300?gp:null};if(gy.touches.length==1){gu.activeTouch.left=gy.touches[0].pageX;gu.activeTouch.top=gy.touches[0].pageY}}});bW(gu.scroller,"touchmove",function(){if(gu.activeTouch){gu.activeTouch.moved=true}});bW(gu.scroller,"touchend",function(gy){var gA=gu.activeTouch;if(gA&&!ba(gu,gy)&&gA.left!=null&&!gA.moved&&new Date-gA.start<300){var gz=gq.coordsChar(gu.activeTouch,"page"),gx;if(!gA.prev||gr(gA,gA.prev)){gx=new dY(gz,gz)}else{if(!gA.prev.prev||gr(gA,gA.prev.prev)){gx=gq.findWordAt(gz)}else{gx=new dY(W(gz.line,0),fO(gq.doc,W(gz.line+1,0)))}}gq.setSelection(gx.anchor,gx.head);gq.focus();cF(gy)}gv()});bW(gu.scroller,"touchcancel",gv);bW(gu.scroller,"scroll",function(){if(gu.scroller.clientHeight){N(gq,gu.scroller.scrollTop);bD(gq,gu.scroller.scrollLeft,true);aD(gq,"scroll",gq)}});bW(gu.scroller,"mousewheel",function(gx){b(gq,gx)});bW(gu.scroller,"DOMMouseScroll",function(gx){b(gq,gx)});bW(gu.wrapper,"scroll",function(){gu.wrapper.scrollTop=gu.wrapper.scrollLeft=0});gu.dragFunctions={enter:function(gx){if(!aQ(gq,gx)){eu(gx)}},over:function(gx){if(!aQ(gq,gx)){gm(gq,gx);eu(gx)}},start:function(gx){Q(gq,gx)},drop:c1(gq,bj),leave:function(){da(gq)}};var gt=gu.input.getField();bW(gt,"keyup",function(gx){bh.call(gq,gx)});bW(gt,"keydown",c1(gq,p));bW(gt,"keypress",c1(gq,cw));bW(gt,"focus",cu(cA,gq));bW(gt,"blur",cu(aU,gq))}function f6(gq,gt,gr){var gu=gr&&gr!=H.Init;if(!gt!=!gu){var gs=gq.display.dragFunctions;var gp=gt?bW:ef;gp(gq.display.scroller,"dragstart",gs.start);gp(gq.display.scroller,"dragenter",gs.enter);gp(gq.display.scroller,"dragover",gs.over);gp(gq.display.scroller,"dragleave",gs.leave);gp(gq.display.scroller,"drop",gs.drop)}}function aS(gp){var gq=gp.display;if(gq.lastWrapHeight==gq.wrapper.clientHeight&&gq.lastWrapWidth==gq.wrapper.clientWidth){return}gq.cachedCharWidth=gq.cachedTextHeight=gq.cachedPaddingH=null;gq.scrollbarsClipped=false;gp.setSize()}function ba(gq,gp){for(var gr=L(gp);gr!=gq.wrapper;gr=gr.parentNode){if(!gr||(gr.nodeType==1&&gr.getAttribute("cm-ignore-events")=="true")||(gr.parentNode==gq.sizer&&gr!=gq.mover)){return true}}}function cm(gy,gt,gq,gr){var gu=gy.display;if(!gq&&L(gt).getAttribute("cm-not-content")=="true"){return null}var gx,gv,gp=gu.lineSpace.getBoundingClientRect();try{gx=gt.clientX-gp.left;gv=gt.clientY-gp.top}catch(gt){return null}var gw=fT(gy,gx,gv),gz;if(gr&&gw.xRel==1&&(gz=fk(gy.doc,gw.line).text).length==gw.ch){var gs=bS(gz,gz.length,gy.options.tabSize)-gz.length;gw=W(gw.line,Math.max(0,Math.round((gx-e9(gy.display).left)/dD(gy.display))-gs))}return gw}function ey(gr){var gp=this,gq=gp.display;if(gq.activeTouch&&gq.input.supportsTouch()||aQ(gp,gr)){return}gq.shift=gr.shiftKey;if(ba(gq,gr)){if(!cZ){gq.scroller.draggable=false;setTimeout(function(){gq.scroller.draggable=true},100)}return}if(l(gp,gr)){return}var gs=cm(gp,gr);window.focus();switch(fS(gr)){case 1:if(gp.state.selectingText){gp.state.selectingText(gr)}else{if(gs){aw(gp,gr,gs)}else{if(L(gr)==gq.scroller){cF(gr)}}}break;case 2:if(cZ){gp.state.lastMiddleDown=+new Date}if(gs){f2(gp.doc,gs)}setTimeout(function(){gq.input.focus()},20);cF(gr);break;case 3:if(gf){ax(gp,gr)}else{ak(gp)}break}}var dn,dd;function aw(gq,gv,gw){if(dK){setTimeout(cu(r,gq),0)}else{gq.curOp.focus=dO()}var gr=+new Date,gt;if(dd&&dd.time>gr-400&&ce(dd.pos,gw)==0){gt="triple"}else{if(dn&&dn.time>gr-400&&ce(dn.pos,gw)==0){gt="double";dd={time:gr,pos:gw}}else{gt="single";dn={time:gr,pos:gw}}}var gu=gq.doc.sel,gp=b6?gv.metaKey:gv.ctrlKey,gs;if(gq.options.dragDrop&&eP&&!gq.isReadOnly()&&gt=="single"&&(gs=gu.contains(gw))>-1&&(ce((gs=gu.ranges[gs]).from(),gw)<0||gw.xRel>0)&&(ce(gs.to(),gw)>0||gw.xRel<0)){a2(gq,gv,gw,gp)}else{m(gq,gv,gw,gt,gp)}}function a2(gr,gu,gv,gq){var gt=gr.display,gs=+new Date;var gp=c1(gr,function(gw){if(cZ){gt.scroller.draggable=false}gr.state.draggingText=false;ef(document,"mouseup",gp);ef(gt.scroller,"drop",gp);if(Math.abs(gu.clientX-gw.clientX)+Math.abs(gu.clientY-gw.clientY)<10){cF(gw);if(!gq&&+new Date-200<gs){f2(gr.doc,gv)}if(cZ||dK&&k==9){setTimeout(function(){document.body.focus();gt.input.focus()},20)}else{gt.input.focus()}}});if(cZ){gt.scroller.draggable=true}gr.state.draggingText=gp;if(gt.scroller.dragDrop){gt.scroller.dragDrop()}bW(document,"mouseup",gp);bW(gt.scroller,"drop",gp)}function m(gt,gH,gs,gq,gv){var gE=gt.display,gJ=gt.doc;cF(gH);var gr,gI,gu=gJ.sel,gp=gu.ranges;if(gv&&!gH.shiftKey){gI=gJ.sel.contains(gs);if(gI>-1){gr=gp[gI]}else{gr=new dY(gs,gs)}}else{gr=gJ.sel.primary();gI=gJ.sel.primIndex}if(gH.altKey){gq="rect";if(!gv){gr=new dY(gs,gs)}gs=cm(gt,gH,true,true);gI=-1}else{if(gq=="double"){var gF=gt.findWordAt(gs);if(gt.display.shift||gJ.extend){gr=fA(gJ,gr,gF.anchor,gF.head)}else{gr=gF}}else{if(gq=="triple"){var gy=new dY(W(gs.line,0),fO(gJ,W(gs.line+1,0)));if(gt.display.shift||gJ.extend){gr=fA(gJ,gr,gy.anchor,gy.head)}else{gr=gy}}else{gr=fA(gJ,gr,gs)}}}if(!gv){gI=0;bT(gJ,new f9([gr],0),M);gu=gJ.sel}else{if(gI==-1){gI=gp.length;bT(gJ,cv(gp.concat([gr]),gI),{scroll:false,origin:"*mouse"})}else{if(gp.length>1&&gp[gI].empty()&&gq=="single"&&!gH.shiftKey){bT(gJ,cv(gp.slice(0,gI).concat(gp.slice(gI+1)),0),{scroll:false,origin:"*mouse"});gu=gJ.sel}else{e(gJ,gI,gr,M)}}}var gD=gs;function gC(gU){if(ce(gD,gU)==0){return}gD=gU;if(gq=="rect"){var gL=[],gR=gt.options.tabSize;var gK=bS(fk(gJ,gs.line).text,gs.ch,gR);var gX=bS(fk(gJ,gU.line).text,gU.ch,gR);var gM=Math.min(gK,gX),gV=Math.max(gK,gX);for(var gY=Math.min(gs.line,gU.line),gO=Math.min(gt.lastLine(),Math.max(gs.line,gU.line));gY<=gO;gY++){var gW=fk(gJ,gY).text,gN=et(gW,gM,gR);if(gM==gV){gL.push(new dY(W(gY,gN),W(gY,gN)))}else{if(gW.length>gN){gL.push(new dY(W(gY,gN),W(gY,et(gW,gV,gR))))}}}if(!gL.length){gL.push(new dY(gs,gs))}bT(gJ,cv(gu.ranges.slice(0,gI).concat(gL),gI),{origin:"*mouse",scroll:false});gt.scrollIntoView(gU)}else{var gS=gr;var gP=gS.anchor,gT=gU;if(gq!="single"){if(gq=="double"){var gQ=gt.findWordAt(gU)}else{var gQ=new dY(W(gU.line,0),fO(gJ,W(gU.line+1,0)))}if(ce(gQ.anchor,gP)>0){gT=gQ.head;gP=aq(gS.from(),gQ.anchor)}else{gT=gQ.anchor;gP=bw(gS.to(),gQ.head)}}var gL=gu.ranges.slice(0);gL[gI]=new dY(fO(gJ,gP),gT);bT(gJ,cv(gL,gI),M)}}var gA=gE.wrapper.getBoundingClientRect();var gw=0;function gG(gM){var gK=++gw;var gO=cm(gt,gM,true,gq=="rect");if(!gO){return}if(ce(gO,gD)!=0){gt.curOp.focus=dO();gC(gO);var gN=b5(gE,gJ);if(gO.line>=gN.to||gO.line<gN.from){setTimeout(c1(gt,function(){if(gw==gK){gG(gM)}}),150)}}else{var gL=gM.clientY<gA.top?-20:gM.clientY>gA.bottom?20:0;if(gL){setTimeout(c1(gt,function(){if(gw!=gK){return}gE.scroller.scrollTop+=gL;gG(gM)}),50)}}}function gz(gK){gt.state.selectingText=false;gw=Infinity;cF(gK);gE.input.focus();ef(document,"mousemove",gB);ef(document,"mouseup",gx);gJ.history.lastSelOrigin=null}var gB=c1(gt,function(gK){if(!fS(gK)){gz(gK)}else{gG(gK)}});var gx=c1(gt,gz);gt.state.selectingText=gx;bW(document,"mousemove",gB);bW(document,"mouseup",gx)}function gn(gz,gv,gx,gy){try{var gq=gv.clientX,gp=gv.clientY}catch(gv){return false}if(gq>=Math.floor(gz.display.gutters.getBoundingClientRect().right)){return false}if(gy){cF(gv)}var gw=gz.display;var gu=gw.lineDiv.getBoundingClientRect();if(gp>gu.bottom||!fn(gz,gx)){return bK(gv)}gp-=gu.top-gw.viewOffset;for(var gs=0;gs<gz.options.gutters.length;++gs){var gt=gw.gutters.childNodes[gs];if(gt&&gt.getBoundingClientRect().right>=gq){var gA=bF(gz.doc,gp);var gr=gz.options.gutters[gs];aD(gz,gx,gz,gA,gr,gv);return bK(gv)}}}function l(gp,gq){return gn(gp,gq,"gutterClick",true)}var ag=0;function bj(gv){var gx=this;da(gx);if(aQ(gx,gv)||ba(gx.display,gv)){return}cF(gv);if(dK){ag=+new Date}var gw=cm(gx,gv,true),gp=gv.dataTransfer.files;if(!gw||gx.isReadOnly()){return}if(gp&&gp.length&&window.FileReader&&window.File){var gr=gp.length,gy=Array(gr),gq=0;var gt=function(gB,gA){if(gx.options.allowDropFileTypes&&dh(gx.options.allowDropFileTypes,gB.type)==-1){return}var gz=new FileReader;gz.onload=c1(gx,function(){var gC=gz.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(gC)){gC=""}gy[gA]=gC;if(++gq==gr){gw=fO(gx.doc,gw);var gD={from:gw,to:gw,text:gx.doc.splitLines(gy.join(gx.doc.lineSeparator())),origin:"paste"};bf(gx.doc,gD);fc(gx.doc,eW(gw,cW(gD)))}});gz.readAsText(gB)};for(var gu=0;gu<gr;++gu){gt(gp[gu],gu)}}else{if(gx.state.draggingText&&gx.doc.sel.contains(gw)>-1){gx.state.draggingText(gv);setTimeout(function(){gx.display.input.focus()},20);return}try{var gy=gv.dataTransfer.getData("Text");if(gy){if(gx.state.draggingText&&!(b6?gv.altKey:gv.ctrlKey)){var gs=gx.listSelections()}es(gx.doc,eW(gw,gw));if(gs){for(var gu=0;gu<gs.length;++gu){a0(gx.doc,"",gs[gu].anchor,gs[gu].head,"drag")}}gx.replaceSelection(gy,"around","paste");gx.display.input.focus()}}catch(gv){}}}function Q(gp,gr){if(dK&&(!gp.state.draggingText||+new Date-ag<100)){eu(gr);return}if(aQ(gp,gr)||ba(gp.display,gr)){return}gr.dataTransfer.setData("Text",gp.getSelection());if(gr.dataTransfer.setDragImage&&!aB){var gq=f8("img",null,null,"position: fixed; left: 0; top: 0;");gq.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(d4){gq.width=gq.height=1;gp.display.wrapper.appendChild(gq);gq._top=gq.offsetTop}gr.dataTransfer.setDragImage(gq,0,0);if(d4){gq.parentNode.removeChild(gq)}}}function gm(gp,gq){var gs=cm(gp,gq);if(!gs){return}var gr=document.createDocumentFragment();A(gp,gs,gr);if(!gp.display.dragCursor){gp.display.dragCursor=f8("div",null,"CodeMirror-cursors CodeMirror-dragcursors");gp.display.lineSpace.insertBefore(gp.display.dragCursor,gp.display.cursorDiv)}bQ(gp.display.dragCursor,gr)}function da(gp){if(gp.display.dragCursor){gp.display.lineSpace.removeChild(gp.display.dragCursor);gp.display.dragCursor=null}}function N(gp,gq){if(Math.abs(gp.doc.scrollTop-gq)<2){return}gp.doc.scrollTop=gq;if(!cn){dT(gp,{top:gq})}if(gp.display.scroller.scrollTop!=gq){gp.display.scroller.scrollTop=gq}gp.display.scrollbars.setScrollTop(gq);if(cn){dT(gp)}eh(gp,100)}function bD(gp,gr,gq){if(gq?gr==gp.doc.scrollLeft:Math.abs(gp.doc.scrollLeft-gr)<2){return}gr=Math.min(gr,gp.display.scroller.scrollWidth-gp.display.scroller.clientWidth);gp.doc.scrollLeft=gr;eH(gp);if(gp.display.scroller.scrollLeft!=gr){gp.display.scroller.scrollLeft=gr}gp.display.scrollbars.setScrollLeft(gr)}var fr=0,cf=null;if(dK){cf=-0.53}else{if(cn){cf=15}else{if(dc){cf=-0.7}else{if(aB){cf=-1/3}}}}var cP=function(gr){var gq=gr.wheelDeltaX,gp=gr.wheelDeltaY;if(gq==null&&gr.detail&&gr.axis==gr.HORIZONTAL_AXIS){gq=gr.detail}if(gp==null&&gr.detail&&gr.axis==gr.VERTICAL_AXIS){gp=gr.detail}else{if(gp==null){gp=gr.wheelDelta}}return{x:gq,y:gp}};H.wheelEventPixels=function(gp){var gq=cP(gp);gq.x*=cf;gq.y*=cf;return gq};function b(gz,gt){var gB=cP(gt),gD=gB.x,gC=gB.y;var gv=gz.display,gy=gv.scroller;var gs=gy.scrollWidth>gy.clientWidth;var gr=gy.scrollHeight>gy.clientHeight;if(!(gD&&gs||gC&&gr)){return}if(gC&&b6&&cZ){outer:for(var gA=gt.target,gx=gv.view;gA!=gy;gA=gA.parentNode){for(var gq=0;gq<gx.length;gq++){if(gx[gq].node==gA){gz.display.currentWheelTarget=gA;break outer}}}}if(gD&&!cn&&!d4&&cf!=null){if(gC&&gr){N(gz,Math.max(0,Math.min(gy.scrollTop+gC*cf,gy.scrollHeight-gy.clientHeight)))}bD(gz,Math.max(0,Math.min(gy.scrollLeft+gD*cf,gy.scrollWidth-gy.clientWidth)));if(!gC||(gC&&gr)){cF(gt)}gv.wheelStartX=null;return}if(gC&&cf!=null){var gp=gC*cf;var gw=gz.doc.scrollTop,gu=gw+gv.wrapper.clientHeight;if(gp<0){gw=Math.max(0,gw+gp-50)}else{gu=Math.min(gz.doc.height,gu+gp+50)}dT(gz,{top:gw,bottom:gu})}if(fr<20){if(gv.wheelStartX==null){gv.wheelStartX=gy.scrollLeft;gv.wheelStartY=gy.scrollTop;gv.wheelDX=gD;gv.wheelDY=gC;setTimeout(function(){if(gv.wheelStartX==null){return}var gE=gy.scrollLeft-gv.wheelStartX;var gG=gy.scrollTop-gv.wheelStartY;var gF=(gG&&gv.wheelDY&&gG/gv.wheelDY)||(gE&&gv.wheelDX&&gE/gv.wheelDX);gv.wheelStartX=gv.wheelStartY=null;if(!gF){return}cf=(cf*fr+gF)/(fr+1);++fr},200)}else{gv.wheelDX+=gD;gv.wheelDY+=gC}}}function fW(gq,gt,gp){if(typeof gt=="string"){gt=eG[gt];if(!gt){return false}}gq.display.input.ensurePolled();var gs=gq.display.shift,gr=false;try{if(gq.isReadOnly()){gq.state.suppressEdits=true}if(gp){gq.display.shift=false}gr=gt(gq)!=b9}finally{gq.display.shift=gs;gq.state.suppressEdits=false}return gr}function eb(gq,gr,gt){for(var gs=0;gs<gq.state.keyMaps.length;gs++){var gp=i(gr,gq.state.keyMaps[gs],gt,gq);if(gp){return gp}}return(gq.options.extraKeys&&i(gr,gq.options.extraKeys,gt,gq))||i(gr,gq.options.keyMap,gt,gq)}var dM=new go;function bc(gq,gs,gu,gt){var gr=gq.state.keySeq;if(gr){if(eF(gs)){return"handled"}dM.set(50,function(){if(gq.state.keySeq==gr){gq.state.keySeq=null;gq.display.input.reset()}});gs=gr+" "+gs}var gp=eb(gq,gs,gt);if(gp=="multi"){gq.state.keySeq=gs}if(gp=="handled"){ae(gq,"keyHandled",gq,gs,gu)}if(gp=="handled"||gp=="multi"){cF(gu);o(gq)}if(gr&&!gp&&/\'$/.test(gs)){cF(gu);return true}return !!gp}function fo(gp,gr){var gq=fw(gr,true);if(!gq){return false}if(gr.shiftKey&&!gp.state.keySeq){return bc(gp,"Shift-"+gq,gr,function(gs){return fW(gp,gs,true)})||bc(gp,gq,gr,function(gs){if(typeof gs=="string"?/^go[A-Z]/.test(gs):gs.motion){return fW(gp,gs)}})}else{return bc(gp,gq,gr,function(gs){return fW(gp,gs)})}}function el(gp,gr,gq){return bc(gp,"'"+gq+"'",gr,function(gs){return fW(gp,gs,true)})}var dm=null;function p(gs){var gp=this;gp.curOp.focus=dO();if(aQ(gp,gs)){return}if(dK&&k<11&&gs.keyCode==27){gs.returnValue=false}var gq=gs.keyCode;gp.display.shift=gq==16||gs.shiftKey;var gr=fo(gp,gs);if(d4){dm=gr?gq:null;if(!gr&&gq==88&&!c9&&(b6?gs.metaKey:gs.ctrlKey)){gp.replaceSelection("",null,"cut")}}if(gq==18&&!/\bCodeMirror-crosshair\b/.test(gp.display.lineDiv.className)){au(gp)}}function au(gq){var gr=gq.display.lineDiv;fF(gr,"CodeMirror-crosshair");function gp(gs){if(gs.keyCode==18||!gs.altKey){f(gr,"CodeMirror-crosshair");ef(document,"keyup",gp);ef(document,"mouseover",gp)}}bW(document,"keyup",gp);bW(document,"mouseover",gp)}function bh(gp){if(gp.keyCode==16){this.doc.sel.shift=false}aQ(this,gp)}function cw(gt){var gp=this;if(ba(gp.display,gt)||aQ(gp,gt)||gt.ctrlKey&&!gt.altKey||b6&&gt.metaKey){return}var gs=gt.keyCode,gq=gt.charCode;if(d4&&gs==dm){dm=null;cF(gt);return}if((d4&&(!gt.which||gt.which<10))&&fo(gp,gt)){return}var gr=String.fromCharCode(gq==null?gs:gq);if(el(gp,gt,gr)){return}gp.display.input.onKeyPress(gt)}function ak(gp){gp.state.delayingBlurEvent=true;setTimeout(function(){if(gp.state.delayingBlurEvent){gp.state.delayingBlurEvent=false;aU(gp)}},100)}function cA(gp){if(gp.state.delayingBlurEvent){gp.state.delayingBlurEvent=false}if(gp.options.readOnly=="nocursor"){return}if(!gp.state.focused){aD(gp,"focus",gp);gp.state.focused=true;fF(gp.display.wrapper,"CodeMirror-focused");if(!gp.curOp&&gp.display.selForContextMenu!=gp.doc.sel){gp.display.input.reset();if(cZ){setTimeout(function(){gp.display.input.reset(true)},20)}}gp.display.input.receivedFocus()}o(gp)}function aU(gp){if(gp.state.delayingBlurEvent){return}if(gp.state.focused){aD(gp,"blur",gp);gp.state.focused=false;f(gp.display.wrapper,"CodeMirror-focused")}clearInterval(gp.display.blinker);setTimeout(function(){if(!gp.state.focused){gp.display.shift=false}},150)}function ax(gp,gq){if(ba(gp.display,gq)||dg(gp,gq)){return}if(aQ(gp,gq,"contextmenu")){return}gp.display.input.onContextMenu(gq)}function dg(gp,gq){if(!fn(gp,"gutterContextMenu")){return false}return gn(gp,gq,"gutterContextMenu",false)}var cW=H.changeEnd=function(gp){if(!gp.text){return gp.to}return W(gp.from.line+gp.text.length-1,fL(gp.text).length+(gp.text.length==1?gp.from.ch:0))};function bY(gs,gr){if(ce(gs,gr.from)<0){return gs}if(ce(gs,gr.to)<=0){return cW(gr)}var gp=gs.line+gr.text.length-(gr.to.line-gr.from.line)-1,gq=gs.ch;if(gs.line==gr.to.line){gq+=cW(gr).ch-gr.to.ch}return W(gp,gq)}function fp(gs,gt){var gq=[];for(var gr=0;gr<gs.sel.ranges.length;gr++){var gp=gs.sel.ranges[gr];gq.push(new dY(bY(gp.anchor,gt),bY(gp.head,gt)))}return cv(gq,gs.sel.primIndex)}function bt(gr,gq,gp){if(gr.line==gq.line){return W(gp.line,gr.ch-gq.ch+gp.ch)}else{return W(gp.line+(gr.line-gq.line),gr.ch)}}function af(gz,gw,gq){var gr=[];var gp=W(gz.first,0),gA=gp;for(var gt=0;gt<gw.length;gt++){var gv=gw[gt];var gy=bt(gv.from,gp,gA);var gx=bt(cW(gv),gp,gA);gp=gv.to;gA=gx;if(gq=="around"){var gu=gz.sel.ranges[gt],gs=ce(gu.head,gu.anchor)<0;gr[gt]=new dY(gs?gx:gy,gs?gy:gx)}else{gr[gt]=new dY(gy,gy)}}return new f9(gr,gz.sel.primIndex)}function dR(gq,gs,gr){var gp={canceled:false,from:gs.from,to:gs.to,text:gs.text,origin:gs.origin,cancel:function(){this.canceled=true}};if(gr){gp.update=function(gw,gv,gu,gt){if(gw){this.from=fO(gq,gw)}if(gv){this.to=fO(gq,gv)}if(gu){this.text=gu}if(gt!==undefined){this.origin=gt}}}aD(gq,"beforeChange",gq,gp);if(gq.cm){aD(gq.cm,"beforeChange",gq.cm,gp)}if(gp.canceled){return null}return{from:gp.from,to:gp.to,text:gp.text,origin:gp.origin}}function bf(gs,gt,gr){if(gs.cm){if(!gs.cm.curOp){return c1(gs.cm,bf)(gs,gt,gr)}if(gs.cm.state.suppressEdits){return}}if(fn(gs,"beforeChange")||gs.cm&&fn(gs.cm,"beforeChange")){gt=dR(gs,gt,true);if(!gt){return}}var gq=gi&&!gr&&cG(gs,gt.from,gt.to);if(gq){for(var gp=gq.length-1;gp>=0;--gp){K(gs,{from:gq[gp].from,to:gq[gp].to,text:gp?[""]:gt.text})}}else{K(gs,gt)}}function K(gr,gs){if(gs.text.length==1&&gs.text[0]==""&&ce(gs.from,gs.to)==0){return}var gq=fp(gr,gs);fR(gr,gs,gq,gr.cm?gr.cm.curOp.id:NaN);eg(gr,gs,gq,em(gr,gs));var gp=[];d8(gr,function(gu,gt){if(!gt&&dh(gp,gu.history)==-1){dE(gu.history,gs);gp.push(gu.history)}eg(gu,gs,null,em(gu,gs))})}function b7(gA,gy,gC){if(gA.cm&&gA.cm.state.suppressEdits){return}var gx=gA.history,gr,gt=gA.sel;var gp=gy=="undo"?gx.done:gx.undone,gB=gy=="undo"?gx.undone:gx.done;for(var gu=0;gu<gp.length;gu++){gr=gp[gu];if(gC?gr.ranges&&!gr.equals(gA.sel):!gr.ranges){break}}if(gu==gp.length){return}gx.lastOrigin=gx.lastSelOrigin=null;for(;;){gr=gp.pop();if(gr.ranges){cM(gr,gB);if(gC&&!gr.equals(gA.sel)){bT(gA,gr,{clearRedo:false});return}gt=gr}else{break}}var gw=[];cM(gt,gB);gB.push({changes:gw,generation:gx.generation});gx.generation=gr.generation||++gx.maxGeneration;var gs=fn(gA,"beforeChange")||gA.cm&&fn(gA.cm,"beforeChange");for(var gu=gr.changes.length-1;gu>=0;--gu){var gz=gr.changes[gu];gz.origin=gy;if(gs&&!dR(gA,gz,false)){gp.length=0;return}gw.push(du(gA,gz));var gq=gu?fp(gA,gz):fL(gp);eg(gA,gz,gq,ea(gA,gz));if(!gu&&gA.cm){gA.cm.scrollIntoView({from:gz.from,to:cW(gz)})}var gv=[];d8(gA,function(gE,gD){if(!gD&&dh(gv,gE.history)==-1){dE(gE.history,gz);gv.push(gE.history)}eg(gE,gz,null,ea(gE,gz))})}}function fs(gq,gs){if(gs==0){return}gq.first+=gs;gq.sel=new f9(bR(gq.sel.ranges,function(gt){return new dY(W(gt.anchor.line+gs,gt.anchor.ch),W(gt.head.line+gs,gt.head.ch))}),gq.sel.primIndex);if(gq.cm){ah(gq.cm,gq.first,gq.first-gs,gs);for(var gr=gq.cm.display,gp=gr.viewFrom;gp<gr.viewTo;gp++){R(gq.cm,gp,"gutter")}}}function eg(gt,gu,gs,gq){if(gt.cm&&!gt.cm.curOp){return c1(gt.cm,eg)(gt,gu,gs,gq)}if(gu.to.line<gt.first){fs(gt,gu.text.length-1-(gu.to.line-gu.from.line));return}if(gu.from.line>gt.lastLine()){return}if(gu.from.line<gt.first){var gp=gu.text.length-1-(gt.first-gu.from.line);fs(gt,gp);gu={from:W(gt.first,0),to:W(gu.to.line+gp,gu.to.ch),text:[fL(gu.text)],origin:gu.origin}}var gr=gt.lastLine();if(gu.to.line>gr){gu={from:gu.from,to:W(gr,fk(gt,gr).text.length),text:[gu.text[0]],origin:gu.origin}}gu.removed=ga(gt,gu.from,gu.to);if(!gs){gs=fp(gt,gu)}if(gt.cm){aI(gt.cm,gu,gq)}else{fD(gt,gu,gq)}es(gt,gs,Z)}function aI(gA,gw,gu){var gz=gA.doc,gv=gA.display,gx=gw.from,gy=gw.to;var gp=false,gt=gx.line;if(!gA.options.lineWrapping){gt=bM(x(fk(gz,gx.line)));gz.iter(gt,gy.line+1,function(gC){if(gC==gv.maxLine){gp=true;return true}})}if(gz.sel.contains(gw.from,gw.to)>-1){V(gA)}fD(gz,gw,gu,bd(gA));if(!gA.options.lineWrapping){gz.iter(gt,gx.line+gw.text.length,function(gD){var gC=eq(gD);if(gC>gv.maxLineLength){gv.maxLine=gD;gv.maxLineLength=gC;gv.maxLineChanged=true;gp=false}});if(gp){gA.curOp.updateMaxLine=true}}gz.frontier=Math.min(gz.frontier,gx.line);eh(gA,400);var gB=gw.text.length-(gy.line-gx.line)-1;if(gw.full){ah(gA)}else{if(gx.line==gy.line&&gw.text.length==1&&!dS(gA.doc,gw)){R(gA,gx.line,"text")}else{ah(gA,gx.line,gy.line+1,gB)}}var gr=fn(gA,"changes"),gs=fn(gA,"change");if(gs||gr){var gq={from:gx,to:gy,text:gw.text,removed:gw.removed,origin:gw.origin};if(gs){ae(gA,"change",gA,gq)}if(gr){(gA.curOp.changeObjs||(gA.curOp.changeObjs=[])).push(gq)}}gA.display.selForContextMenu=null}function a0(gs,gr,gu,gt,gp){if(!gt){gt=gu}if(ce(gt,gu)<0){var gq=gt;gt=gu;gu=gq}if(typeof gr=="string"){gr=gs.splitLines(gr)}bf(gs,{from:gu,to:gt,text:gr,origin:gp})}function d7(gq,gt){if(aQ(gq,"scrollCursorIntoView")){return}var gu=gq.display,gr=gu.sizer.getBoundingClientRect(),gp=null;if(gt.top+gr.top<0){gp=true}else{if(gt.bottom+gr.top>(window.innerHeight||document.documentElement.clientHeight)){gp=false}}if(gp!=null&&!fz){var gs=f8("div","\u200b",null,"position: absolute; top: "+(gt.top-gu.viewOffset-fd(gq.display))+"px; height: "+(gt.bottom-gt.top+cS(gq)+gu.barHeight)+"px; left: "+gt.left+"px; width: 2px;");gq.display.lineSpace.appendChild(gs);gs.scrollIntoView(gp);gq.display.lineSpace.removeChild(gs)}}function D(gz,gx,gt,gs){if(gs==null){gs=0}for(var gu=0;gu<5;gu++){var gv=false,gy=dU(gz,gx);var gp=!gt||gt==gx?gy:dU(gz,gt);var gr=G(gz,Math.min(gy.left,gp.left),Math.min(gy.top,gp.top)-gs,Math.max(gy.left,gp.left),Math.max(gy.bottom,gp.bottom)+gs);var gw=gz.doc.scrollTop,gq=gz.doc.scrollLeft;if(gr.scrollTop!=null){N(gz,gr.scrollTop);if(Math.abs(gz.doc.scrollTop-gw)>1){gv=true}}if(gr.scrollLeft!=null){bD(gz,gr.scrollLeft);if(Math.abs(gz.doc.scrollLeft-gq)>1){gv=true}}if(!gv){break}}return gy}function E(gp,gr,gt,gq,gs){var gu=G(gp,gr,gt,gq,gs);if(gu.scrollTop!=null){N(gp,gu.scrollTop)}if(gu.scrollLeft!=null){bD(gp,gu.scrollLeft)}}function G(gB,gs,gA,gq,gz){var gx=gB.display,gv=aX(gB.display);if(gA<0){gA=0}var gt=gB.curOp&&gB.curOp.scrollTop!=null?gB.curOp.scrollTop:gx.scroller.scrollTop;var gD=cU(gB),gF={};if(gz-gA>gD){gz=gA+gD}var gr=gB.doc.height+bH(gx);var gp=gA<gv,gw=gz>gr-gv;if(gA<gt){gF.scrollTop=gp?0:gA}else{if(gz>gt+gD){var gy=Math.min(gA,(gw?gr:gz)-gD);if(gy!=gt){gF.scrollTop=gy}}}var gE=gB.curOp&&gB.curOp.scrollLeft!=null?gB.curOp.scrollLeft:gx.scroller.scrollLeft;var gC=dl(gB)-(gB.options.fixedGutter?gx.gutters.offsetWidth:0);var gu=gq-gs>gC;if(gu){gq=gs+gC}if(gs<10){gF.scrollLeft=0}else{if(gs<gE){gF.scrollLeft=Math.max(0,gs-(gu?0:10))}else{if(gq>gC+gE-3){gF.scrollLeft=gq+(gu?0:10)-gC}}}return gF}function cK(gp,gr,gq){if(gr!=null||gq!=null){fH(gp)}if(gr!=null){gp.curOp.scrollLeft=(gp.curOp.scrollLeft==null?gp.doc.scrollLeft:gp.curOp.scrollLeft)+gr}if(gq!=null){gp.curOp.scrollTop=(gp.curOp.scrollTop==null?gp.doc.scrollTop:gp.curOp.scrollTop)+gq}}function fK(gp){fH(gp);var gq=gp.getCursor(),gs=gq,gr=gq;if(!gp.options.lineWrapping){gs=gq.ch?W(gq.line,gq.ch-1):gq;gr=W(gq.line,gq.ch+1)}gp.curOp.scrollToPos={from:gs,to:gr,margin:gp.options.cursorScrollMargin,isCursor:true}}function fH(gp){var gr=gp.curOp.scrollToPos;if(gr){gp.curOp.scrollToPos=null;var gt=dH(gp,gr.from),gs=dH(gp,gr.to);var gq=G(gp,Math.min(gt.left,gs.left),Math.min(gt.top,gs.top)-gr.margin,Math.max(gt.right,gs.right),Math.max(gt.bottom,gs.bottom)+gr.margin);gp.scrollTo(gq.scrollLeft,gq.scrollTop)}}function ad(gC,gs,gB,gr){var gA=gC.doc,gq;if(gB==null){gB="add"}if(gB=="smart"){if(!gA.mode.indent){gB="prev"}else{gq=dC(gC,gs)}}var gw=gC.options.tabSize;var gD=fk(gA,gs),gv=bS(gD.text,null,gw);if(gD.stateAfter){gD.stateAfter=null}var gp=gD.text.match(/^\s*/)[0],gy;if(!gr&&!/\S/.test(gD.text)){gy=0;gB="not"}else{if(gB=="smart"){gy=gA.mode.indent(gq,gD.text.slice(gp.length),gD.text);if(gy==b9||gy>150){if(!gr){return}gB="prev"}}}if(gB=="prev"){if(gs>gA.first){gy=bS(fk(gA,gs-1).text,null,gw)}else{gy=0}}else{if(gB=="add"){gy=gv+gC.options.indentUnit}else{if(gB=="subtract"){gy=gv-gC.options.indentUnit}else{if(typeof gB=="number"){gy=gv+gB}}}}gy=Math.max(0,gy);var gz="",gx=0;if(gC.options.indentWithTabs){for(var gt=Math.floor(gy/gw);gt;--gt){gx+=gw;gz+="\t"}}if(gx<gy){gz+=co(gy-gx)}if(gz!=gp){a0(gA,gz,W(gs,0),W(gs,gp.length),"+input");gD.stateAfter=null;return true}else{for(var gt=0;gt<gA.sel.ranges.length;gt++){var gu=gA.sel.ranges[gt];if(gu.head.line==gs&&gu.head.ch<gp.length){var gx=W(gs,gp.length);e(gA,gt,new dY(gx,gx));break}}}}function eC(gs,gr,gp,gu){var gt=gr,gq=gr;if(typeof gr=="number"){gq=fk(gs,c4(gs,gr))}else{gt=bM(gr)}if(gt==null){return null}if(gu(gq,gt)&&gs.cm){R(gs.cm,gt,gp)}return gq}function e1(gp,gv){var gq=gp.doc.sel.ranges,gt=[];for(var gs=0;gs<gq.length;gs++){var gr=gv(gq[gs]);while(gt.length&&ce(gr.from,fL(gt).to)<=0){var gu=gt.pop();if(ce(gu.from,gr.from)<0){gr.from=gu.from;break}}gt.push(gr)}cL(gp,function(){for(var gw=gt.length-1;gw>=0;gw--){a0(gp.doc,"",gt[gw].from,gt[gw].to,"+delete")}fK(gp)})}function bv(gH,gt,gB,gA,gv){var gy=gt.line,gz=gt.ch,gG=gB;var gq=fk(gH,gy);var gE=true;function gF(){var gI=gy+gB;if(gI<gH.first||gI>=gH.first+gH.size){return(gE=false)}gy=gI;return gq=fk(gH,gI)}function gD(gJ){var gI=(gv?u:ai)(gq,gz,gB,true);if(gI==null){if(!gJ&&gF()){if(gv){gz=(gB<0?cR:cD)(gq)}else{gz=gB<0?gq.text.length:0}}else{return(gE=false)}}else{gz=gI}return true}if(gA=="char"){gD()}else{if(gA=="column"){gD(true)}else{if(gA=="word"||gA=="group"){var gC=null,gw=gA=="group";var gp=gH.cm&&gH.cm.getHelper(gt,"wordChars");for(var gu=true;;gu=false){if(gB<0&&!gD(!gu)){break}var gr=gq.text.charAt(gz)||"\n";var gs=cz(gr,gp)?"w":gw&&gr=="\n"?"n":!gw||/\s/.test(gr)?null:"p";if(gw&&!gu&&!gs){gs="s"}if(gC&&gC!=gs){if(gB<0){gB=1;gD()}break}if(gs){gC=gs}if(gB>0&&!gD(!gu)){break}}}}}var gx=bU(gH,W(gy,gz),gt,gG,true);if(!gE){gx.hitSide=true}return gx}function bp(gx,gs,gp,gw){var gv=gx.doc,gu=gs.left,gt;if(gw=="page"){var gr=Math.min(gx.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);gt=gs.top+gp*(gr-(gp<0?1.5:0.5)*aX(gx.display))}else{if(gw=="line"){gt=gp>0?gs.bottom+3:gs.top-3}}for(;;){var gq=fT(gx,gu,gt);if(!gq.outside){break}if(gp<0?gt<=0:gt>=gv.height){gq.hitSide=true;break}gt+=gp*5}return gq}H.prototype={constructor:H,focus:function(){window.focus();this.display.input.focus()},setOption:function(gr,gs){var gq=this.options,gp=gq[gr];if(gq[gr]==gs&&gr!="mode"){return}gq[gr]=gs;if(be.hasOwnProperty(gr)){c1(this,be[gr])(this,gs,gp)}},getOption:function(gp){return this.options[gp]},getDoc:function(){return this.doc},addKeyMap:function(gq,gp){this.state.keyMaps[gp?"push":"unshift"](f3(gq))},removeKeyMap:function(gq){var gr=this.state.keyMaps;for(var gp=0;gp<gr.length;++gp){if(gr[gp]==gq||gr[gp].name==gq){gr.splice(gp,1);return true}}},addOverlay:c7(function(gp,gq){var gr=gp.token?gp:H.getMode(this.options,gp);if(gr.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:gr,modeSpec:gp,opaque:gq&&gq.opaque});this.state.modeGen++;ah(this)}),removeOverlay:c7(function(gp){var gr=this.state.overlays;for(var gq=0;gq<gr.length;++gq){var gs=gr[gq].modeSpec;if(gs==gp||typeof gp=="string"&&gs.name==gp){gr.splice(gq,1);this.state.modeGen++;ah(this);return}}}),indentLine:c7(function(gr,gp,gq){if(typeof gp!="string"&&typeof gp!="number"){if(gp==null){gp=this.options.smartIndent?"smart":"prev"}else{gp=gp?"add":"subtract"}}if(b8(this.doc,gr)){ad(this,gr,gp,gq)}}),indentSelection:c7(function(gy){var gp=this.doc.sel.ranges,gs=-1;for(var gu=0;gu<gp.length;gu++){var gv=gp[gu];if(!gv.empty()){var gw=gv.from(),gx=gv.to();var gq=Math.max(gs,gw.line);gs=Math.min(this.lastLine(),gx.line-(gx.ch?0:1))+1;for(var gt=gq;gt<gs;++gt){ad(this,gt,gy)}var gr=this.doc.sel.ranges;if(gw.ch==0&&gp.length==gr.length&&gr[gu].from().ch>0){e(this.doc,gu,new dY(gw,gr[gu].to()),Z)}}else{if(gv.head.line>gs){ad(this,gv.head.line,gy,true);gs=gv.head.line;if(gu==this.doc.sel.primIndex){fK(this)}}}}}),getTokenAt:function(gq,gp){return cp(this,gq,gp)},getLineTokens:function(gq,gp){return cp(this,W(gq),gp,true)},getTokenTypeAt:function(gw){gw=fO(this.doc,gw);var gs=c5(this,fk(this.doc,gw.line));var gu=0,gv=(gs.length-1)/2,gr=gw.ch;var gq;if(gr==0){gq=gs[2]}else{for(;;){var gp=(gu+gv)>>1;if((gp?gs[gp*2-1]:0)>=gr){gv=gp}else{if(gs[gp*2+1]<gr){gu=gp+1}else{gq=gs[gp*2+2];break}}}}var gt=gq?gq.indexOf("cm-overlay "):-1;return gt<0?gq:gt==0?null:gq.slice(0,gt-1)},getModeAt:function(gq){var gp=this.doc.mode;if(!gp.innerMode){return gp}return H.innerMode(gp,this.getTokenAt(gq).state).mode},getHelper:function(gq,gp){return this.getHelpers(gq,gp)[0]},getHelpers:function(gw,gr){var gs=[];if(!ft.hasOwnProperty(gr)){return gs}var gp=ft[gr],gv=this.getModeAt(gw);if(typeof gv[gr]=="string"){if(gp[gv[gr]]){gs.push(gp[gv[gr]])}}else{if(gv[gr]){for(var gq=0;gq<gv[gr].length;gq++){var gu=gp[gv[gr][gq]];if(gu){gs.push(gu)}}}else{if(gv.helperType&&gp[gv.helperType]){gs.push(gp[gv.helperType])}else{if(gp[gv.name]){gs.push(gp[gv.name])}}}}for(var gq=0;gq<gp._global.length;gq++){var gt=gp._global[gq];if(gt.pred(gv,this)&&dh(gs,gt.val)==-1){gs.push(gt.val)}}return gs},getStateAfter:function(gq,gp){var gr=this.doc;gq=c4(gr,gq==null?gr.first+gr.size-1:gq);return dC(this,gq+1,gp)},cursorCoords:function(gs,gq){var gr,gp=this.doc.sel.primary();if(gs==null){gr=gp.head}else{if(typeof gs=="object"){gr=fO(this.doc,gs)}else{gr=gs?gp.from():gp.to()}}return dU(this,gr,gq||"page")},charCoords:function(gq,gp){return cI(this,fO(this.doc,gq),gp||"page")},coordsChar:function(gp,gq){gp=gk(this,gp,gq||"page");return fT(this,gp.left,gp.top)},lineAtHeight:function(gp,gq){gp=gk(this,{top:gp,left:0},gq||"page").top;return bF(this.doc,gp+this.display.viewOffset)},heightAtLine:function(gq,gt){var gp=false,gr;if(typeof gq=="number"){var gs=this.doc.first+this.doc.size-1;if(gq<this.doc.first){gq=this.doc.first}else{if(gq>gs){gq=gs;gp=true}}gr=fk(this.doc,gq)}else{gr=gq}return eU(this,gr,{top:0,left:0},gt||"page").top+(gp?this.doc.height-bL(gr):0)},defaultTextHeight:function(){return aX(this.display)},defaultCharWidth:function(){return dD(this.display)},setGutterMarker:c7(function(gp,gq,gr){return eC(this.doc,gp,"gutter",function(gs){var gt=gs.gutterMarkers||(gs.gutterMarkers={});gt[gq]=gr;if(!gr&&eY(gt)){gs.gutterMarkers=null}return true})}),clearGutter:c7(function(gr){var gp=this,gs=gp.doc,gq=gs.first;gs.iter(function(gt){if(gt.gutterMarkers&&gt.gutterMarkers[gr]){gt.gutterMarkers[gr]=null;R(gp,gq,"gutter");if(eY(gt.gutterMarkers)){gt.gutterMarkers=null}}++gq})}),lineInfo:function(gp){if(typeof gp=="number"){if(!b8(this.doc,gp)){return null}var gq=gp;gp=fk(this.doc,gp);if(!gp){return null}}else{var gq=bM(gp);if(gq==null){return null}}return{line:gq,handle:gp,text:gp.text,gutterMarkers:gp.gutterMarkers,textClass:gp.textClass,bgClass:gp.bgClass,wrapClass:gp.wrapClass,widgets:gp.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(gu,gr,gw,gs,gy){var gt=this.display;gu=dU(this,fO(this.doc,gu));var gv=gu.bottom,gq=gu.left;gr.style.position="absolute";gr.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(gr);gt.sizer.appendChild(gr);if(gs=="over"){gv=gu.top}else{if(gs=="above"||gs=="near"){var gp=Math.max(gt.wrapper.clientHeight,this.doc.height),gx=Math.max(gt.sizer.clientWidth,gt.lineSpace.clientWidth);if((gs=="above"||gu.bottom+gr.offsetHeight>gp)&&gu.top>gr.offsetHeight){gv=gu.top-gr.offsetHeight}else{if(gu.bottom+gr.offsetHeight<=gp){gv=gu.bottom}}if(gq+gr.offsetWidth>gx){gq=gx-gr.offsetWidth}}}gr.style.top=gv+"px";gr.style.left=gr.style.right="";if(gy=="right"){gq=gt.sizer.clientWidth-gr.offsetWidth;gr.style.right="0px"}else{if(gy=="left"){gq=0}else{if(gy=="middle"){gq=(gt.sizer.clientWidth-gr.offsetWidth)/2}}gr.style.left=gq+"px"}if(gw){E(this,gq,gv,gq+gr.offsetWidth,gv+gr.offsetHeight)}},triggerOnKeyDown:c7(p),triggerOnKeyPress:c7(cw),triggerOnKeyUp:bh,execCommand:function(gp){if(eG.hasOwnProperty(gp)){return eG[gp].call(null,this)}},triggerElectric:c7(function(gp){f1(this,gp)}),findPosH:function(gv,gs,gt,gq){var gp=1;if(gs<0){gp=-1;gs=-gs}for(var gr=0,gu=fO(this.doc,gv);gr<gs;++gr){gu=bv(this.doc,gu,gp,gt,gq);if(gu.hitSide){break}}return gu},moveH:c7(function(gq,gr){var gp=this;gp.extendSelectionsBy(function(gs){if(gp.display.shift||gp.doc.extend||gs.empty()){return bv(gp.doc,gs.head,gq,gr,gp.options.rtlMoveVisually)}else{return gq<0?gs.from():gs.to()}},cV)}),deleteH:c7(function(gp,gq){var gr=this.doc.sel,gs=this.doc;if(gr.somethingSelected()){gs.replaceSelection("",null,"+delete")}else{e1(this,function(gu){var gt=bv(gs,gu.head,gp,gq,false);return gp<0?{from:gt,to:gu.head}:{from:gu.head,to:gt}})}}),findPosV:function(gu,gr,gv,gx){var gp=1,gt=gx;if(gr<0){gp=-1;gr=-gr}for(var gq=0,gw=fO(this.doc,gu);gq<gr;++gq){var gs=dU(this,gw,"div");if(gt==null){gt=gs.left}else{gs.left=gt}gw=bp(this,gs,gp,gv);if(gw.hitSide){break}}return gw},moveV:c7(function(gq,gs){var gp=this,gu=this.doc,gt=[];var gv=!gp.display.shift&&!gu.extend&&gu.sel.somethingSelected();gu.extendSelectionsBy(function(gw){if(gv){return gq<0?gw.from():gw.to()}var gy=dU(gp,gw.head,"div");if(gw.goalColumn!=null){gy.left=gw.goalColumn}gt.push(gy.left);var gx=bp(gp,gy,gq,gs);if(gs=="page"&&gw==gu.sel.primary()){cK(gp,null,cI(gp,gx,"div").top-gy.top)}return gx},cV);if(gt.length){for(var gr=0;gr<gu.sel.ranges.length;gr++){gu.sel.ranges[gr].goalColumn=gt[gr]}}}),findWordAt:function(gw){var gu=this.doc,gs=fk(gu,gw.line).text;var gv=gw.ch,gr=gw.ch;if(gs){var gt=this.getHelper(gw,"wordChars");if((gw.xRel<0||gr==gs.length)&&gv){--gv}else{++gr}var gq=gs.charAt(gv);var gp=cz(gq,gt)?function(gx){return cz(gx,gt)}:/\s/.test(gq)?function(gx){return/\s/.test(gx)}:function(gx){return !/\s/.test(gx)&&!cz(gx)};while(gv>0&&gp(gs.charAt(gv-1))){--gv}while(gr<gs.length&&gp(gs.charAt(gr))){++gr}}return new dY(W(gw.line,gv),W(gw.line,gr))},toggleOverwrite:function(gp){if(gp!=null&&gp==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){fF(this.display.cursorDiv,"CodeMirror-overwrite")}else{f(this.display.cursorDiv,"CodeMirror-overwrite")}aD(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==dO()},isReadOnly:function(){return !!(this.options.readOnly||this.doc.cantEdit)},scrollTo:c7(function(gp,gq){if(gp!=null||gq!=null){fH(this)}if(gp!=null){this.curOp.scrollLeft=gp}if(gq!=null){this.curOp.scrollTop=gq}}),getScrollInfo:function(){var gp=this.display.scroller;return{left:gp.scrollLeft,top:gp.scrollTop,height:gp.scrollHeight-cS(this)-this.display.barHeight,width:gp.scrollWidth-cS(this)-this.display.barWidth,clientHeight:cU(this),clientWidth:dl(this)}},scrollIntoView:c7(function(gq,gr){if(gq==null){gq={from:this.doc.sel.primary().head,to:null};if(gr==null){gr=this.options.cursorScrollMargin}}else{if(typeof gq=="number"){gq={from:W(gq,0),to:null}}else{if(gq.from==null){gq={from:gq,to:null}}}}if(!gq.to){gq.to=gq.from}gq.margin=gr||0;if(gq.from.line!=null){fH(this);this.curOp.scrollToPos=gq}else{var gp=G(this,Math.min(gq.from.left,gq.to.left),Math.min(gq.from.top,gq.to.top)-gq.margin,Math.max(gq.from.right,gq.to.right),Math.max(gq.from.bottom,gq.to.bottom)+gq.margin);this.scrollTo(gp.scrollLeft,gp.scrollTop)}}),setSize:c7(function(gs,gq){var gp=this;function gr(gu){return typeof gu=="number"||/^\d+$/.test(String(gu))?gu+"px":gu}if(gs!=null){gp.display.wrapper.style.width=gr(gs)}if(gq!=null){gp.display.wrapper.style.height=gr(gq)}if(gp.options.lineWrapping){aN(this)}var gt=gp.display.viewFrom;gp.doc.iter(gt,gp.display.viewTo,function(gu){if(gu.widgets){for(var gv=0;gv<gu.widgets.length;gv++){if(gu.widgets[gv].noHScroll){R(gp,gt,"widget");break}}}++gt});gp.curOp.forceUpdate=true;aD(gp,"refresh",this)}),operation:function(gp){return cL(this,gp)},refresh:c7(function(){var gp=this.display.cachedTextHeight;ah(this);this.curOp.forceUpdate=true;aj(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);c3(this);if(gp==null||Math.abs(gp-aX(this.display))>0.5){X(this)}aD(this,"refresh",this)}),swapDoc:c7(function(gq){var gp=this.doc;gp.cm=null;ed(this,gq);aj(this);this.display.input.reset();this.scrollTo(gq.scrollLeft,gq.scrollTop);this.curOp.forceScroll=true;ae(this,"swapDoc",this,gp);return gp}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bx(H);var e7=H.defaults={};var be=H.optionHandlers={};function s(gp,gs,gr,gq){H.defaults[gp]=gs;if(gr){be[gp]=gq?function(gt,gv,gu){if(gu!=cb){gr(gt,gv,gu)}}:gr}}var cb=H.Init={toString:function(){return"CodeMirror.Init"}};s("value","",function(gp,gq){gp.setValue(gq)},true);s("mode",null,function(gp,gq){gp.doc.modeOption=gq;bq(gp)},true);s("indentUnit",2,bq,true);s("indentWithTabs",false);s("smartIndent",true);s("tabSize",4,function(gp){eo(gp);aj(gp);ah(gp)},true);s("lineSeparator",null,function(gp,gs){gp.doc.lineSep=gs;if(!gs){return}var gr=[],gt=gp.doc.first;gp.doc.iter(function(gu){for(var gw=0;;){var gv=gu.text.indexOf(gs,gw);if(gv==-1){break}gw=gv+gs.length;gr.push(W(gt,gv))}gt++});for(var gq=gr.length-1;gq>=0;gq--){a0(gp.doc,gs,gr[gq],W(gr[gq].line,gr[gq].ch+gs.length))}});s("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(gp,gr,gq){gp.state.specialChars=new RegExp(gr.source+(gr.test("\t")?"":"|\t"),"g");if(gq!=H.Init){gp.refresh()}});s("specialCharPlaceholder",fh,function(gp){gp.refresh()},true);s("electricChars",true);s("inputStyle",ei?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);s("rtlMoveVisually",!aO);s("wholeLineUpdateBefore",true);s("theme","default",function(gp){cN(gp);dw(gp)},true);s("keyMap","default",function(gp,gt,gq){var gr=f3(gt);var gs=gq!=H.Init&&f3(gq);if(gs&&gs.detach){gs.detach(gp,gr)}if(gr.attach){gr.attach(gp,gs||null)}});s("extraKeys",null);s("lineWrapping",false,eJ,true);s("gutters",[],function(gp){cd(gp.options);dw(gp)},true);s("fixedGutter",true,function(gp,gq){gp.display.gutters.style.left=gq?dX(gp.display)+"px":"0";gp.refresh()},true);s("coverGutterNextToScrollbar",false,function(gp){e2(gp)},true);s("scrollbarStyle","native",function(gp){aC(gp);e2(gp);gp.display.scrollbars.setScrollTop(gp.doc.scrollTop);gp.display.scrollbars.setScrollLeft(gp.doc.scrollLeft)},true);s("lineNumbers",false,function(gp){cd(gp.options);dw(gp)},true);s("firstLineNumber",1,dw,true);s("lineNumberFormatter",function(gp){return gp},dw,true);s("showCursorWhenSelecting",false,bB,true);s("resetSelectionOnContextMenu",true);s("lineWiseCopyCut",true);s("readOnly",false,function(gp,gq){if(gq=="nocursor"){aU(gp);gp.display.input.blur();gp.display.disabled=true}else{gp.display.disabled=false}gp.display.input.readOnlyChanged(gq)});s("disableInput",false,function(gp,gq){if(!gq){gp.display.input.reset()}},true);s("dragDrop",true,f6);s("allowDropFileTypes",null);s("cursorBlinkRate",530);s("cursorScrollMargin",0);s("cursorHeight",1,bB,true);s("singleCursorHeightPerLine",true,bB,true);s("workTime",100);s("workDelay",100);s("flattenSpans",true,eo,true);s("addModeClass",false,eo,true);s("pollInterval",100);s("undoDepth",200,function(gp,gq){gp.doc.history.undoDepth=gq});s("historyEventDelay",1250);s("viewportMargin",10,function(gp){gp.refresh()},true);s("maxHighlightLength",10000,eo,true);s("moveInputWithCursor",true,function(gp,gq){if(!gq){gp.display.input.resetPosition()}});s("tabindex",null,function(gp,gq){gp.display.input.getField().tabIndex=gq||""});s("autofocus",null);var ds=H.modes={},aR=H.mimeModes={};H.defineMode=function(gp,gq){if(!H.defaults.mode&&gp!="null"){H.defaults.mode=gp}if(arguments.length>2){gq.dependencies=Array.prototype.slice.call(arguments,2)}ds[gp]=gq};H.defineMIME=function(gq,gp){aR[gq]=gp};H.resolveMode=function(gp){if(typeof gp=="string"&&aR.hasOwnProperty(gp)){gp=aR[gp]}else{if(gp&&typeof gp.name=="string"&&aR.hasOwnProperty(gp.name)){var gq=aR[gp.name];if(typeof gq=="string"){gq={name:gq}}gp=cj(gq,gp);gp.name=gq.name}else{if(typeof gp=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(gp)){return H.resolveMode("application/xml")}}}if(typeof gp=="string"){return{name:gp}}else{return gp||{name:"null"}}};H.getMode=function(gq,gp){var gp=H.resolveMode(gp);var gs=ds[gp.name];if(!gs){return H.getMode(gq,"text/plain")}var gt=gs(gq,gp);if(dp.hasOwnProperty(gp.name)){var gr=dp[gp.name];for(var gu in gr){if(!gr.hasOwnProperty(gu)){continue}if(gt.hasOwnProperty(gu)){gt["_"+gu]=gt[gu]}gt[gu]=gr[gu]}}gt.name=gp.name;if(gp.helperType){gt.helperType=gp.helperType}if(gp.modeProps){for(var gu in gp.modeProps){gt[gu]=gp.modeProps[gu]}}return gt};H.defineMode("null",function(){return{token:function(gp){gp.skipToEnd()}}});H.defineMIME("text/plain","null");var dp=H.modeExtensions={};H.extendMode=function(gr,gq){var gp=dp.hasOwnProperty(gr)?dp[gr]:(dp[gr]={});aM(gq,gp)};H.defineExtension=function(gp,gq){H.prototype[gp]=gq};H.defineDocExtension=function(gp,gq){ar.prototype[gp]=gq};H.defineOption=s;var a7=[];H.defineInitHook=function(gp){a7.push(gp)};var ft=H.helpers={};H.registerHelper=function(gq,gp,gr){if(!ft.hasOwnProperty(gq)){ft[gq]=H[gq]={_global:[]}}ft[gq][gp]=gr};H.registerGlobalHelper=function(gr,gq,gp,gs){H.registerHelper(gr,gq,gs);ft[gr]._global.push({pred:gp,val:gs})};var b2=H.copyState=function(gs,gp){if(gp===true){return gp}if(gs.copyState){return gs.copyState(gp)}var gr={};for(var gt in gp){var gq=gp[gt];if(gq instanceof Array){gq=gq.concat([])}gr[gt]=gq}return gr};var bZ=H.startState=function(gr,gq,gp){return gr.startState?gr.startState(gq,gp):true};H.innerMode=function(gr,gp){while(gr.innerMode){var gq=gr.innerMode(gp);if(!gq||gq.mode==gr){break}gp=gq.state;gr=gq.mode}return gq||{mode:gr,state:gp}};var eG=H.commands={selectAll:function(gp){gp.setSelection(W(gp.firstLine(),0),W(gp.lastLine()),Z)},singleSelection:function(gp){gp.setSelection(gp.getCursor("anchor"),gp.getCursor("head"),Z)},killLine:function(gp){e1(gp,function(gr){if(gr.empty()){var gq=fk(gp.doc,gr.head.line).text.length;if(gr.head.ch==gq&&gr.head.line<gp.lastLine()){return{from:gr.head,to:W(gr.head.line+1,0)}}else{return{from:gr.head,to:W(gr.head.line,gq)}}}else{return{from:gr.from(),to:gr.to()}}})},deleteLine:function(gp){e1(gp,function(gq){return{from:W(gq.from().line,0),to:fO(gp.doc,W(gq.to().line+1,0))}})},delLineLeft:function(gp){e1(gp,function(gq){return{from:W(gq.from().line,0),to:gq.from()}})},delWrappedLineLeft:function(gp){e1(gp,function(gq){var gs=gp.charCoords(gq.head,"div").top+5;var gr=gp.coordsChar({left:0,top:gs},"div");return{from:gr,to:gq.from()}})},delWrappedLineRight:function(gp){e1(gp,function(gq){var gs=gp.charCoords(gq.head,"div").top+5;var gr=gp.coordsChar({left:gp.display.lineDiv.offsetWidth+100,top:gs},"div");return{from:gq.from(),to:gr}})},undo:function(gp){gp.undo()},redo:function(gp){gp.redo()},undoSelection:function(gp){gp.undoSelection()},redoSelection:function(gp){gp.redoSelection()},goDocStart:function(gp){gp.extendSelection(W(gp.firstLine(),0))},goDocEnd:function(gp){gp.extendSelection(W(gp.lastLine()))},goLineStart:function(gp){gp.extendSelectionsBy(function(gq){return bs(gp,gq.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(gp){gp.extendSelectionsBy(function(gq){return dI(gp,gq.head)},{origin:"+move",bias:1})},goLineEnd:function(gp){gp.extendSelectionsBy(function(gq){return dP(gp,gq.head.line)},{origin:"+move",bias:-1})},goLineRight:function(gp){gp.extendSelectionsBy(function(gq){var gr=gp.charCoords(gq.head,"div").top+5;return gp.coordsChar({left:gp.display.lineDiv.offsetWidth+100,top:gr},"div")},cV)},goLineLeft:function(gp){gp.extendSelectionsBy(function(gq){var gr=gp.charCoords(gq.head,"div").top+5;return gp.coordsChar({left:0,top:gr},"div")},cV)},goLineLeftSmart:function(gp){gp.extendSelectionsBy(function(gq){var gr=gp.charCoords(gq.head,"div").top+5;var gs=gp.coordsChar({left:0,top:gr},"div");if(gs.ch<gp.getLine(gs.line).search(/\S/)){return dI(gp,gq.head)}return gs},cV)},goLineUp:function(gp){gp.moveV(-1,"line")},goLineDown:function(gp){gp.moveV(1,"line")},goPageUp:function(gp){gp.moveV(-1,"page")},goPageDown:function(gp){gp.moveV(1,"page")},goCharLeft:function(gp){gp.moveH(-1,"char")},goCharRight:function(gp){gp.moveH(1,"char")},goColumnLeft:function(gp){gp.moveH(-1,"column")},goColumnRight:function(gp){gp.moveH(1,"column")},goWordLeft:function(gp){gp.moveH(-1,"word")},goGroupRight:function(gp){gp.moveH(1,"group")},goGroupLeft:function(gp){gp.moveH(-1,"group")},goWordRight:function(gp){gp.moveH(1,"word")},delCharBefore:function(gp){gp.deleteH(-1,"char")},delCharAfter:function(gp){gp.deleteH(1,"char")},delWordBefore:function(gp){gp.deleteH(-1,"word")},delWordAfter:function(gp){gp.deleteH(1,"word")},delGroupBefore:function(gp){gp.deleteH(-1,"group")},delGroupAfter:function(gp){gp.deleteH(1,"group")},indentAuto:function(gp){gp.indentSelection("smart")},indentMore:function(gp){gp.indentSelection("add")},indentLess:function(gp){gp.indentSelection("subtract")},insertTab:function(gp){gp.replaceSelection("\t")},insertSoftTab:function(gp){var gr=[],gq=gp.listSelections(),gu=gp.options.tabSize;for(var gt=0;gt<gq.length;gt++){var gv=gq[gt].from();var gs=bS(gp.getLine(gv.line),gv.ch,gu);gr.push(new Array(gu-gs%gu+1).join(" "))}gp.replaceSelections(gr)},defaultTab:function(gp){if(gp.somethingSelected()){gp.indentSelection("add")}else{gp.execCommand("insertTab")}},transposeChars:function(gp){cL(gp,function(){var gs=gp.listSelections(),gr=[];for(var gt=0;gt<gs.length;gt++){var gv=gs[gt].head,gq=fk(gp.doc,gv.line).text;if(gq){if(gv.ch==gq.length){gv=new W(gv.line,gv.ch-1)}if(gv.ch>0){gv=new W(gv.line,gv.ch+1);gp.replaceRange(gq.charAt(gv.ch-1)+gq.charAt(gv.ch-2),W(gv.line,gv.ch-2),gv,"+transpose")}else{if(gv.line>gp.doc.first){var gu=fk(gp.doc,gv.line-1).text;if(gu){gp.replaceRange(gq.charAt(0)+gp.doc.lineSeparator()+gu.charAt(gu.length-1),W(gv.line-1,gu.length-1),W(gv.line,1),"+transpose")}}}}gr.push(new dY(gv,gv))}gp.setSelections(gr)})},newlineAndIndent:function(gp){cL(gp,function(){var gq=gp.listSelections().length;for(var gs=0;gs<gq;gs++){var gr=gp.listSelections()[gs];gp.replaceRange(gp.doc.lineSeparator(),gr.anchor,gr.head,"+input");gp.indentLine(gr.from().line+1,null,true)}fK(gp)})},toggleOverwrite:function(gp){gp.toggleOverwrite()}};var ff=H.keyMap={};ff.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};ff.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};ff.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};ff.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};ff["default"]=b6?ff.macDefault:ff.pcDefault;function dt(gq){var gw=gq.split(/-(?!$)/),gq=gw[gw.length-1];var gv,gu,gp,gt;for(var gs=0;gs<gw.length-1;gs++){var gr=gw[gs];if(/^(cmd|meta|m)$/i.test(gr)){gt=true}else{if(/^a(lt)?$/i.test(gr)){gv=true}else{if(/^(c|ctrl|control)$/i.test(gr)){gu=true}else{if(/^s(hift)$/i.test(gr)){gp=true}else{throw new Error("Unrecognized modifier name: "+gr)}}}}}if(gv){gq="Alt-"+gq}if(gu){gq="Ctrl-"+gq}if(gt){gq="Cmd-"+gq}if(gp){gq="Shift-"+gq}return gq}H.normalizeKeyMap=function(gw){var gq={};for(var gv in gw){if(gw.hasOwnProperty(gv)){var gx=gw[gv];if(/^(name|fallthrough|(de|at)tach)$/.test(gv)){continue}if(gx=="..."){delete gw[gv];continue}var gy=bR(gv.split(" "),dt);for(var gu=0;gu<gy.length;gu++){var gs,gr;if(gu==gy.length-1){gr=gy.join(" ");gs=gx}else{gr=gy.slice(0,gu+1).join(" ");gs="..."}var gt=gq[gr];if(!gt){gq[gr]=gs}else{if(gt!=gs){throw new Error("Inconsistent bindings for "+gr)}}}delete gw[gv]}}for(var gp in gq){gw[gp]=gq[gp]}return gw};var i=H.lookupKey=function(gs,gv,gu,gr){gv=f3(gv);var gt=gv.call?gv.call(gs,gr):gv[gs];if(gt===false){return"nothing"}if(gt==="..."){return"multi"}if(gt!=null&&gu(gt)){return"handled"}if(gv.fallthrough){if(Object.prototype.toString.call(gv.fallthrough)!="[object Array]"){return i(gs,gv.fallthrough,gu,gr)}for(var gq=0;gq<gv.fallthrough.length;gq++){var gp=i(gs,gv.fallthrough[gq],gu,gr);if(gp){return gp}}}};var eF=H.isModifierKey=function(gq){var gp=typeof gq=="string"?gq:fl[gq.keyCode];return gp=="Ctrl"||gp=="Alt"||gp=="Shift"||gp=="Mod"};var fw=H.keyName=function(gq,gs){if(d4&&gq.keyCode==34&&gq["char"]){return false}var gr=fl[gq.keyCode],gp=gr;if(gp==null||gq.altGraphKey){return false}if(gq.altKey&&gr!="Alt"){gp="Alt-"+gp}if((bP?gq.metaKey:gq.ctrlKey)&&gr!="Ctrl"){gp="Ctrl-"+gp}if((bP?gq.ctrlKey:gq.metaKey)&&gr!="Cmd"){gp="Cmd-"+gp}if(!gs&&gq.shiftKey&&gr!="Shift"){gp="Shift-"+gp}return gp};function f3(gp){return typeof gp=="string"?ff[gp]:gp}H.fromTextArea=function(gw,gx){gx=gx?aM(gx):{};gx.value=gw.value;if(!gx.tabindex&&gw.tabIndex){gx.tabindex=gw.tabIndex}if(!gx.placeholder&&gw.placeholder){gx.placeholder=gw.placeholder}if(gx.autofocus==null){var gp=dO();gx.autofocus=gp==gw||gw.getAttribute("autofocus")!=null&&gp==document.body}function gt(){gw.value=gv.getValue()}if(gw.form){bW(gw.form,"submit",gt);if(!gx.leaveSubmitMethodAlone){var gq=gw.form,gu=gq.submit;try{var gs=gq.submit=function(){gt();gq.submit=gu;gq.submit();gq.submit=gs}}catch(gr){}}}gx.finishInit=function(gy){gy.save=gt;gy.getTextArea=function(){return gw};gy.toTextArea=function(){gy.toTextArea=isNaN;gt();gw.parentNode.removeChild(gy.getWrapperElement());gw.style.display="";if(gw.form){ef(gw.form,"submit",gt);if(typeof gw.form.submit=="function"){gw.form.submit=gu}}}};gw.style.display="none";var gv=H(function(gy){gw.parentNode.insertBefore(gy,gw.nextSibling)},gx);return gv};var eX=H.StringStream=function(gp,gq){this.pos=this.start=0;this.string=gp;this.tabSize=gq||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};eX.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(gp){var gr=this.string.charAt(this.pos);if(typeof gp=="string"){var gq=gr==gp}else{var gq=gr&&(gp.test?gp.test(gr):gp(gr))}if(gq){++this.pos;return gr}},eatWhile:function(gp){var gq=this.pos;while(this.eat(gp)){}return this.pos>gq},eatSpace:function(){var gp=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>gp},skipToEnd:function(){this.pos=this.string.length},skipTo:function(gp){var gq=this.string.indexOf(gp,this.pos);if(gq>-1){this.pos=gq;return true}},backUp:function(gp){this.pos-=gp},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bS(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?bS(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bS(this.string,null,this.tabSize)-(this.lineStart?bS(this.string,this.lineStart,this.tabSize):0)},match:function(gt,gq,gp){if(typeof gt=="string"){var gu=function(gv){return gp?gv.toLowerCase():gv};var gs=this.string.substr(this.pos,gt.length);if(gu(gs)==gu(gt)){if(gq!==false){this.pos+=gt.length}return true}}else{var gr=this.string.slice(this.pos).match(gt);if(gr&&gr.index>0){return null}if(gr&&gq!==false){this.pos+=gr[0].length}return gr}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(gq,gp){this.lineStart+=gq;try{return gp()}finally{this.lineStart-=gq}}};var a4=0;var P=H.TextMarker=function(gq,gp){this.lines=[];this.type=gp;this.doc=gq;this.id=++a4};bx(P);P.prototype.clear=function(){if(this.explicitlyCleared){return}var gw=this.doc.cm,gq=gw&&!gw.curOp;if(gq){cH(gw)}if(fn(this,"clear")){var gx=this.find();if(gx){ae(this,"clear",gx.from,gx.to)}}var gr=null,gu=null;for(var gs=0;gs<this.lines.length;++gs){var gy=this.lines[gs];var gv=fe(gy.markedSpans,this);if(gw&&!this.collapsed){R(gw,bM(gy),"text")}else{if(gw){if(gv.to!=null){gu=bM(gy)}if(gv.from!=null){gr=bM(gy)}}}gy.markedSpans=eK(gy.markedSpans,gv);if(gv.from==null&&this.collapsed&&!fB(this.doc,gy)&&gw){gb(gy,aX(gw.display))}}if(gw&&this.collapsed&&!gw.options.lineWrapping){for(var gs=0;gs<this.lines.length;++gs){var gp=x(this.lines[gs]),gt=eq(gp);if(gt>gw.display.maxLineLength){gw.display.maxLine=gp;gw.display.maxLineLength=gt;gw.display.maxLineChanged=true}}}if(gr!=null&&gw&&this.collapsed){ah(gw,gr,gu+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(gw){eB(gw.doc)}}if(gw){ae(gw,"markerCleared",gw,this)}if(gq){al(gw)}if(this.parent){this.parent.clear()}};P.prototype.find=function(gs,gq){if(gs==null&&this.type=="bookmark"){gs=1}var gv,gu;for(var gr=0;gr<this.lines.length;++gr){var gp=this.lines[gr];var gt=fe(gp.markedSpans,this);if(gt.from!=null){gv=W(gq?gp:bM(gp),gt.from);if(gs==-1){return gv}}if(gt.to!=null){gu=W(gq?gp:bM(gp),gt.to);if(gs==1){return gu}}}return gv&&{from:gv,to:gu}};P.prototype.changed=function(){var gr=this.find(-1,true),gq=this,gp=this.doc.cm;if(!gr||!gp){return}cL(gp,function(){var gt=gr.line,gu=bM(gr.line);var gs=fg(gp,gu);if(gs){at(gs);gp.curOp.selectionChanged=gp.curOp.forceUpdate=true}gp.curOp.updateMaxLine=true;if(!fB(gq.doc,gt)&&gq.height!=null){var gw=gq.height;gq.height=null;var gv=cX(gq)-gw;if(gv){gb(gt,gt.height+gv)}}})};P.prototype.attachLine=function(gp){if(!this.lines.length&&this.doc.cm){var gq=this.doc.cm.curOp;if(!gq.maybeHiddenMarkers||dh(gq.maybeHiddenMarkers,this)==-1){(gq.maybeUnhiddenMarkers||(gq.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(gp)};P.prototype.detachLine=function(gp){this.lines.splice(dh(this.lines,gp),1);if(!this.lines.length&&this.doc.cm){var gq=this.doc.cm.curOp;(gq.maybeHiddenMarkers||(gq.maybeHiddenMarkers=[])).push(this)}};var a4=0;function eI(gx,gv,gw,gz,gt){if(gz&&gz.shared){return O(gx,gv,gw,gz,gt)}if(gx.cm&&!gx.cm.curOp){return c1(gx.cm,eI)(gx,gv,gw,gz,gt)}var gs=new P(gx,gt),gy=ce(gv,gw);if(gz){aM(gz,gs,false)}if(gy>0||gy==0&&gs.clearWhenEmpty!==false){return gs}if(gs.replacedWith){gs.collapsed=true;gs.widgetNode=f8("span",[gs.replacedWith],"CodeMirror-widget");if(!gz.handleMouseEvents){gs.widgetNode.setAttribute("cm-ignore-events","true")}if(gz.insertLeft){gs.widgetNode.insertLeft=true}}if(gs.collapsed){if(z(gx,gv.line,gv,gw,gs)||gv.line!=gw.line&&z(gx,gw.line,gv,gw,gs)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}a6=true}if(gs.addToHistory){fR(gx,{from:gv,to:gw,origin:"markText"},gx.sel,NaN)}var gq=gv.line,gu=gx.cm,gp;gx.iter(gq,gw.line+1,function(gA){if(gu&&gs.collapsed&&!gu.options.lineWrapping&&x(gA)==gu.display.maxLine){gp=true}if(gs.collapsed&&gq!=gv.line){gb(gA,0)}cc(gA,new ek(gs,gq==gv.line?gv.ch:null,gq==gw.line?gw.ch:null));++gq});if(gs.collapsed){gx.iter(gv.line,gw.line+1,function(gA){if(fB(gx,gA)){gb(gA,0)}})}if(gs.clearOnEnter){bW(gs,"beforeCursorEnter",function(){gs.clear()})}if(gs.readOnly){gi=true;if(gx.history.done.length||gx.history.undone.length){gx.clearHistory()}}if(gs.collapsed){gs.id=++a4;gs.atomic=true}if(gu){if(gp){gu.curOp.updateMaxLine=true}if(gs.collapsed){ah(gu,gv.line,gw.line+1)}else{if(gs.className||gs.title||gs.startStyle||gs.endStyle||gs.css){for(var gr=gv.line;gr<=gw.line;gr++){R(gu,gr,"text")}}}if(gs.atomic){eB(gu.doc)}ae(gu,"markerAdded",gu,gs)}return gs}var y=H.SharedTextMarker=function(gr,gq){this.markers=gr;this.primary=gq;for(var gp=0;gp<gr.length;++gp){gr[gp].parent=this}};bx(y);y.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var gp=0;gp<this.markers.length;++gp){this.markers[gp].clear()}ae(this,"clear")};y.prototype.find=function(gq,gp){return this.primary.find(gq,gp)};function O(gt,gw,gv,gp,gr){gp=aM(gp);gp.shared=false;var gu=[eI(gt,gw,gv,gp,gr)],gq=gu[0];var gs=gp.widgetNode;d8(gt,function(gy){if(gs){gp.widgetNode=gs.cloneNode(true)}gu.push(eI(gy,fO(gy,gw),fO(gy,gv),gp,gr));for(var gx=0;gx<gy.linked.length;++gx){if(gy.linked[gx].isParent){return}}gq=fL(gu)});return new y(gu,gq)}function eT(gp){return gp.findMarks(W(gp.first,0),gp.clipPos(W(gp.lastLine())),function(gq){return gq.parent})}function dF(gu,gv){for(var gs=0;gs<gv.length;gs++){var gq=gv[gs],gw=gq.find();var gp=gu.clipPos(gw.from),gt=gu.clipPos(gw.to);if(ce(gp,gt)){var gr=eI(gu,gp,gt,gq.primary,gq.primary.type);gq.markers.push(gr);gr.parent=gq}}}function er(gs){for(var gr=0;gr<gs.length;gr++){var gp=gs[gr],gu=[gp.primary.doc];d8(gp.primary.doc,function(gv){gu.push(gv)});for(var gq=0;gq<gp.markers.length;gq++){var gt=gp.markers[gq];if(dh(gu,gt.doc)==-1){gt.parent=null;gp.markers.splice(gq--,1)}}}}function ek(gp,gr,gq){this.marker=gp;this.from=gr;this.to=gq}function fe(gr,gp){if(gr){for(var gq=0;gq<gr.length;++gq){var gs=gr[gq];if(gs.marker==gp){return gs}}}}function eK(gq,gr){for(var gs,gp=0;gp<gq.length;++gp){if(gq[gp]!=gr){(gs||(gs=[])).push(gq[gp])}}return gs}function cc(gp,gq){gp.markedSpans=gp.markedSpans?gp.markedSpans.concat([gq]):[gq];gq.marker.attachLine(gp)}function aP(gq,gr,gv){if(gq){for(var gt=0,gw;gt<gq.length;++gt){var gx=gq[gt],gu=gx.marker;var gp=gx.from==null||(gu.inclusiveLeft?gx.from<=gr:gx.from<gr);if(gp||gx.from==gr&&gu.type=="bookmark"&&(!gv||!gx.marker.insertLeft)){var gs=gx.to==null||(gu.inclusiveRight?gx.to>=gr:gx.to>gr);(gw||(gw=[])).push(new ek(gu,gx.from,gs?null:gx.to))}}}return gw}function aA(gq,gs,gv){if(gq){for(var gt=0,gw;gt<gq.length;++gt){var gx=gq[gt],gu=gx.marker;var gr=gx.to==null||(gu.inclusiveRight?gx.to>=gs:gx.to>gs);if(gr||gx.from==gs&&gu.type=="bookmark"&&(!gv||gx.marker.insertLeft)){var gp=gx.from==null||(gu.inclusiveLeft?gx.from<=gs:gx.from<gs);(gw||(gw=[])).push(new ek(gu,gp?null:gx.from-gs,gx.to==null?null:gx.to-gs))}}}return gw}function em(gB,gy){if(gy.full){return null}var gx=b8(gB,gy.from.line)&&fk(gB,gy.from.line).markedSpans;var gE=b8(gB,gy.to.line)&&fk(gB,gy.to.line).markedSpans;if(!gx&&!gE){return null}var gq=gy.from.ch,gt=gy.to.ch,gw=ce(gy.from,gy.to)==0;var gv=aP(gx,gq,gw);var gD=aA(gE,gt,gw);var gC=gy.text.length==1,gr=fL(gy.text).length+(gC?gq:0);if(gv){for(var gs=0;gs<gv.length;++gs){var gA=gv[gs];if(gA.to==null){var gF=fe(gD,gA.marker);if(!gF){gA.to=gq}else{if(gC){gA.to=gF.to==null?null:gF.to+gr}}}}}if(gD){for(var gs=0;gs<gD.length;++gs){var gA=gD[gs];if(gA.to!=null){gA.to+=gr}if(gA.from==null){var gF=fe(gv,gA.marker);if(!gF){gA.from=gr;if(gC){(gv||(gv=[])).push(gA)}}}else{gA.from+=gr;if(gC){(gv||(gv=[])).push(gA)}}}}if(gv){gv=q(gv)}if(gD&&gD!=gv){gD=q(gD)}var gu=[gv];if(!gC){var gz=gy.text.length-2,gp;if(gz>0&&gv){for(var gs=0;gs<gv.length;++gs){if(gv[gs].to==null){(gp||(gp=[])).push(new ek(gv[gs].marker,null,null))}}}for(var gs=0;gs<gz;++gs){gu.push(gp)}gu.push(gD)}return gu}function q(gq){for(var gp=0;gp<gq.length;++gp){var gr=gq[gp];if(gr.from!=null&&gr.from==gr.to&&gr.marker.clearWhenEmpty!==false){gq.splice(gp--,1)}}if(!gq.length){return null}return gq}function ea(gx,gv){var gp=b3(gx,gv);var gy=em(gx,gv);if(!gp){return gy}if(!gy){return gp}for(var gs=0;gs<gp.length;++gs){var gt=gp[gs],gu=gy[gs];if(gt&&gu){spans:for(var gr=0;gr<gu.length;++gr){var gw=gu[gr];for(var gq=0;gq<gt.length;++gq){if(gt[gq].marker==gw.marker){continue spans}}gt.push(gw)}}else{if(gu){gp[gs]=gu}}}return gp}function cG(gB,gz,gA){var gt=null;gB.iter(gz.line,gA.line+1,function(gC){if(gC.markedSpans){for(var gD=0;gD<gC.markedSpans.length;++gD){var gE=gC.markedSpans[gD].marker;if(gE.readOnly&&(!gt||dh(gt,gE)==-1)){(gt||(gt=[])).push(gE)}}}});if(!gt){return null}var gu=[{from:gz,to:gA}];for(var gv=0;gv<gt.length;++gv){var gw=gt[gv],gr=gw.find(0);for(var gs=0;gs<gu.length;++gs){var gq=gu[gs];if(ce(gq.to,gr.from)<0||ce(gq.from,gr.to)>0){continue}var gy=[gs,1],gp=ce(gq.from,gr.from),gx=ce(gq.to,gr.to);if(gp<0||!gw.inclusiveLeft&&!gp){gy.push({from:gq.from,to:gr.from})}if(gx>0||!gw.inclusiveRight&&!gx){gy.push({from:gr.to,to:gq.to})}gu.splice.apply(gu,gy);gs+=gy.length-1}}return gu}function ge(gp){var gr=gp.markedSpans;if(!gr){return}for(var gq=0;gq<gr.length;++gq){gr[gq].marker.detachLine(gp)}gp.markedSpans=null}function c2(gp,gr){if(!gr){return}for(var gq=0;gq<gr.length;++gq){gr[gq].marker.attachLine(gp)}gp.markedSpans=gr}function v(gp){return gp.inclusiveLeft?-1:0}function bV(gp){return gp.inclusiveRight?1:0}function dQ(gs,gq){var gu=gs.lines.length-gq.lines.length;if(gu!=0){return gu}var gr=gs.find(),gv=gq.find();var gp=ce(gr.from,gv.from)||v(gs)-v(gq);if(gp){return -gp}var gt=ce(gr.to,gv.to)||bV(gs)-bV(gq);if(gt){return gt}return gq.id-gs.id}function a5(gq,gu){var gp=a6&&gq.markedSpans,gt;if(gp){for(var gs,gr=0;gr<gp.length;++gr){gs=gp[gr];if(gs.marker.collapsed&&(gu?gs.from:gs.to)==null&&(!gt||dQ(gt,gs.marker)<0)){gt=gs.marker}}}return gt}function eS(gp){return a5(gp,true)}function ex(gp){return a5(gp,false)}function z(gx,gr,gv,gw,gt){var gA=fk(gx,gr);var gp=a6&&gA.markedSpans;if(gp){for(var gs=0;gs<gp.length;++gs){var gq=gp[gs];if(!gq.marker.collapsed){continue}var gz=gq.marker.find(0);var gy=ce(gz.from,gv)||v(gq.marker)-v(gt);var gu=ce(gz.to,gw)||bV(gq.marker)-bV(gt);if(gy>=0&&gu<=0||gy<=0&&gu>=0){continue}if(gy<=0&&(ce(gz.to,gv)>0||(gq.marker.inclusiveRight&&gt.inclusiveLeft))||gy>=0&&(ce(gz.from,gw)<0||(gq.marker.inclusiveLeft&&gt.inclusiveRight))){return true}}}}function x(gq){var gp;while(gp=eS(gq)){gq=gp.find(-1,true).line}return gq}function g(gr){var gp,gq;while(gp=ex(gr)){gr=gp.find(1,true).line;(gq||(gq=[])).push(gr)}return gq}function aV(gs,gq){var gp=fk(gs,gq),gr=x(gp);if(gp==gr){return gq}return bM(gr)}function d3(gs,gr){if(gr>gs.lastLine()){return gr}var gq=fk(gs,gr),gp;if(!fB(gs,gq)){return gr}while(gp=ex(gq)){gq=gp.find(1,true).line}return bM(gq)+1}function fB(gt,gq){var gp=a6&&gq.markedSpans;if(gp){for(var gs,gr=0;gr<gp.length;++gr){gs=gp[gr];if(!gs.marker.collapsed){continue}if(gs.from==null){return true}if(gs.marker.widgetNode){continue}if(gs.from==0&&gs.marker.inclusiveLeft&&T(gt,gq,gs)){return true}}}}function T(gu,gq,gs){if(gs.to==null){var gp=gs.marker.find(1,true);return T(gu,gp.line,fe(gp.line.markedSpans,gs.marker))}if(gs.marker.inclusiveRight&&gs.to==gq.text.length){return true}for(var gt,gr=0;gr<gq.markedSpans.length;++gr){gt=gq.markedSpans[gr];if(gt.marker.collapsed&&!gt.marker.widgetNode&&gt.from==gs.to&&(gt.to==null||gt.to!=gs.from)&&(gt.marker.inclusiveLeft||gs.marker.inclusiveRight)&&T(gu,gq,gt)){return true}}}var dB=H.LineWidget=function(gs,gr,gp){if(gp){for(var gq in gp){if(gp.hasOwnProperty(gq)){this[gq]=gp[gq]}}}this.doc=gs;this.node=gr};bx(dB);function dZ(gp,gq,gr){if(bL(gq)<((gp.curOp&&gp.curOp.scrollTop)||gp.doc.scrollTop)){cK(gp,null,gr)}}dB.prototype.clear=function(){var gq=this.doc.cm,gs=this.line.widgets,gr=this.line,gu=bM(gr);if(gu==null||!gs){return}for(var gt=0;gt<gs.length;++gt){if(gs[gt]==this){gs.splice(gt--,1)}}if(!gs.length){gr.widgets=null}var gp=cX(this);gb(gr,Math.max(0,gr.height-gp));if(gq){cL(gq,function(){dZ(gq,gr,-gp);R(gq,gu,"widget")})}};dB.prototype.changed=function(){var gq=this.height,gp=this.doc.cm,gr=this.line;this.height=null;var gs=cX(this)-gq;if(!gs){return}gb(gr,gr.height+gs);if(gp){cL(gp,function(){gp.curOp.forceUpdate=true;dZ(gp,gr,gs)})}};function cX(gr){if(gr.height!=null){return gr.height}var gp=gr.doc.cm;if(!gp){return 0}if(!gg(document.body,gr.node)){var gq="position: relative;";if(gr.coverGutter){gq+="margin-left: -"+gp.display.gutters.offsetWidth+"px;"}if(gr.noHScroll){gq+="width: "+gp.display.wrapper.clientWidth+"px;"}bQ(gp.display.measure,f8("div",[gr.node],null,gq))}return gr.height=gr.node.parentNode.offsetHeight}function bG(gu,gt,gr,gq){var gs=new dB(gu,gr,gq);var gp=gu.cm;if(gp&&gs.noHScroll){gp.display.alignWidgets=true}eC(gu,gt,"widget",function(gw){var gx=gw.widgets||(gw.widgets=[]);if(gs.insertAt==null){gx.push(gs)}else{gx.splice(Math.min(gx.length-1,Math.max(0,gs.insertAt)),0,gs)}gs.line=gw;if(gp&&!fB(gu,gw)){var gv=bL(gw)<gu.scrollTop;gb(gw,gw.height+cX(gs));if(gv){cK(gp,null,gs.height)}gp.curOp.forceUpdate=true}return true});return gs}var gc=H.Line=function(gr,gq,gp){this.text=gr;c2(this,gq);this.height=gp?gp(this):1};bx(gc);gc.prototype.lineNo=function(){return bM(this)};function ep(gq,gt,gr,gp){gq.text=gt;if(gq.stateAfter){gq.stateAfter=null}if(gq.styles){gq.styles=null}if(gq.order!=null){gq.order=null}ge(gq);c2(gq,gr);var gs=gp?gp(gq):1;if(gs!=gq.height){gb(gq,gs)}}function bA(gp){gp.parent=null;ge(gp)}function di(gr,gq){if(gr){for(;;){var gp=gr.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!gp){break}gr=gr.slice(0,gp.index)+gr.slice(gp.index+gp[0].length);var gs=gp[1]?"bgClass":"textClass";if(gq[gs]==null){gq[gs]=gp[2]}else{if(!(new RegExp("(?:^|s)"+gp[2]+"(?:$|s)")).test(gq[gs])){gq[gs]+=" "+gp[2]}}}}return gr}function fv(gr,gq){if(gr.blankLine){return gr.blankLine(gq)}if(!gr.innerMode){return}var gp=H.innerMode(gr,gq);if(gp.mode.blankLine){return gp.mode.blankLine(gp.state)}}function eD(gu,gt,gs,gp){for(var gq=0;gq<10;gq++){if(gp){gp[0]=H.innerMode(gu,gs).mode}var gr=gu.token(gt,gs);if(gt.pos>gt.start){return gr}}throw new Error("Mode "+gu.name+" failed to advance stream.")}function cp(gy,gw,gt,gs){function gp(gB){return{start:gz.start,end:gz.pos,string:gz.current(),type:gr||null,state:gB?b2(gx.mode,gq):gq}}var gx=gy.doc,gu=gx.mode,gr;gw=fO(gx,gw);var gA=fk(gx,gw.line),gq=dC(gy,gw.line,gt);var gz=new eX(gA.text,gy.options.tabSize),gv;if(gs){gv=[]}while((gs||gz.pos<gw.ch)&&!gz.eol()){gz.start=gz.pos;gr=eD(gu,gz,gq);if(gs){gv.push(gp(true))}}return gs?gv:gp()}function w(gz,gB,gu,gq,gv,gs,gt){var gr=gu.flattenSpans;if(gr==null){gr=gz.options.flattenSpans}var gx=0,gw=null;var gA=new eX(gB,gz.options.tabSize),gp;var gD=gz.options.addModeClass&&[null];if(gB==""){di(fv(gu,gq),gs)}while(!gA.eol()){if(gA.pos>gz.options.maxHighlightLength){gr=false;if(gt){dx(gz,gB,gq,gA.pos)}gA.pos=gB.length;gp=null}else{gp=di(eD(gu,gA,gq,gD),gs)}if(gD){var gC=gD[0].name;if(gC){gp="m-"+(gp?gC+" "+gp:gC)}}if(!gr||gw!=gp){while(gx<gA.start){gx=Math.min(gA.start,gx+50000);gv(gx,gw)}gw=gp}gA.start=gA.pos}while(gx<gA.pos){var gy=Math.min(gA.pos,gx+50000);gv(gy,gw);gx=gy}}function fE(gw,gy,gp,gt){var gx=[gw.state.modeGen],gs={};w(gw,gy.text,gw.doc.mode,gp,function(gz,gA){gx.push(gz,gA)},gs,gt);for(var gq=0;gq<gw.state.overlays.length;++gq){var gu=gw.state.overlays[gq],gv=1,gr=0;w(gw,gy.text,gu.mode,true,function(gz,gB){var gD=gv;while(gr<gz){var gA=gx[gv];if(gA>gz){gx.splice(gv,1,gz,gx[gv+1],gA)}gv+=2;gr=Math.min(gz,gA)}if(!gB){return}if(gu.opaque){gx.splice(gD,gv-gD,gz,"cm-overlay "+gB);gv=gD+2}else{for(;gD<gv;gD+=2){var gC=gx[gD+1];gx[gD+1]=(gC?gC+" ":"")+"cm-overlay "+gB}}},gs)}return{styles:gx,classes:gs.bgClass||gs.textClass?gs:null}}function c5(gq,gr,gt){if(!gr.styles||gr.styles[0]!=gq.state.modeGen){var gs=dC(gq,bM(gr));var gp=fE(gq,gr,gr.text.length>gq.options.maxHighlightLength?b2(gq.doc.mode,gs):gs);gr.stateAfter=gs;gr.styles=gp.styles;if(gp.classes){gr.styleClasses=gp.classes}else{if(gr.styleClasses){gr.styleClasses=null}}if(gt===gq.doc.frontier){gq.doc.frontier++}}return gr.styles}function dx(gp,gu,gr,gq){var gt=gp.doc.mode;var gs=new eX(gu,gp.options.tabSize);gs.start=gs.pos=gq||0;if(gu==""){fv(gt,gr)}while(!gs.eol()){eD(gt,gs,gr);gs.start=gs.pos}}var dW={},b0={};function e0(gr,gq){if(!gr||/^\s*$/.test(gr)){return null}var gp=gq.addModeClass?b0:dW;return gp[gr]||(gp[gr]=gr.replace(/\S+/g,"cm-$&"))}function eV(gq,gu){var gv=f8("span",null,null,cZ?"padding-right: .1px":null);var gs={pre:f8("pre",[gv],"CodeMirror-line"),content:gv,col:0,pos:0,cm:gq,splitSpaces:(dK||cZ)&&gq.getOption("lineWrapping")};gu.measure={};for(var gt=0;gt<=(gu.rest?gu.rest.length:0);gt++){var gr=gt?gu.rest[gt-1]:gu.line,gp;gs.pos=0;gs.addToken=t;if(bN(gq.display.measure)&&(gp=a(gr))){gs.addToken=U(gs.addToken,gp)}gs.map=[];var gw=gu!=gq.display.externalMeasured&&bM(gr);bn(gr,gs,c5(gq,gr,gw));if(gr.styleClasses){if(gr.styleClasses.bgClass){gs.bgClass=fY(gr.styleClasses.bgClass,gs.bgClass||"")}if(gr.styleClasses.textClass){gs.textClass=fY(gr.styleClasses.textClass,gs.textClass||"")}}if(gs.map.length==0){gs.map.push(0,0,gs.content.appendChild(bm(gq.display.measure)))}if(gt==0){gu.measure.map=gs.map;gu.measure.cache={}}else{(gu.measure.maps||(gu.measure.maps=[])).push(gs.map);(gu.measure.caches||(gu.measure.caches=[])).push({})}}if(cZ&&/\bcm-tab\b/.test(gs.content.lastChild.className)){gs.content.className="cm-tab-wrap-hack"}aD(gq,"renderLine",gq,gu.line,gs.pre);if(gs.pre.className){gs.textClass=fY(gs.pre.className,gs.textClass||"")}return gs}function fh(gq){var gp=f8("span","\u2022","cm-invalidchar");gp.title="\\u"+gq.charCodeAt(0).toString(16);gp.setAttribute("aria-label",gp.title);return gp}function t(gA,gv,gF,gC,gy,gH,gu){if(!gv){return}var gE=gA.splitSpaces?gv.replace(/ {3,}/g,cE):gv;var gp=gA.cm.state.specialChars,gq=false;if(!gp.test(gv)){gA.col+=gv.length;var gD=document.createTextNode(gE);gA.map.push(gA.pos,gA.pos+gv.length,gD);if(dK&&k<9){gq=true}gA.pos+=gv.length}else{var gD=document.createDocumentFragment(),gs=0;while(true){gp.lastIndex=gs;var gB=gp.exec(gv);var gG=gB?gB.index-gs:gv.length-gs;if(gG){var gx=document.createTextNode(gE.slice(gs,gs+gG));if(dK&&k<9){gD.appendChild(f8("span",[gx]))}else{gD.appendChild(gx)}gA.map.push(gA.pos,gA.pos+gG,gx);gA.col+=gG;gA.pos+=gG}if(!gB){break}gs+=gG+1;if(gB[0]=="\t"){var gz=gA.cm.options.tabSize,gw=gz-gA.col%gz;var gx=gD.appendChild(f8("span",co(gw),"cm-tab"));gx.setAttribute("role","presentation");gx.setAttribute("cm-text","\t");gA.col+=gw}else{if(gB[0]=="\r"||gB[0]=="\n"){var gx=gD.appendChild(f8("span",gB[0]=="\r"?"\u240d":"\u2424","cm-invalidchar"));gx.setAttribute("cm-text",gB[0]);gA.col+=1}else{var gx=gA.cm.options.specialCharPlaceholder(gB[0]);gx.setAttribute("cm-text",gB[0]);if(dK&&k<9){gD.appendChild(f8("span",[gx]))}else{gD.appendChild(gx)}gA.col+=1}}gA.map.push(gA.pos,gA.pos+1,gx);gA.pos++}}if(gF||gC||gy||gq||gu){var gr=gF||"";if(gC){gr+=gC}if(gy){gr+=gy}var gt=f8("span",[gD],gr,gu);if(gH){gt.title=gH}return gA.content.appendChild(gt)}gA.content.appendChild(gD)}function cE(gp){var gq=" ";for(var gr=0;gr<gp.length-2;++gr){gq+=gr%2?" ":"\u00a0"}gq+=" ";return gq}function U(gq,gp){return function(gy,gA,gr,gv,gB,gz,gx){gr=gr?gr+" cm-force-border":"cm-force-border";var gs=gy.pos,gu=gs+gA.length;for(;;){for(var gw=0;gw<gp.length;gw++){var gt=gp[gw];if(gt.to>gs&&gt.from<=gs){break}}if(gt.to>=gu){return gq(gy,gA,gr,gv,gB,gz,gx)}gq(gy,gA.slice(0,gt.to-gs),gr,gv,null,gz,gx);gv=null;gA=gA.slice(gt.to-gs);gs=gt.to}}}function ac(gq,gs,gp,gr){var gt=!gr&&gp.widgetNode;if(gt){gq.map.push(gq.pos,gq.pos+gs,gt)}if(!gr&&gq.cm.display.input.needsContentAttribute){if(!gt){gt=gq.content.appendChild(document.createElement("span"))}gt.setAttribute("cm-marker",gp.id)}if(gt){gq.cm.display.input.setUneditable(gt);gq.content.appendChild(gt)}gq.pos+=gs}function bn(gz,gG,gy){var gu=gz.markedSpans,gw=gz.text,gE=0;if(!gu){for(var gJ=1;gJ<gy.length;gJ+=2){gG.addToken(gG,gw.slice(gE,gE=gy[gJ]),e0(gy[gJ+1],gG.cm.options))}return}var gK=gw.length,gt=0,gJ=1,gC="",gL,gA;var gN=0,gp,gM,gD,gO,gr;for(;;){if(gN==gt){gp=gM=gD=gO=gA="";gr=null;gN=Infinity;var gv=[],gx;for(var gH=0;gH<gu.length;++gH){var gI=gu[gH],gF=gI.marker;if(gF.type=="bookmark"&&gI.from==gt&&gF.widgetNode){gv.push(gF)}else{if(gI.from<=gt&&(gI.to==null||gI.to>gt||gF.collapsed&&gI.to==gt&&gI.from==gt)){if(gI.to!=null&&gI.to!=gt&&gN>gI.to){gN=gI.to;gM=""}if(gF.className){gp+=" "+gF.className}if(gF.css){gA=(gA?gA+";":"")+gF.css}if(gF.startStyle&&gI.from==gt){gD+=" "+gF.startStyle}if(gF.endStyle&&gI.to==gN){(gx||(gx=[])).push(gF.endStyle,gI.to)}if(gF.title&&!gO){gO=gF.title}if(gF.collapsed&&(!gr||dQ(gr.marker,gF)<0)){gr=gI}}else{if(gI.from>gt&&gN>gI.from){gN=gI.from}}}}if(gx){for(var gH=0;gH<gx.length;gH+=2){if(gx[gH+1]==gN){gM+=" "+gx[gH]}}}if(gr&&(gr.from||0)==gt){ac(gG,(gr.to==null?gK+1:gr.to)-gt,gr.marker,gr.from==null);if(gr.to==null){return}if(gr.to==gt){gr=false}}if(!gr&&gv.length){for(var gH=0;gH<gv.length;++gH){ac(gG,0,gv[gH])}}}if(gt>=gK){break}var gB=Math.min(gK,gN);while(true){if(gC){var gq=gt+gC.length;if(!gr){var gs=gq>gB?gC.slice(0,gB-gt):gC;gG.addToken(gG,gs,gL?gL+gp:gp,gD,gt+gs.length==gN?gM:"",gO,gA)}if(gq>=gB){gC=gC.slice(gB-gt);gt=gB;break}gt=gq;gD=""}gC=gw.slice(gE,gE=gy[gJ++]);gL=e0(gy[gJ++],gG.cm.options)}}}function dS(gp,gq){return gq.from.ch==0&&gq.to.ch==0&&fL(gq.text)==""&&(!gp.cm||gp.cm.options.wholeLineUpdateBefore)}function fD(gC,gx,gq,gt){function gD(gF){return gq?gq[gF]:null}function gr(gF,gH,gG){ep(gF,gH,gG,gt);ae(gF,"change",gF,gx)}function gp(gI,gG){for(var gH=gI,gF=[];gH<gG;++gH){gF.push(new gc(gE[gH],gD(gH),gt))}return gF}var gB=gx.from,gA=gx.to,gE=gx.text;var gy=fk(gC,gB.line),gz=fk(gC,gA.line);var gw=fL(gE),gs=gD(gE.length-1),gv=gA.line-gB.line;if(gx.full){gC.insert(0,gp(0,gE.length));gC.remove(gE.length,gC.size-gE.length)}else{if(dS(gC,gx)){var gu=gp(0,gE.length-1);gr(gz,gz.text,gs);if(gv){gC.remove(gB.line,gv)}if(gu.length){gC.insert(gB.line,gu)}}else{if(gy==gz){if(gE.length==1){gr(gy,gy.text.slice(0,gB.ch)+gw+gy.text.slice(gA.ch),gs)}else{var gu=gp(1,gE.length-1);gu.push(new gc(gw+gy.text.slice(gA.ch),gs,gt));gr(gy,gy.text.slice(0,gB.ch)+gE[0],gD(0));gC.insert(gB.line+1,gu)}}else{if(gE.length==1){gr(gy,gy.text.slice(0,gB.ch)+gE[0]+gz.text.slice(gA.ch),gD(0));gC.remove(gB.line+1,gv)}else{gr(gy,gy.text.slice(0,gB.ch)+gE[0],gD(0));gr(gz,gw+gz.text.slice(gA.ch),gs);var gu=gp(1,gE.length-1);if(gv>1){gC.remove(gB.line+1,gv-1)}gC.insert(gB.line+1,gu)}}}}ae(gC,"change",gC,gx)}function e3(gq){this.lines=gq;this.parent=null;for(var gr=0,gp=0;gr<gq.length;++gr){gq[gr].parent=this;gp+=gq[gr].height}this.height=gp}e3.prototype={chunkSize:function(){return this.lines.length},removeInner:function(gp,gt){for(var gr=gp,gs=gp+gt;gr<gs;++gr){var gq=this.lines[gr];this.height-=gq.height;bA(gq);ae(gq,"delete")}this.lines.splice(gp,gt)},collapse:function(gp){gp.push.apply(gp,this.lines)},insertInner:function(gq,gr,gp){this.height+=gp;this.lines=this.lines.slice(0,gq).concat(gr).concat(this.lines.slice(gq));for(var gs=0;gs<gr.length;++gs){gr[gs].parent=this}},iterN:function(gp,gs,gr){for(var gq=gp+gs;gp<gq;++gp){if(gr(this.lines[gp])){return true}}}};function fC(gs){this.children=gs;var gr=0,gp=0;for(var gq=0;gq<gs.length;++gq){var gt=gs[gq];gr+=gt.chunkSize();gp+=gt.height;gt.parent=this}this.size=gr;this.height=gp;this.parent=null}fC.prototype={chunkSize:function(){return this.size},removeInner:function(gp,gw){this.size-=gw;for(var gr=0;gr<this.children.length;++gr){var gv=this.children[gr],gt=gv.chunkSize();if(gp<gt){var gs=Math.min(gw,gt-gp),gu=gv.height;gv.removeInner(gp,gs);this.height-=gu-gv.height;if(gt==gs){this.children.splice(gr--,1);gv.parent=null}if((gw-=gs)==0){break}gp=0}else{gp-=gt}}if(this.size-gw<25&&(this.children.length>1||!(this.children[0] instanceof e3))){var gq=[];this.collapse(gq);this.children=[new e3(gq)];this.children[0].parent=this}},collapse:function(gp){for(var gq=0;gq<this.children.length;++gq){this.children[gq].collapse(gp)}},insertInner:function(gq,gr,gp){this.size+=gr.length;this.height+=gp;for(var gu=0;gu<this.children.length;++gu){var gw=this.children[gu],gv=gw.chunkSize();if(gq<=gv){gw.insertInner(gq,gr,gp);if(gw.lines&&gw.lines.length>50){while(gw.lines.length>50){var gt=gw.lines.splice(gw.lines.length-25,25);var gs=new e3(gt);gw.height-=gs.height;this.children.splice(gu+1,0,gs);gs.parent=this}this.maybeSpill()}break}gq-=gv}},maybeSpill:function(){if(this.children.length<=10){return}var gs=this;do{var gq=gs.children.splice(gs.children.length-5,5);var gr=new fC(gq);if(!gs.parent){var gt=new fC(gs.children);gt.parent=gs;gs.children=[gt,gr];gs=gt}else{gs.size-=gr.size;gs.height-=gr.height;var gp=dh(gs.parent.children,gs);gs.parent.children.splice(gp+1,0,gr)}gr.parent=gs.parent}while(gs.children.length>10);gs.parent.maybeSpill()},iterN:function(gp,gv,gu){for(var gq=0;gq<this.children.length;++gq){var gt=this.children[gq],gs=gt.chunkSize();if(gp<gs){var gr=Math.min(gv,gs-gp);if(gt.iterN(gp,gr,gu)){return true}if((gv-=gr)==0){break}gp=0}else{gp-=gs}}}};var cq=0;var ar=H.Doc=function(gs,gr,gp,gq){if(!(this instanceof ar)){return new ar(gs,gr,gp,gq)}if(gp==null){gp=0}fC.call(this,[new e3([new gc("",null)])]);this.first=gp;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=gp;var gt=W(gp,0);this.sel=eW(gt);this.history=new fZ(null);this.id=++cq;this.modeOption=gr;this.lineSep=gq;this.extend=false;if(typeof gs=="string"){gs=this.splitLines(gs)}fD(this,{from:gt,to:gt,text:gs});bT(this,eW(gt),Z)};ar.prototype=cj(fC.prototype,{constructor:ar,iter:function(gr,gq,gp){if(gp){this.iterN(gr-this.first,gq-gr,gp)}else{this.iterN(this.first,this.first+this.size,gr)}},insert:function(gq,gr){var gp=0;for(var gs=0;gs<gr.length;++gs){gp+=gr[gs].height}this.insertInner(gq-this.first,gr,gp)},remove:function(gp,gq){this.removeInner(gp-this.first,gq)},getValue:function(gq){var gp=a1(this,this.first,this.first+this.size);if(gq===false){return gp}return gp.join(gq||this.lineSeparator())},setValue:cC(function(gq){var gr=W(this.first,0),gp=this.first+this.size-1;bf(this,{from:gr,to:W(gp,fk(this,gp).text.length),text:this.splitLines(gq),origin:"setValue",full:true},true);bT(this,eW(gr))}),replaceRange:function(gq,gs,gr,gp){gs=fO(this,gs);gr=gr?fO(this,gr):gs;a0(this,gq,gs,gr,gp)},getRange:function(gs,gr,gq){var gp=ga(this,fO(this,gs),fO(this,gr));if(gq===false){return gp}return gp.join(gq||this.lineSeparator())},getLine:function(gq){var gp=this.getLineHandle(gq);return gp&&gp.text},getLineHandle:function(gp){if(b8(this,gp)){return fk(this,gp)}},getLineNumber:function(gp){return bM(gp)},getLineHandleVisualStart:function(gp){if(typeof gp=="number"){gp=fk(this,gp)}return x(gp)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(gp){return fO(this,gp)},getCursor:function(gr){var gp=this.sel.primary(),gq;if(gr==null||gr=="head"){gq=gp.head}else{if(gr=="anchor"){gq=gp.anchor}else{if(gr=="end"||gr=="to"||gr===false){gq=gp.to()}else{gq=gp.from()}}}return gq},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:cC(function(gp,gr,gq){F(this,fO(this,typeof gp=="number"?W(gp,gr||0):gp),null,gq)}),setSelection:cC(function(gq,gr,gp){F(this,fO(this,gq),fO(this,gr||gq),gp)}),extendSelection:cC(function(gr,gp,gq){f2(this,fO(this,gr),gp&&fO(this,gp),gq)}),extendSelections:cC(function(gq,gp){av(this,d0(this,gq),gp)}),extendSelectionsBy:cC(function(gr,gp){var gq=bR(this.sel.ranges,gr);av(this,d0(this,gq),gp)}),setSelections:cC(function(gp,gt,gr){if(!gp.length){return}for(var gs=0,gq=[];gs<gp.length;gs++){gq[gs]=new dY(fO(this,gp[gs].anchor),fO(this,gp[gs].head))}if(gt==null){gt=Math.min(gp.length-1,this.sel.primIndex)}bT(this,cv(gq,gt),gr)}),addSelection:cC(function(gr,gs,gq){var gp=this.sel.ranges.slice(0);gp.push(new dY(fO(this,gr),fO(this,gs||gr)));bT(this,cv(gp,gp.length-1),gq)}),getSelection:function(gt){var gq=this.sel.ranges,gp;for(var gr=0;gr<gq.length;gr++){var gs=ga(this,gq[gr].from(),gq[gr].to());gp=gp?gp.concat(gs):gs}if(gt===false){return gp}else{return gp.join(gt||this.lineSeparator())}},getSelections:function(gt){var gs=[],gp=this.sel.ranges;for(var gq=0;gq<gp.length;gq++){var gr=ga(this,gp[gq].from(),gp[gq].to());if(gt!==false){gr=gr.join(gt||this.lineSeparator())}gs[gq]=gr}return gs},replaceSelection:function(gr,gt,gp){var gs=[];for(var gq=0;gq<this.sel.ranges.length;gq++){gs[gq]=gr}this.replaceSelections(gs,gt,gp||"+input")},replaceSelections:cC(function(gu,gw,gr){var gt=[],gv=this.sel;for(var gs=0;gs<gv.ranges.length;gs++){var gq=gv.ranges[gs];gt[gs]={from:gq.from(),to:gq.to(),text:this.splitLines(gu[gs]),origin:gr}}var gp=gw&&gw!="end"&&af(this,gt,gw);for(var gs=gt.length-1;gs>=0;gs--){bf(this,gt[gs])}if(gp){fc(this,gp)}else{if(this.cm){fK(this.cm)}}}),undo:cC(function(){b7(this,"undo")}),redo:cC(function(){b7(this,"redo")}),undoSelection:cC(function(){b7(this,"undo",true)}),redoSelection:cC(function(){b7(this,"redo",true)}),setExtending:function(gp){this.extend=gp},getExtending:function(){return this.extend},historySize:function(){var gs=this.history,gp=0,gr=0;for(var gq=0;gq<gs.done.length;gq++){if(!gs.done[gq].ranges){++gp}}for(var gq=0;gq<gs.undone.length;gq++){if(!gs.undone[gq].ranges){++gr}}return{undo:gp,redo:gr}},clearHistory:function(){this.history=new fZ(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(gp){if(gp){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(gp){return this.history.generation==(gp||this.cleanGeneration)},getHistory:function(){return{done:bO(this.history.done),undone:bO(this.history.undone)}},setHistory:function(gq){var gp=this.history=new fZ(this.history.maxGeneration);gp.done=bO(gq.done.slice(0),null,true);gp.undone=bO(gq.undone.slice(0),null,true)},addLineClass:cC(function(gr,gq,gp){return eC(this,gr,gq=="gutter"?"gutter":"class",function(gs){var gt=gq=="text"?"textClass":gq=="background"?"bgClass":gq=="gutter"?"gutterClass":"wrapClass";if(!gs[gt]){gs[gt]=gp}else{if(S(gp).test(gs[gt])){return false}else{gs[gt]+=" "+gp}}return true})}),removeLineClass:cC(function(gr,gq,gp){return eC(this,gr,gq=="gutter"?"gutter":"class",function(gt){var gw=gq=="text"?"textClass":gq=="background"?"bgClass":gq=="gutter"?"gutterClass":"wrapClass";var gv=gt[gw];if(!gv){return false}else{if(gp==null){gt[gw]=null}else{var gu=gv.match(S(gp));if(!gu){return false}var gs=gu.index+gu[0].length;gt[gw]=gv.slice(0,gu.index)+(!gu.index||gs==gv.length?"":" ")+gv.slice(gs)||null}}return true})}),addLineWidget:cC(function(gr,gq,gp){return bG(this,gr,gq,gp)}),removeLineWidget:function(gp){gp.clear()},markText:function(gr,gq,gp){return eI(this,fO(this,gr),fO(this,gq),gp,gp&&gp.type||"range")},setBookmark:function(gr,gp){var gq={replacedWith:gp&&(gp.nodeType==null?gp.widget:gp),insertLeft:gp&&gp.insertLeft,clearWhenEmpty:false,shared:gp&&gp.shared,handleMouseEvents:gp&&gp.handleMouseEvents};gr=fO(this,gr);return eI(this,gr,gr,gq,"bookmark")},findMarksAt:function(gt){gt=fO(this,gt);var gs=[],gq=fk(this,gt.line).markedSpans;if(gq){for(var gp=0;gp<gq.length;++gp){var gr=gq[gp];if((gr.from==null||gr.from<=gt.ch)&&(gr.to==null||gr.to>=gt.ch)){gs.push(gr.marker.parent||gr.marker)}}}return gs},findMarks:function(gt,gs,gp){gt=fO(this,gt);gs=fO(this,gs);var gq=[],gr=gt.line;this.iter(gt.line,gs.line+1,function(gu){var gw=gu.markedSpans;if(gw){for(var gv=0;gv<gw.length;gv++){var gx=gw[gv];if(!(gr==gt.line&&gt.ch>gx.to||gx.from==null&&gr!=gt.line||gr==gs.line&&gx.from>gs.ch)&&(!gp||gp(gx.marker))){gq.push(gx.marker.parent||gx.marker)}}}++gr});return gq},getAllMarks:function(){var gp=[];this.iter(function(gr){var gq=gr.markedSpans;if(gq){for(var gs=0;gs<gq.length;++gs){if(gq[gs].from!=null){gp.push(gq[gs].marker)}}}});return gp},posFromIndex:function(gq){var gp,gr=this.first;this.iter(function(gs){var gt=gs.text.length+1;if(gt>gq){gp=gq;return true}gq-=gt;++gr});return fO(this,W(gr,gp))},indexFromPos:function(gq){gq=fO(this,gq);var gp=gq.ch;if(gq.line<this.first||gq.ch<0){return 0}this.iter(this.first,gq.line,function(gr){gp+=gr.text.length+1});return gp},copy:function(gp){var gq=new ar(a1(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);gq.scrollTop=this.scrollTop;gq.scrollLeft=this.scrollLeft;gq.sel=this.sel;gq.extend=false;if(gp){gq.history.undoDepth=this.history.undoDepth;gq.setHistory(this.getHistory())}return gq},linkedDoc:function(gp){if(!gp){gp={}}var gs=this.first,gr=this.first+this.size;if(gp.from!=null&&gp.from>gs){gs=gp.from}if(gp.to!=null&&gp.to<gr){gr=gp.to}var gq=new ar(a1(this,gs,gr),gp.mode||this.modeOption,gs,this.lineSep);if(gp.sharedHist){gq.history=this.history}(this.linked||(this.linked=[])).push({doc:gq,sharedHist:gp.sharedHist});gq.linked=[{doc:this,isParent:true,sharedHist:gp.sharedHist}];dF(gq,eT(this));return gq},unlinkDoc:function(gq){if(gq instanceof H){gq=gq.doc}if(this.linked){for(var gr=0;gr<this.linked.length;++gr){var gs=this.linked[gr];if(gs.doc!=gq){continue}this.linked.splice(gr,1);gq.unlinkDoc(this);er(eT(this));break}}if(gq.history==this.history){var gp=[gq.id];d8(gq,function(gt){gp.push(gt.id)},true);gq.history=new fZ(null);gq.history.done=bO(this.history.done,gp);gq.history.undone=bO(this.history.undone,gp)}},iterLinkedDocs:function(gp){d8(this,gp)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(gp){if(this.lineSep){return gp.split(this.lineSep)}return fX(gp)},lineSeparator:function(){return this.lineSep||"\n"}});ar.prototype.eachLine=ar.prototype.iter;var d="iter insert remove copy getEditor constructor".split(" ");for(var bJ in ar.prototype){if(ar.prototype.hasOwnProperty(bJ)&&dh(d,bJ)<0){H.prototype[bJ]=(function(gp){return function(){return gp.apply(this.doc,arguments)}})(ar.prototype[bJ])}}bx(ar);function d8(gs,gr,gq){function gp(gy,gw,gu){if(gy.linked){for(var gv=0;gv<gy.linked.length;++gv){var gt=gy.linked[gv];if(gt.doc==gw){continue}var gx=gu&&gt.sharedHist;if(gq&&!gx){continue}gr(gt.doc,gx);gp(gt.doc,gy,gx)}}}gp(gs,null,true)}function ed(gp,gq){if(gq.cm){throw new Error("This document is already in use.")}gp.doc=gq;gq.cm=gp;X(gp);bq(gp);if(!gp.options.lineWrapping){h(gp)}gp.options.mode=gq.modeOption;ah(gp)}function fk(gs,gu){gu-=gs.first;if(gu<0||gu>=gs.size){throw new Error("There is no line "+(gu+gs.first)+" in the document.")}for(var gp=gs;!gp.lines;){for(var gq=0;;++gq){var gt=gp.children[gq],gr=gt.chunkSize();if(gu<gr){gp=gt;break}gu-=gr}}return gp.lines[gu]}function ga(gr,gt,gp){var gq=[],gs=gt.line;gr.iter(gt.line,gp.line+1,function(gu){var gv=gu.text;if(gs==gp.line){gv=gv.slice(0,gp.ch)}if(gs==gt.line){gv=gv.slice(gt.ch)}gq.push(gv);++gs});return gq}function a1(gq,gs,gr){var gp=[];gq.iter(gs,gr,function(gt){gp.push(gt.text)});return gp}function gb(gq,gp){var gr=gp-gq.height;if(gr){for(var gs=gq;gs;gs=gs.parent){gs.height+=gr}}}function bM(gp){if(gp.parent==null){return null}var gt=gp.parent,gs=dh(gt.lines,gp);for(var gq=gt.parent;gq;gt=gq,gq=gq.parent){for(var gr=0;;++gr){if(gq.children[gr]==gt){break}gs+=gq.children[gr].chunkSize()}}return gs+gt.first}function bF(gr,gu){var gw=gr.first;outer:do{for(var gs=0;gs<gr.children.length;++gs){var gv=gr.children[gs],gt=gv.height;if(gu<gt){gr=gv;continue outer}gu-=gt;gw+=gv.chunkSize()}return gw}while(!gr.lines);for(var gs=0;gs<gr.lines.length;++gs){var gq=gr.lines[gs],gp=gq.height;if(gu<gp){break}gu-=gp}return gw+gs}function bL(gr){gr=x(gr);var gt=0,gq=gr.parent;for(var gs=0;gs<gq.lines.length;++gs){var gp=gq.lines[gs];if(gp==gr){break}else{gt+=gp.height}}for(var gu=gq.parent;gu;gq=gu,gu=gq.parent){for(var gs=0;gs<gu.children.length;++gs){var gv=gu.children[gs];if(gv==gq){break}else{gt+=gv.height}}}return gt}function a(gq){var gp=gq.order;if(gp==null){gp=gq.order=bg(gq.text)}return gp}function fZ(gp){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=gp||1}function du(gp,gr){var gq={from:ch(gr.from),to:cW(gr),text:ga(gp,gr.from,gr.to)};bX(gp,gq,gr.from.line,gr.to.line+1);d8(gp,function(gs){bX(gs,gq,gr.from.line,gr.to.line+1)},true);return gq}function fG(gq){while(gq.length){var gp=fL(gq);if(gp.ranges){gq.pop()}else{break}}}function eQ(gq,gp){if(gp){fG(gq.done);return fL(gq.done)}else{if(gq.done.length&&!fL(gq.done).ranges){return fL(gq.done)}else{if(gq.done.length>1&&!gq.done[gq.done.length-2].ranges){gq.done.pop();return fL(gq.done)}}}}function fR(gv,gt,gp,gs){var gr=gv.history;gr.undone.length=0;var gq=+new Date,gw;if((gr.lastOp==gs||gr.lastOrigin==gt.origin&&gt.origin&&((gt.origin.charAt(0)=="+"&&gv.cm&&gr.lastModTime>gq-gv.cm.options.historyEventDelay)||gt.origin.charAt(0)=="*"))&&(gw=eQ(gr,gr.lastOp==gs))){var gx=fL(gw.changes);if(ce(gt.from,gt.to)==0&&ce(gt.from,gx.to)==0){gx.to=cW(gt)}else{gw.changes.push(du(gv,gt))}}else{var gu=fL(gr.done);if(!gu||!gu.ranges){cM(gv.sel,gr.done)}gw={changes:[du(gv,gt)],generation:gr.generation};gr.done.push(gw);while(gr.done.length>gr.undoDepth){gr.done.shift();if(!gr.done[0].ranges){gr.done.shift()}}}gr.done.push(gp);gr.generation=++gr.maxGeneration;gr.lastModTime=gr.lastSelTime=gq;gr.lastOp=gr.lastSelOp=gs;gr.lastOrigin=gr.lastSelOrigin=gt.origin;if(!gx){aD(gv,"historyAdded")}}function bz(gt,gp,gr,gs){var gq=gp.charAt(0);return gq=="*"||gq=="+"&&gr.ranges.length==gs.ranges.length&&gr.somethingSelected()==gs.somethingSelected()&&new Date-gt.history.lastSelTime<=(gt.cm?gt.cm.options.historyEventDelay:500)}function gh(gu,gs,gp,gr){var gt=gu.history,gq=gr&&gr.origin;if(gp==gt.lastSelOp||(gq&&gt.lastSelOrigin==gq&&(gt.lastModTime==gt.lastSelTime&&gt.lastOrigin==gq||bz(gu,gq,fL(gt.done),gs)))){gt.done[gt.done.length-1]=gs}else{cM(gs,gt.done)}gt.lastSelTime=+new Date;gt.lastSelOrigin=gq;gt.lastSelOp=gp;if(gr&&gr.clearRedo!==false){fG(gt.undone)}}function cM(gq,gp){var gr=fL(gp);if(!(gr&&gr.ranges&&gr.equals(gq))){gp.push(gq)}}function bX(gq,gu,gt,gs){var gp=gu["spans_"+gq.id],gr=0;gq.iter(Math.max(gq.first,gt),Math.min(gq.first+gq.size,gs),function(gv){if(gv.markedSpans){(gp||(gp=gu["spans_"+gq.id]={}))[gr]=gv.markedSpans}++gr})}function bk(gr){if(!gr){return null}for(var gq=0,gp;gq<gr.length;++gq){if(gr[gq].marker.explicitlyCleared){if(!gp){gp=gr.slice(0,gq)}}else{if(gp){gp.push(gr[gq])}}}return !gp?gr:gp.length?gp:null}function b3(gs,gt){var gr=gt["spans_"+gs.id];if(!gr){return null}for(var gq=0,gp=[];gq<gt.text.length;++gq){gp.push(bk(gr[gq]))}return gp}function bO(gA,gs,gz){for(var gv=0,gq=[];gv<gA.length;++gv){var gr=gA[gv];if(gr.ranges){gq.push(gz?f9.prototype.deepCopy.call(gr):gr);continue}var gx=gr.changes,gy=[];gq.push({changes:gy});for(var gu=0;gu<gx.length;++gu){var gw=gx[gu],gt;gy.push({from:gw.from,to:gw.to,text:gw.text});if(gs){for(var gp in gw){if(gt=gp.match(/^spans_(\d+)$/)){if(dh(gs,Number(gt[1]))>-1){fL(gy)[gp]=gw[gp];delete gw[gp]}}}}}}return gq}function I(gs,gr,gq,gp){if(gq<gs.line){gs.line+=gp}else{if(gr<gs.line){gs.line=gr;gs.ch=0}}}function fm(gs,gu,gv,gw){for(var gr=0;gr<gs.length;++gr){var gp=gs[gr],gt=true;if(gp.ranges){if(!gp.copied){gp=gs[gr]=gp.deepCopy();gp.copied=true}for(var gq=0;gq<gp.ranges.length;gq++){I(gp.ranges[gq].anchor,gu,gv,gw);I(gp.ranges[gq].head,gu,gv,gw)}continue}for(var gq=0;gq<gp.changes.length;++gq){var gx=gp.changes[gq];if(gv<gx.from.line){gx.from=W(gx.from.line+gw,gx.from.ch);gx.to=W(gx.to.line+gw,gx.to.ch)}else{if(gu<=gx.to.line){gt=false;break}}}if(!gt){gs.splice(0,gr+1);gr=0}}}function dE(gq,gt){var gs=gt.from.line,gr=gt.to.line,gp=gt.text.length-(gr-gs)-1;fm(gq.done,gs,gr,gp);fm(gq.undone,gs,gr,gp)}var cF=H.e_preventDefault=function(gp){if(gp.preventDefault){gp.preventDefault()}else{gp.returnValue=false}};var dq=H.e_stopPropagation=function(gp){if(gp.stopPropagation){gp.stopPropagation()}else{gp.cancelBubble=true}};function bK(gp){return gp.defaultPrevented!=null?gp.defaultPrevented:gp.returnValue==false}var eu=H.e_stop=function(gp){cF(gp);dq(gp)};function L(gp){return gp.target||gp.srcElement}function fS(gq){var gp=gq.which;if(gp==null){if(gq.button&1){gp=1}else{if(gq.button&2){gp=3}else{if(gq.button&4){gp=2}}}}if(b6&&gq.ctrlKey&&gp==1){gp=3}return gp}var bW=H.on=function(gs,gq,gr){if(gs.addEventListener){gs.addEventListener(gq,gr,false)}else{if(gs.attachEvent){gs.attachEvent("on"+gq,gr)}else{var gt=gs._handlers||(gs._handlers={});var gp=gt[gq]||(gt[gq]=[]);gp.push(gr)}}};var fa=[];function en(gr,gq,gs){var gp=gr._handlers&&gr._handlers[gq];if(gs){return gp&&gp.length>0?gp.slice():fa}else{return gp||fa}}var ef=H.off=function(gt,gr,gs){if(gt.removeEventListener){gt.removeEventListener(gr,gs,false)}else{if(gt.detachEvent){gt.detachEvent("on"+gr,gs)}else{var gp=en(gt,gr,false);for(var gq=0;gq<gp.length;++gq){if(gp[gq]==gs){gp.splice(gq,1);break}}}}};var aD=H.signal=function(gt,gs){var gp=en(gt,gs,true);if(!gp.length){return}var gq=Array.prototype.slice.call(arguments,2);for(var gr=0;gr<gp.length;++gr){gp[gr].apply(null,gq)}};var by=null;function ae(gv,gt){var gp=en(gv,gt,false);if(!gp.length){return}var gr=Array.prototype.slice.call(arguments,2),gu;if(bo){gu=bo.delayedCallbacks}else{if(by){gu=by}else{gu=by=[];setTimeout(aL,0)}}function gq(gw){return function(){gw.apply(null,gr)}}for(var gs=0;gs<gp.length;++gs){gu.push(gq(gp[gs]))}}function aL(){var gp=by;by=null;for(var gq=0;gq<gp.length;++gq){gp[gq]()}}function aQ(gp,gr,gq){if(typeof gr=="string"){gr={type:gr,preventDefault:function(){this.defaultPrevented=true}}}aD(gp,gq||gr.type,gp,gr);return bK(gr)||gr.codemirrorIgnore}function V(gq){var gp=gq._handlers&&gq._handlers.cursorActivity;if(!gp){return}var gs=gq.curOp.cursorActivityHandlers||(gq.curOp.cursorActivityHandlers=[]);for(var gr=0;gr<gp.length;++gr){if(dh(gs,gp[gr])==-1){gs.push(gp[gr])}}}function fn(gq,gp){return en(gq,gp).length>0}function bx(gp){gp.prototype.on=function(gq,gr){bW(this,gq,gr)};gp.prototype.off=function(gq,gr){ef(this,gq,gr)}}var dJ=30;var b9=H.Pass={toString:function(){return"CodeMirror.Pass"}};var Z={scroll:false},M={origin:"*mouse"},cV={origin:"+move"};function go(){this.id=null}go.prototype.set=function(gp,gq){clearTimeout(this.id);this.id=setTimeout(gq,gp)};var bS=H.countColumn=function(gs,gq,gu,gv,gr){if(gq==null){gq=gs.search(/[^\s\u00a0]/);if(gq==-1){gq=gs.length}}for(var gt=gv||0,gw=gr||0;;){var gp=gs.indexOf("\t",gt);if(gp<0||gp>=gq){return gw+(gq-gt)}gw+=gp-gt;gw+=gu-(gw%gu);gt=gp+1}};var et=H.findColumn=function(gt,gs,gu){for(var gv=0,gr=0;;){var gq=gt.indexOf("\t",gv);if(gq==-1){gq=gt.length}var gp=gq-gv;if(gq==gt.length||gr+gp>=gs){return gv+Math.min(gp,gs-gr)}gr+=gq-gv;gr+=gu-(gr%gu);gv=gq+1;if(gr>=gs){return gv}}};var aZ=[""];function co(gp){while(aZ.length<=gp){aZ.push(fL(aZ)+" ")}return aZ[gp]}function fL(gp){return gp[gp.length-1]}var dL=function(gp){gp.select()};if(e5){dL=function(gp){gp.selectionStart=0;gp.selectionEnd=gp.value.length}}else{if(dK){dL=function(gq){try{gq.select()}catch(gp){}}}}function dh(gr,gp){for(var gq=0;gq<gr.length;++gq){if(gr[gq]==gp){return gq}}return -1}function bR(gs,gr){var gp=[];for(var gq=0;gq<gs.length;gq++){gp[gq]=gr(gs[gq],gq)}return gp}function f0(){}function cj(gr,gp){var gq;if(Object.create){gq=Object.create(gr)}else{f0.prototype=gr;gq=new f0()}if(gp){aM(gp,gq)}return gq}function aM(gr,gq,gp){if(!gq){gq={}}for(var gs in gr){if(gr.hasOwnProperty(gs)&&(gp!==false||!gq.hasOwnProperty(gs))){gq[gs]=gr[gs]}}return gq}function cu(gq){var gp=Array.prototype.slice.call(arguments,1);return function(){return gq.apply(null,gp)}}var bb=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var fI=H.isWordChar=function(gp){return/\w/.test(gp)||gp>"\x80"&&(gp.toUpperCase()!=gp.toLowerCase()||bb.test(gp))};function cz(gp,gq){if(!gq){return fI(gp)}if(gq.source.indexOf("\\w")>-1&&fI(gp)){return true}return gq.test(gp)}function eY(gp){for(var gq in gp){if(gp.hasOwnProperty(gq)&&gp[gq]){return false}}return true}var eN=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function fu(gp){return gp.charCodeAt(0)>=768&&eN.test(gp)}function f8(gp,gt,gs,gr){var gu=document.createElement(gp);if(gs){gu.className=gs}if(gr){gu.style.cssText=gr}if(typeof gt=="string"){gu.appendChild(document.createTextNode(gt))}else{if(gt){for(var gq=0;gq<gt.length;++gq){gu.appendChild(gt[gq])}}}return gu}var ck;if(document.createRange){ck=function(gs,gt,gq,gp){var gr=document.createRange();gr.setEnd(gp||gs,gq);gr.setStart(gs,gt);return gr}}else{ck=function(gr,gt,gp){var gq=document.body.createTextRange();try{gq.moveToElementText(gr.parentNode)}catch(gs){return gq}gq.collapse(true);gq.moveEnd("character",gp);gq.moveStart("character",gt);return gq}}function d2(gq){for(var gp=gq.childNodes.length;gp>0;--gp){gq.removeChild(gq.firstChild)}return gq}function bQ(gp,gq){return d2(gp).appendChild(gq)}var gg=H.contains=function(gp,gq){if(gq.nodeType==3){gq=gq.parentNode}if(gp.contains){return gp.contains(gq)}do{if(gq.nodeType==11){gq=gq.host}if(gq==gp){return true}}while(gq=gq.parentNode)};function dO(){var gp=document.activeElement;while(gp&&gp.root&&gp.root.activeElement){gp=gp.root.activeElement}return gp}if(dK&&k<11){dO=function(){try{return document.activeElement}catch(gp){return document.body}}}function S(gp){return new RegExp("(^|\\s)"+gp+"(?:$|\\s)\\s*")}var f=H.rmClass=function(gr,gp){var gs=gr.className;var gq=S(gp).exec(gs);if(gq){var gt=gs.slice(gq.index+gq[0].length);gr.className=gs.slice(0,gq.index)+(gt?gq[1]+gt:"")}};var fF=H.addClass=function(gq,gp){var gr=gq.className;if(!S(gp).test(gr)){gq.className+=(gr?" ":"")+gp}};function fY(gr,gp){var gq=gr.split(" ");for(var gs=0;gs<gq.length;gs++){if(gq[gs]&&!S(gq[gs]).test(gp)){gp+=" "+gq[gs]}}return gp}function az(gs){if(!document.body.getElementsByClassName){return}var gr=document.body.getElementsByClassName("CodeMirror");for(var gq=0;gq<gr.length;gq++){var gp=gr[gq].CodeMirror;if(gp){gs(gp)}}}var cB=false;function bi(){if(cB){return}fJ();cB=true}function fJ(){var gp;bW(window,"resize",function(){if(gp==null){gp=setTimeout(function(){gp=null;az(aS)},100)}});bW(window,"blur",function(){az(aU)})}var eP=function(){if(dK&&k<9){return false}var gp=f8("div");return"draggable" in gp||"dragDrop" in gp}();var fQ;function bm(gp){if(fQ==null){var gr=f8("span","\u200b");bQ(gp,f8("span",[gr,document.createTextNode("x")]));if(gp.firstChild.offsetHeight!=0){fQ=gr.offsetWidth<=1&&gr.offsetHeight>2&&!(dK&&k<8)}}var gq=fQ?f8("span","\u200b"):f8("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");gq.setAttribute("cm-text","");return gq}var fP;function bN(gs){if(fP!=null){return fP}var gp=bQ(gs,document.createTextNode("A\u062eA"));var gr=ck(gp,0,1).getBoundingClientRect();if(!gr||gr.left==gr.right){return false}var gq=ck(gp,1,2).getBoundingClientRect();return fP=(gq.right-gr.right<3)}var fX=H.splitLines="\n\nb".split(/\n/).length!=3?function(gu){var gv=0,gp=[],gt=gu.length;while(gv<=gt){var gs=gu.indexOf("\n",gv);if(gs==-1){gs=gu.length}var gr=gu.slice(gv,gu.charAt(gs-1)=="\r"?gs-1:gs);var gq=gr.indexOf("\r");if(gq!=-1){gp.push(gr.slice(0,gq));gv+=gq+1}else{gp.push(gr);gv=gs+1}}return gp}:function(gp){return gp.split(/\r\n?|\n/)};var br=window.getSelection?function(gq){try{return gq.selectionStart!=gq.selectionEnd}catch(gp){return false}}:function(gr){try{var gp=gr.ownerDocument.selection.createRange()}catch(gq){}if(!gp||gp.parentElement()!=gr){return false}return gp.compareEndPoints("StartToEnd",gp)!=0};var c9=(function(){var gp=f8("div");if("oncopy" in gp){return true}gp.setAttribute("oncopy","return;");return typeof gp.oncopy=="function"})();var fb=null;function aJ(gq){if(fb!=null){return fb}var gr=bQ(gq,f8("span","x"));var gs=gr.getBoundingClientRect();var gp=ck(gr,0,1).getBoundingClientRect();return fb=Math.abs(gs.left-gp.left)>1}var fl=H.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};(function(){for(var gp=0;gp<10;gp++){fl[gp+48]=fl[gp+96]=String(gp)}for(var gp=65;gp<=90;gp++){fl[gp]=String.fromCharCode(gp)}for(var gp=1;gp<=12;gp++){fl[gp+111]=fl[gp+63235]="F"+gp}})();function d5(gp,gv,gu,gt){if(!gp){return gt(gv,gu,"ltr")}var gs=false;for(var gr=0;gr<gp.length;++gr){var gq=gp[gr];if(gq.from<gu&&gq.to>gv||gv==gu&&gq.to==gv){gt(Math.max(gq.from,gv),Math.min(gq.to,gu),gq.level==1?"rtl":"ltr");gs=true}}if(!gs){gt(gv,gu,"ltr")}}function dy(gp){return gp.level%2?gp.to:gp.from}function gj(gp){return gp.level%2?gp.from:gp.to}function cD(gq){var gp=a(gq);return gp?dy(gp[0]):0}function cR(gq){var gp=a(gq);if(!gp){return gq.text.length}return gj(fL(gp))}function bs(gq,gt){var gr=fk(gq.doc,gt);var gu=x(gr);if(gu!=gr){gt=bM(gu)}var gp=a(gu);var gs=!gp?0:gp[0].level%2?cR(gu):cD(gu);return W(gt,gs)}function dP(gr,gu){var gq,gs=fk(gr.doc,gu);while(gq=ex(gs)){gs=gq.find(1,true).line;gu=null}var gp=a(gs);var gt=!gp?gs.text.length:gp[0].level%2?cD(gs):cR(gs);return W(gu==null?bM(gs):gu,gt)}function dI(gq,gv){var gu=bs(gq,gv.line);var gr=fk(gq.doc,gu.line);var gp=a(gr);if(!gp||gp[0].level==0){var gt=Math.max(0,gr.text.search(/\S/));var gs=gv.line==gu.line&&gv.ch<=gt&&gv.ch;return W(gu.line,gs?0:gt)}return gu}function am(gq,gr,gp){var gs=gq[0].level;if(gr==gs){return true}if(gp==gs){return false}return gr<gp}var e6;function aF(gp,gt){e6=null;for(var gq=0,gr;gq<gp.length;++gq){var gs=gp[gq];if(gs.from<gt&&gs.to>gt){return gq}if((gs.from==gt||gs.to==gt)){if(gr==null){gr=gq}else{if(am(gp,gs.level,gp[gr].level)){if(gs.from!=gs.to){e6=gr}return gq}else{if(gs.from!=gs.to){e6=gq}return gr}}}}return gr}function fj(gp,gs,gq,gr){if(!gr){return gs+gq}do{gs+=gq}while(gs>0&&fu(gp.text.charAt(gs)));return gs}function u(gp,gw,gr,gs){var gt=a(gp);if(!gt){return ai(gp,gw,gr,gs)}var gv=aF(gt,gw),gq=gt[gv];var gu=fj(gp,gw,gq.level%2?-gr:gr,gs);for(;;){if(gu>gq.from&&gu<gq.to){return gu}if(gu==gq.from||gu==gq.to){if(aF(gt,gu)==gv){return gu}gq=gt[gv+=gr];return(gr>0)==gq.level%2?gq.to:gq.from}else{gq=gt[gv+=gr];if(!gq){return null}if((gr>0)==gq.level%2){gu=fj(gp,gq.to,-1,gs)}else{gu=fj(gp,gq.from,1,gs)}}}}function ai(gp,gt,gq,gr){var gs=gt+gq;if(gr){while(gs>0&&fu(gp.text.charAt(gs))){gs+=gq}}return gs<0||gs>gp.text.length?null:gs}var bg=(function(){var gv="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var gt="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function gs(gz){if(gz<=247){return gv.charAt(gz)}else{if(1424<=gz&&gz<=1524){return"R"}else{if(1536<=gz&&gz<=1773){return gt.charAt(gz-1536)}else{if(1774<=gz&&gz<=2220){return"r"}else{if(8192<=gz&&gz<=8203){return"w"}else{if(gz==8204){return"b"}else{return"L"}}}}}}}var gp=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var gy=/[stwN]/,gr=/[LRr]/,gq=/[Lb1n]/,gu=/[1n]/;var gx="L";function gw(gB,gA,gz){this.level=gB;this.from=gA;this.to=gz}return function(gJ){if(!gp.test(gJ)){return false}var gP=gJ.length,gF=[];for(var gO=0,gB;gO<gP;++gO){gF.push(gB=gs(gJ.charCodeAt(gO)))}for(var gO=0,gI=gx;gO<gP;++gO){var gB=gF[gO];if(gB=="m"){gF[gO]=gI}else{gI=gB}}for(var gO=0,gz=gx;gO<gP;++gO){var gB=gF[gO];if(gB=="1"&&gz=="r"){gF[gO]="n"}else{if(gr.test(gB)){gz=gB;if(gB=="r"){gF[gO]="R"}}}}for(var gO=1,gI=gF[0];gO<gP-1;++gO){var gB=gF[gO];if(gB=="+"&&gI=="1"&&gF[gO+1]=="1"){gF[gO]="1"}else{if(gB==","&&gI==gF[gO+1]&&(gI=="1"||gI=="n")){gF[gO]=gI}}gI=gB}for(var gO=0;gO<gP;++gO){var gB=gF[gO];if(gB==","){gF[gO]="N"}else{if(gB=="%"){for(var gC=gO+1;gC<gP&&gF[gC]=="%";++gC){}var gQ=(gO&&gF[gO-1]=="!")||(gC<gP&&gF[gC]=="1")?"1":"N";for(var gM=gO;gM<gC;++gM){gF[gM]=gQ}gO=gC-1}}}for(var gO=0,gz=gx;gO<gP;++gO){var gB=gF[gO];if(gz=="L"&&gB=="1"){gF[gO]="L"}else{if(gr.test(gB)){gz=gB}}}for(var gO=0;gO<gP;++gO){if(gy.test(gF[gO])){for(var gC=gO+1;gC<gP&&gy.test(gF[gC]);++gC){}var gG=(gO?gF[gO-1]:gx)=="L";var gA=(gC<gP?gF[gC]:gx)=="L";var gQ=gG||gA?"L":"R";for(var gM=gO;gM<gC;++gM){gF[gM]=gQ}gO=gC-1}}var gN=[],gK;for(var gO=0;gO<gP;){if(gq.test(gF[gO])){var gD=gO;for(++gO;gO<gP&&gq.test(gF[gO]);++gO){}gN.push(new gw(0,gD,gO))}else{var gE=gO,gH=gN.length;for(++gO;gO<gP&&gF[gO]!="L";++gO){}for(var gM=gE;gM<gO;){if(gu.test(gF[gM])){if(gE<gM){gN.splice(gH,0,new gw(1,gE,gM))}var gL=gM;for(++gM;gM<gO&&gu.test(gF[gM]);++gM){}gN.splice(gH,0,new gw(2,gL,gM));gE=gM}else{++gM}}if(gE<gO){gN.splice(gH,0,new gw(1,gE,gO))}}}if(gN[0].level==1&&(gK=gJ.match(/^\s+/))){gN[0].from=gK[0].length;gN.unshift(new gw(0,0,gK[0].length))}if(fL(gN).level==1&&(gK=gJ.match(/\s+$/))){fL(gN).to-=gK[0].length;gN.push(new gw(0,gP-gK[0].length,gP))}if(gN[0].level==2){gN.unshift(new gw(1,gN[0].to,gN[0].to))}if(gN[0].level!=fL(gN).level){gN.push(new gw(gN[0].level,gP,gP))}return gN}})();H.version="5.10.0";return H});